

============================== 07:49:46.741054 | 95861d09-3904-4594-a6c3-e1169772c667 ==============================
[0m07:49:46.741054 [info ] [MainThread]: Running with dbt=1.9.2
[0m07:49:46.848463 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jordi.vidaldellobatera/Documents/repos/bi-data-model/bi-dbt/profile', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt init jaffle_shop', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m07:49:46.848751 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m07:49:47.019243 [debug] [MainThread]: Starter project path: /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/.venv/lib/python3.12/site-packages/dbt/include/starter_project
[0m07:49:47.042899 [info ] [MainThread]: 
Your new dbt project "jaffle_shop" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m07:49:47.043195 [info ] [MainThread]: Setting up your profile.
[0m07:49:47.046234 [error] [MainThread]: Encountered an error:
Runtime Error
  No adapters available. Learn how to install an adapter by going to https://docs.getdbt.com/docs/connect-adapters#install-using-the-cli
[0m07:49:47.046753 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": false, "command_wall_clock_time": 0.4303859, "process_in_blocks": "0", "process_kernel_time": 0.162157, "process_mem_max_rss": "113754112", "process_out_blocks": "0", "process_user_time": 0.681319}
[0m07:49:47.047045 [debug] [MainThread]: Command `dbt init` failed at 07:49:47.046992 after 0.43 seconds
[0m07:49:47.047289 [debug] [MainThread]: Flushing usage events
[0m09:57:44.747846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105725be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118a9340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118a8f50>]}


============================== 09:57:44.758128 | 1fe1b5ad-0acb-49ac-8452-ea109e368ae2 ==============================
[0m09:57:44.758128 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:57:44.758677 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'profiles_dir': '/Users/jordi.vidaldellobatera/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:57:44.847107 [info ] [MainThread]: dbt version: 1.9.2
[0m09:57:44.847382 [info ] [MainThread]: python version: 3.12.8
[0m09:57:44.847558 [info ] [MainThread]: python path: /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/.venv/bin/python3
[0m09:57:44.847710 [info ] [MainThread]: os info: macOS-15.2-arm64-arm-64bit
[0m09:57:44.850367 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.postgres'
[0m09:57:44.850670 [info ] [MainThread]: Using profiles dir at /Users/jordi.vidaldellobatera/.dbt
[0m09:57:44.850831 [info ] [MainThread]: Using profiles.yml file at /Users/jordi.vidaldellobatera/.dbt/profiles.yml
[0m09:57:44.850974 [info ] [MainThread]: Using dbt_project.yml file at /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/dbt_project.yml
[0m09:57:44.851123 [info ] [MainThread]: Configuration:
[0m09:57:44.851258 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m09:57:44.851388 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m09:57:44.851518 [info ] [MainThread]: Required dependencies:
[0m09:57:44.851702 [debug] [MainThread]: Executing "git --help"
[0m09:57:44.876654 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:57:44.877254 [debug] [MainThread]: STDERR: "b''"
[0m09:57:44.877469 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:57:44.877654 [info ] [MainThread]: Connection test skipped since no profile was found
[0m09:57:44.877906 [info ] [MainThread]: [31m2 checks failed:[0m
[0m09:57:44.878057 [info ] [MainThread]: Could not load dbt_project.yml
Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "jaffle_shop", target "dev" invalid: Runtime Error
    Could not find adapter type postgres!


[0m09:57:44.878211 [info ] [MainThread]: Project loading failed for the following reason:
 project path </Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/dbt_project.yml> not found

[0m09:57:44.878664 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.28741583, "process_in_blocks": "0", "process_kernel_time": 0.67033, "process_mem_max_rss": "94781440", "process_out_blocks": "0", "process_user_time": 1.700388}
[0m09:57:44.879036 [debug] [MainThread]: Command `dbt debug` failed at 09:57:44.878943 after 0.29 seconds
[0m09:57:44.879382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109cd400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111515e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118c3470>]}
[0m09:57:44.879659 [debug] [MainThread]: Flushing usage events
[0m09:57:45.397072 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:02:33.436553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10845a420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d754c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d75160>]}


============================== 10:02:33.440125 | 7b80bb05-1b0d-4c64-80ee-edb2b4e38ae9 ==============================
[0m10:02:33.440125 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:02:33.440456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/logs', 'profiles_dir': '/Users/jordi.vidaldellobatera/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m10:02:33.455536 [info ] [MainThread]: dbt version: 1.9.2
[0m10:02:33.455806 [info ] [MainThread]: python version: 3.12.8
[0m10:02:33.455973 [info ] [MainThread]: python path: /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/.venv/bin/python3
[0m10:02:33.456128 [info ] [MainThread]: os info: macOS-15.2-arm64-arm-64bit
[0m10:02:35.276232 [info ] [MainThread]: Using profiles dir at /Users/jordi.vidaldellobatera/.dbt
[0m10:02:35.276569 [info ] [MainThread]: Using profiles.yml file at /Users/jordi.vidaldellobatera/.dbt/profiles.yml
[0m10:02:35.276774 [info ] [MainThread]: Using dbt_project.yml file at /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/dbt_project.yml
[0m10:02:35.284046 [info ] [MainThread]: adapter type: postgres
[0m10:02:35.284357 [info ] [MainThread]: adapter version: 1.9.0
[0m10:02:35.332200 [info ] [MainThread]: Configuration:
[0m10:02:35.332564 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:02:35.332775 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:02:35.332944 [info ] [MainThread]: Required dependencies:
[0m10:02:35.333198 [debug] [MainThread]: Executing "git --help"
[0m10:02:35.342425 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:02:35.343134 [debug] [MainThread]: STDERR: "b''"
[0m10:02:35.343363 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:02:35.343743 [info ] [MainThread]: Connection:
[0m10:02:35.344123 [info ] [MainThread]:   host: localhost
[0m10:02:35.344450 [info ] [MainThread]:   port: 5432
[0m10:02:35.344693 [info ] [MainThread]:   user: dbt_user
[0m10:02:35.344858 [info ] [MainThread]:   database: jaffle_shop
[0m10:02:35.345007 [info ] [MainThread]:   schema: public
[0m10:02:35.345147 [info ] [MainThread]:   connect_timeout: 10
[0m10:02:35.345289 [info ] [MainThread]:   role: None
[0m10:02:35.345426 [info ] [MainThread]:   search_path: None
[0m10:02:35.345560 [info ] [MainThread]:   keepalives_idle: 0
[0m10:02:35.345695 [info ] [MainThread]:   sslmode: None
[0m10:02:35.345828 [info ] [MainThread]:   sslcert: None
[0m10:02:35.345961 [info ] [MainThread]:   sslkey: None
[0m10:02:35.346093 [info ] [MainThread]:   sslrootcert: None
[0m10:02:35.346223 [info ] [MainThread]:   application_name: dbt
[0m10:02:35.346411 [info ] [MainThread]:   retries: 1
[0m10:02:35.346879 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:02:35.479086 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:02:37.281637 [debug] [MainThread]: Using postgres connection "debug"
[0m10:02:37.282083 [debug] [MainThread]: On debug: select 1 as id
[0m10:02:37.282378 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:02:37.574567 [debug] [MainThread]: SQL status: SELECT 1 in 0.292 seconds
[0m10:02:37.577546 [debug] [MainThread]: On debug: Close
[0m10:02:37.578417 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:02:37.579088 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:02:37.580913 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 4.2096, "process_in_blocks": "0", "process_kernel_time": 0.421119, "process_mem_max_rss": "111247360", "process_out_blocks": "0", "process_user_time": 0.844125}
[0m10:02:37.581604 [debug] [MainThread]: Command `dbt debug` succeeded at 10:02:37.581442 after 4.21 seconds
[0m10:02:37.582148 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:02:37.582726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087f6090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092db110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d26e10>]}
[0m10:02:37.583394 [debug] [MainThread]: Flushing usage events
[0m10:02:38.006149 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:03:54.247444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049d9fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ebd670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ebd2e0>]}


============================== 10:03:54.251154 | 483919eb-dbb5-473e-aa3c-a2711ff7a7a5 ==============================
[0m10:03:54.251154 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:03:54.251521 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jordi.vidaldellobatera/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:03:54.553829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '483919eb-dbb5-473e-aa3c-a2711ff7a7a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a092e0>]}
[0m10:03:54.580449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '483919eb-dbb5-473e-aa3c-a2711ff7a7a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051107d0>]}
[0m10:03:54.586655 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:03:54.680252 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m10:03:54.680874 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:03:54.681143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '483919eb-dbb5-473e-aa3c-a2711ff7a7a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056ac560>]}
[0m10:03:55.365786 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.example
[0m10:03:55.368537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '483919eb-dbb5-473e-aa3c-a2711ff7a7a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ee6060>]}
[0m10:03:55.390139 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m10:03:55.403954 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m10:03:55.496088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '483919eb-dbb5-473e-aa3c-a2711ff7a7a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107022450>]}
[0m10:03:55.496438 [info ] [MainThread]: Found 431 macros
[0m10:03:55.496636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '483919eb-dbb5-473e-aa3c-a2711ff7a7a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107005370>]}
[0m10:03:55.497442 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:03:55.497751 [debug] [MainThread]: Command end result
[0m10:03:55.508542 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m10:03:55.509801 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m10:03:55.511566 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/run_results.json
[0m10:03:55.511924 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3254806, "process_in_blocks": "0", "process_kernel_time": 0.251344, "process_mem_max_rss": "106201088", "process_out_blocks": "0", "process_user_time": 1.141241}
[0m10:03:55.512155 [debug] [MainThread]: Command `dbt run` succeeded at 10:03:55.512111 after 1.33 seconds
[0m10:03:55.512366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e53440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dee630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b56d0>]}
[0m10:03:55.512556 [debug] [MainThread]: Flushing usage events
[0m10:03:55.685758 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:05:02.062872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106335040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106825820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106825460>]}


============================== 13:05:02.074123 | 809845b1-ccd7-4659-9503-96115e2d94d4 ==============================
[0m13:05:02.074123 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:05:02.074657 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jordi.vidaldellobatera/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:05:02.075137 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m13:05:02.075661 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.17942259, "process_in_blocks": "0", "process_kernel_time": 0.617313, "process_mem_max_rss": "93487104", "process_out_blocks": "0", "process_user_time": 1.717484}
[0m13:05:02.076044 [debug] [MainThread]: Command `dbt run` failed at 13:05:02.075973 after 0.18 seconds
[0m13:05:02.076351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ab2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106827530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068274d0>]}
[0m13:05:02.076778 [debug] [MainThread]: Flushing usage events
[0m13:05:02.258971 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:05:30.239044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b3d1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082857c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108285400>]}


============================== 13:05:30.243419 | 57ce9f27-bc20-4cba-8361-58a2f6ea1b76 ==============================
[0m13:05:30.243419 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:05:30.243766 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'profiles_dir': '/Users/jordi.vidaldellobatera/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:05:30.244096 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m13:05:30.244437 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.06286854, "process_in_blocks": "0", "process_kernel_time": 0.142043, "process_mem_max_rss": "91160576", "process_out_blocks": "0", "process_user_time": 0.591486}
[0m13:05:30.244685 [debug] [MainThread]: Command `dbt run` failed at 13:05:30.244636 after 0.06 seconds
[0m13:05:30.244874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fc5a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108285910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108285670>]}
[0m13:05:30.245046 [debug] [MainThread]: Flushing usage events
[0m13:05:30.321193 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:45:10.963167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066b52e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d95940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d955b0>]}


============================== 13:45:10.970487 | 06e3bcf0-dbd1-4751-b565-c3f0075d20aa ==============================
[0m13:45:10.970487 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:45:10.970913 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jordi.vidaldellobatera/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:45:11.375197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06e3bcf0-dbd1-4751-b565-c3f0075d20aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e1160>]}
[0m13:45:11.400222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06e3bcf0-dbd1-4751-b565-c3f0075d20aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e53f20>]}
[0m13:45:11.405393 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:45:11.556237 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m13:45:11.591277 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:45:11.591688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '06e3bcf0-dbd1-4751-b565-c3f0075d20aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066b5ac0>]}
[0m13:45:12.472609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06e3bcf0-dbd1-4751-b565-c3f0075d20aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116a79e0>]}
[0m13:45:12.527466 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m13:45:12.546899 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m13:45:12.678436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06e3bcf0-dbd1-4751-b565-c3f0075d20aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111735250>]}
[0m13:45:12.679083 [info ] [MainThread]: Found 3 models, 4 data tests, 431 macros
[0m13:45:12.679589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06e3bcf0-dbd1-4751-b565-c3f0075d20aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b5f110>]}
[0m13:45:12.681245 [info ] [MainThread]: 
[0m13:45:12.681607 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:45:12.681883 [info ] [MainThread]: 
[0m13:45:12.682378 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:45:12.686799 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m13:45:14.435584 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m13:45:14.436349 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m13:45:14.436701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:14.720067 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.283 seconds
[0m13:45:14.722236 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m13:45:14.724266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now list_jaffle_shop_public)
[0m13:45:14.728569 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m13:45:14.728843 [debug] [ThreadPool]: On list_jaffle_shop_public: BEGIN
[0m13:45:14.729009 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:14.740887 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m13:45:14.741205 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m13:45:14.741398 [debug] [ThreadPool]: On list_jaffle_shop_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_public"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:45:14.749363 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m13:45:14.750240 [debug] [ThreadPool]: On list_jaffle_shop_public: ROLLBACK
[0m13:45:14.751098 [debug] [ThreadPool]: On list_jaffle_shop_public: Close
[0m13:45:14.754069 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:14.754371 [debug] [MainThread]: On master: BEGIN
[0m13:45:14.754524 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:45:14.764530 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:45:14.765046 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:14.765281 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:45:14.769664 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m13:45:14.770659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06e3bcf0-dbd1-4751-b565-c3f0075d20aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116f2d50>]}
[0m13:45:14.770943 [debug] [MainThread]: On master: ROLLBACK
[0m13:45:14.771732 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:14.771943 [debug] [MainThread]: On master: BEGIN
[0m13:45:14.772995 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:45:14.773211 [debug] [MainThread]: On master: COMMIT
[0m13:45:14.773395 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:14.773605 [debug] [MainThread]: On master: COMMIT
[0m13:45:14.774269 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:45:14.774444 [debug] [MainThread]: On master: Close
[0m13:45:14.775221 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m13:45:14.775569 [info ] [Thread-1 (]: 1 of 3 START sql view model public.customers ................................... [RUN]
[0m13:45:14.775867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_public, now model.jaffle_shop.customers)
[0m13:45:14.776063 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m13:45:14.779508 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m13:45:14.781212 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m13:45:14.801645 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m13:45:14.803470 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m13:45:14.803697 [debug] [Thread-1 (]: On model.jaffle_shop.customers: BEGIN
[0m13:45:14.803877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:14.813467 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m13:45:14.813883 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m13:45:14.814266 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  create view "jaffle_shop"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m13:45:14.815921 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "jaffle_shop.customers" does not exist
LINE 14:     from jaffle_shop.customers
                  ^

[0m13:45:14.816251 [debug] [Thread-1 (]: On model.jaffle_shop.customers: ROLLBACK
[0m13:45:14.817945 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m13:45:14.865542 [debug] [Thread-1 (]: Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "jaffle_shop.customers" does not exist
  LINE 14:     from jaffle_shop.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m13:45:14.868754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06e3bcf0-dbd1-4751-b565-c3f0075d20aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e3eb70>]}
[0m13:45:14.869234 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.customers .......................... [[31mERROR[0m in 0.09s]
[0m13:45:14.869560 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m13:45:14.869845 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m13:45:14.870250 [debug] [Thread-4 (]: Marking all children of 'model.jaffle_shop.customers' to be skipped because of status 'error'.  Reason: Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "jaffle_shop.customers" does not exist
  LINE 14:     from jaffle_shop.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql.
[0m13:45:14.870560 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m13:45:14.871989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.customers, now model.jaffle_shop.my_first_dbt_model)
[0m13:45:14.872284 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m13:45:14.875579 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m13:45:14.878789 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m13:45:14.893519 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m13:45:14.894840 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:45:14.895105 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: BEGIN
[0m13:45:14.895289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:14.907844 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m13:45:14.908183 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:45:14.908405 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

  create  table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m13:45:14.912015 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m13:45:14.917706 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:45:14.918048 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m13:45:14.919566 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:45:14.921429 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:45:14.921656 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m13:45:14.922729 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:45:14.934297 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m13:45:14.934633 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:45:14.934829 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m13:45:14.937066 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:45:14.941240 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_first_dbt_model__dbt_backup"
[0m13:45:14.944164 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:45:14.944519 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
drop table if exists "jaffle_shop"."public"."my_first_dbt_model__dbt_backup" cascade
[0m13:45:14.949081 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m13:45:14.950698 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m13:45:14.951185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06e3bcf0-dbd1-4751-b565-c3f0075d20aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104815d30>]}
[0m13:45:14.951769 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.08s]
[0m13:45:14.952349 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m13:45:14.952825 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m13:45:14.953152 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m13:45:14.953532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.my_second_dbt_model)
[0m13:45:14.953821 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m13:45:14.955602 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m13:45:14.956509 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m13:45:14.958621 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m13:45:14.962066 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m13:45:14.962434 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: BEGIN
[0m13:45:14.962622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:14.973135 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m13:45:14.973578 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m13:45:14.973807 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */

  create view "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "jaffle_shop"."public"."my_first_dbt_model"
where id = 1
  );
[0m13:45:14.975558 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:45:14.977511 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m13:45:14.977829 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
alter table "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m13:45:14.979402 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:45:14.980464 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m13:45:14.980750 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m13:45:14.980947 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m13:45:14.982362 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:45:14.983868 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_second_dbt_model__dbt_backup"
[0m13:45:14.985806 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m13:45:14.986073 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "jaffle_shop"."public"."my_second_dbt_model__dbt_backup" cascade
[0m13:45:14.986919 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:45:14.987628 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m13:45:14.987956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06e3bcf0-dbd1-4751-b565-c3f0075d20aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f5d2b0>]}
[0m13:45:14.988280 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.03s]
[0m13:45:14.988602 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m13:45:14.989391 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:14.989602 [debug] [MainThread]: On master: BEGIN
[0m13:45:14.989765 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:45:14.998544 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:45:14.998861 [debug] [MainThread]: On master: COMMIT
[0m13:45:14.999699 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:14.999971 [debug] [MainThread]: On master: COMMIT
[0m13:45:15.001072 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:45:15.001330 [debug] [MainThread]: On master: Close
[0m13:45:15.001613 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:45:15.001777 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m13:45:15.001993 [info ] [MainThread]: 
[0m13:45:15.002179 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 2.32 seconds (2.32s).
[0m13:45:15.002659 [debug] [MainThread]: Command end result
[0m13:45:15.015463 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m13:45:15.017047 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m13:45:15.026266 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/run_results.json
[0m13:45:15.026534 [info ] [MainThread]: 
[0m13:45:15.026748 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:45:15.026922 [info ] [MainThread]: 
[0m13:45:15.027121 [error] [MainThread]:   Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "jaffle_shop.customers" does not exist
  LINE 14:     from jaffle_shop.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m13:45:15.027282 [info ] [MainThread]: 
[0m13:45:15.027450 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m13:45:15.027794 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.2048855, "process_in_blocks": "0", "process_kernel_time": 0.825366, "process_mem_max_rss": "122585088", "process_out_blocks": "0", "process_user_time": 2.599326}
[0m13:45:15.028010 [debug] [MainThread]: Command `dbt run` failed at 13:45:15.027969 after 4.21 seconds
[0m13:45:15.028218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d95ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d95940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116f2e10>]}
[0m13:45:15.028419 [debug] [MainThread]: Flushing usage events
[0m13:45:15.560040 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:50:14.311166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104517590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049f96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049f91f0>]}


============================== 13:50:14.314964 | 434622f7-dfe4-4291-b440-9babb8ffc2ef ==============================
[0m13:50:14.314964 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:50:14.315334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/logs', 'debug': 'False', 'profiles_dir': '/Users/jordi.vidaldellobatera/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:50:14.446953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '434622f7-dfe4-4291-b440-9babb8ffc2ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b5c1a0>]}
[0m13:50:14.472486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '434622f7-dfe4-4291-b440-9babb8ffc2ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101aacfe0>]}
[0m13:50:14.473588 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:50:14.540941 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m13:50:14.581330 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:50:14.581662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '434622f7-dfe4-4291-b440-9babb8ffc2ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104515a30>]}
[0m13:50:15.226769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '434622f7-dfe4-4291-b440-9babb8ffc2ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a802c0>]}
[0m13:50:15.262957 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m13:50:15.265299 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m13:50:15.296866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '434622f7-dfe4-4291-b440-9babb8ffc2ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ad0110>]}
[0m13:50:15.297161 [info ] [MainThread]: Found 3 models, 6 seeds, 4 data tests, 431 macros
[0m13:50:15.297348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '434622f7-dfe4-4291-b440-9babb8ffc2ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105af7740>]}
[0m13:50:15.298333 [info ] [MainThread]: 
[0m13:50:15.298542 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:50:15.298697 [info ] [MainThread]: 
[0m13:50:15.299023 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:50:15.300990 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m13:50:15.400723 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m13:50:15.400972 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m13:50:15.401127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:15.434614 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.033 seconds
[0m13:50:15.435491 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m13:50:15.435939 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_public_raw)
[0m13:50:15.436426 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "public_raw"
"
[0m13:50:15.439599 [debug] [ThreadPool]: Using postgres connection "create_jaffle_shop_public_raw"
[0m13:50:15.439823 [debug] [ThreadPool]: On create_jaffle_shop_public_raw: BEGIN
[0m13:50:15.439988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:15.449403 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:50:15.449711 [debug] [ThreadPool]: Using postgres connection "create_jaffle_shop_public_raw"
[0m13:50:15.449895 [debug] [ThreadPool]: On create_jaffle_shop_public_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_public_raw"} */
create schema if not exists "public_raw"
[0m13:50:15.451405 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m13:50:15.452010 [debug] [ThreadPool]: On create_jaffle_shop_public_raw: COMMIT
[0m13:50:15.452216 [debug] [ThreadPool]: Using postgres connection "create_jaffle_shop_public_raw"
[0m13:50:15.452395 [debug] [ThreadPool]: On create_jaffle_shop_public_raw: COMMIT
[0m13:50:15.453892 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m13:50:15.454081 [debug] [ThreadPool]: On create_jaffle_shop_public_raw: Close
[0m13:50:15.455074 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_jaffle_shop_public_raw, now list_jaffle_shop_public)
[0m13:50:15.458506 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m13:50:15.458716 [debug] [ThreadPool]: On list_jaffle_shop_public: BEGIN
[0m13:50:15.458882 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:15.466111 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:50:15.466373 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m13:50:15.466561 [debug] [ThreadPool]: On list_jaffle_shop_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_public"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:50:15.469191 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m13:50:15.470030 [debug] [ThreadPool]: On list_jaffle_shop_public: ROLLBACK
[0m13:50:15.470754 [debug] [ThreadPool]: On list_jaffle_shop_public: Close
[0m13:50:15.471064 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop_public, now list_jaffle_shop_public_raw)
[0m13:50:15.473407 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public_raw"
[0m13:50:15.473840 [debug] [ThreadPool]: On list_jaffle_shop_public_raw: BEGIN
[0m13:50:15.474032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:15.482777 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:50:15.483050 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public_raw"
[0m13:50:15.483311 [debug] [ThreadPool]: On list_jaffle_shop_public_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_public_raw"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw'
    union all
    select
      'jaffle_shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw'
  
[0m13:50:15.486121 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m13:50:15.486886 [debug] [ThreadPool]: On list_jaffle_shop_public_raw: ROLLBACK
[0m13:50:15.487573 [debug] [ThreadPool]: On list_jaffle_shop_public_raw: Close
[0m13:50:15.490522 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:15.490756 [debug] [MainThread]: On master: BEGIN
[0m13:50:15.490936 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:50:15.498996 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:50:15.499288 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:15.499574 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:50:15.502514 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m13:50:15.503393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '434622f7-dfe4-4291-b440-9babb8ffc2ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10487d550>]}
[0m13:50:15.503673 [debug] [MainThread]: On master: ROLLBACK
[0m13:50:15.504347 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:15.504535 [debug] [MainThread]: On master: BEGIN
[0m13:50:15.505699 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:50:15.505953 [debug] [MainThread]: On master: COMMIT
[0m13:50:15.506189 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:15.506382 [debug] [MainThread]: On master: COMMIT
[0m13:50:15.507015 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:50:15.507246 [debug] [MainThread]: On master: Close
[0m13:50:15.508073 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m13:50:15.508390 [info ] [Thread-1 (]: 1 of 6 START seed file public_raw.raw_customers ................................ [RUN]
[0m13:50:15.508661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_public_raw, now seed.jaffle_shop.raw_customers)
[0m13:50:15.508876 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m13:50:15.509078 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m13:50:15.527211 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m13:50:15.527507 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: BEGIN
[0m13:50:15.527699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:15.536667 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m13:50:15.537050 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m13:50:15.537291 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */

    create table "jaffle_shop"."public_raw"."raw_customers" ("id" text,"name" text)
  
[0m13:50:15.542387 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.005 seconds
[0m13:50:15.705356 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m13:50:15.705670 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: 
          insert into "jaffle_shop"."public_raw"."raw_customers" ("id", "name") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s...
[0m13:50:15.718387 [debug] [Thread-1 (]: SQL status: INSERT 0 930 in 0.012 seconds
[0m13:50:15.721910 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m13:50:15.733447 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: COMMIT
[0m13:50:15.733772 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m13:50:15.733979 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: COMMIT
[0m13:50:15.736580 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:50:15.737724 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m13:50:15.739379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '434622f7-dfe4-4291-b440-9babb8ffc2ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101af9e50>]}
[0m13:50:15.739726 [info ] [Thread-1 (]: 1 of 6 OK loaded seed file public_raw.raw_customers ............................ [[32mINSERT 930[0m in 0.23s]
[0m13:50:15.740052 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m13:50:15.740284 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_items
[0m13:50:15.740689 [info ] [Thread-1 (]: 2 of 6 START seed file public_raw.raw_items .................................... [RUN]
[0m13:50:15.741001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_customers, now seed.jaffle_shop.raw_items)
[0m13:50:15.741199 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_items
[0m13:50:15.741413 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_items
[0m13:50:16.032322 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m13:50:16.032696 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: BEGIN
[0m13:50:16.032891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:16.045079 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m13:50:16.045375 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m13:50:16.045661 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_items"} */

    create table "jaffle_shop"."public_raw"."raw_items" ("id" text,"order_id" text,"sku" text)
  
[0m13:50:16.050323 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.004 seconds
[0m13:50:18.473251 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m13:50:18.473557 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: 
          insert into "jaffle_shop"."public_raw"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),...
[0m13:50:18.545251 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.071 seconds
[0m13:50:20.994651 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m13:50:20.995342 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: 
          insert into "jaffle_shop"."public_raw"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),...
[0m13:50:21.061873 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.066 seconds
[0m13:50:23.462947 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m13:50:23.463243 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: 
          insert into "jaffle_shop"."public_raw"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),...
[0m13:50:23.521356 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.058 seconds
[0m13:50:25.970387 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m13:50:25.970696 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: 
          insert into "jaffle_shop"."public_raw"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),...
[0m13:50:26.037998 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.067 seconds
[0m13:50:28.469589 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m13:50:28.470622 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: 
          insert into "jaffle_shop"."public_raw"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),...
[0m13:50:28.558160 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.087 seconds
[0m13:50:31.052783 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m13:50:31.053091 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: 
          insert into "jaffle_shop"."public_raw"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),...
[0m13:50:31.097623 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.044 seconds
[0m13:50:33.567951 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m13:50:33.568246 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: 
          insert into "jaffle_shop"."public_raw"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),...
[0m13:50:33.611636 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.043 seconds
[0m13:50:36.278051 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m13:50:36.279153 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: 
          insert into "jaffle_shop"."public_raw"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),...
[0m13:50:36.333564 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.054 seconds
[0m13:50:38.810675 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m13:50:38.811914 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: 
          insert into "jaffle_shop"."public_raw"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),...
[0m13:50:38.860442 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.048 seconds
[0m13:50:38.908621 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m13:50:38.908943 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: 
          insert into "jaffle_shop"."public_raw"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),...
[0m13:50:38.910707 [debug] [Thread-1 (]: SQL status: INSERT 0 183 in 0.002 seconds
[0m13:50:38.911515 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_items"
[0m13:50:38.913319 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: COMMIT
[0m13:50:38.913524 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m13:50:38.913695 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: COMMIT
[0m13:50:38.914995 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:50:38.915371 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: Close
[0m13:50:38.915692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '434622f7-dfe4-4291-b440-9babb8ffc2ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d0fd40>]}
[0m13:50:38.915989 [info ] [Thread-1 (]: 2 of 6 OK loaded seed file public_raw.raw_items ................................ [[32mINSERT 90183[0m in 23.17s]
[0m13:50:38.916286 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_items
[0m13:50:38.916494 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_orders
[0m13:50:38.916778 [info ] [Thread-1 (]: 3 of 6 START seed file public_raw.raw_orders ................................... [RUN]
[0m13:50:38.916996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_items, now seed.jaffle_shop.raw_orders)
[0m13:50:38.917174 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m13:50:38.917348 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_orders
[0m13:50:40.396235 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m13:50:40.396556 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: BEGIN
[0m13:50:40.396732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:40.413746 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:50:40.414062 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m13:50:40.414273 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */

    create table "jaffle_shop"."public_raw"."raw_orders" ("id" text,"customer" text,"ordered_at" timestamp without time zone,"store_id" text,"subtotal" integer,"tax_paid" integer,"order_total" integer)
  
[0m13:50:40.422758 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.008 seconds
[0m13:50:46.148429 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m13:50:46.149458 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: 
          insert into "jaffle_shop"."public_raw"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s...
[0m13:50:46.279299 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.130 seconds
[0m13:50:52.307441 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m13:50:52.308568 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: 
          insert into "jaffle_shop"."public_raw"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s...
[0m13:50:52.430381 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.121 seconds
[0m13:50:58.372294 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m13:50:58.373542 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: 
          insert into "jaffle_shop"."public_raw"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s...
[0m13:50:58.511625 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.138 seconds
[0m13:51:04.293406 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m13:51:04.294070 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: 
          insert into "jaffle_shop"."public_raw"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s...
[0m13:51:04.404594 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.110 seconds
[0m13:51:10.265338 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m13:51:10.265954 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: 
          insert into "jaffle_shop"."public_raw"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s...
[0m13:51:10.374846 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.109 seconds
[0m13:51:16.250914 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m13:51:16.251583 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: 
          insert into "jaffle_shop"."public_raw"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s...
[0m13:51:16.387358 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.135 seconds
[0m13:51:18.215105 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m13:51:18.215419 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: 
          insert into "jaffle_shop"."public_raw"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s...
[0m13:51:18.259334 [debug] [Thread-1 (]: SQL status: INSERT 0 3148 in 0.044 seconds
[0m13:51:18.260750 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m13:51:18.264963 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: COMMIT
[0m13:51:18.265274 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m13:51:18.265508 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: COMMIT
[0m13:51:18.267724 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:51:18.268539 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: Close
[0m13:51:18.269643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '434622f7-dfe4-4291-b440-9babb8ffc2ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce52fc0>]}
[0m13:51:18.271052 [info ] [Thread-1 (]: 3 of 6 OK loaded seed file public_raw.raw_orders ............................... [[32mINSERT 63148[0m in 39.35s]
[0m13:51:18.272860 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_orders
[0m13:51:18.275079 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_products
[0m13:51:18.278352 [info ] [Thread-1 (]: 4 of 6 START seed file public_raw.raw_products ................................. [RUN]
[0m13:51:18.279065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_orders, now seed.jaffle_shop.raw_products)
[0m13:51:18.279598 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_products
[0m13:51:18.279875 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_products
[0m13:51:18.290606 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_products"
[0m13:51:18.290945 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_products: BEGIN
[0m13:51:18.291159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:18.300270 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m13:51:18.300628 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_products"
[0m13:51:18.301540 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_products"} */

    create table "jaffle_shop"."public_raw"."raw_products" ("sku" text,"name" text,"type" text,"price" integer,"description" text)
  
[0m13:51:18.305224 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.003 seconds
[0m13:51:18.311158 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_products"
[0m13:51:18.311440 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_products: 
          insert into "jaffle_shop"."public_raw"."raw_products" ("sku", "name", "type", "price", "description") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)
      ...
[0m13:51:18.312650 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.001 seconds
[0m13:51:18.313090 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_products"
[0m13:51:18.314739 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_products: COMMIT
[0m13:51:18.314957 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_products"
[0m13:51:18.315159 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_products: COMMIT
[0m13:51:18.316358 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:51:18.316743 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_products: Close
[0m13:51:18.317083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '434622f7-dfe4-4291-b440-9babb8ffc2ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd732f0>]}
[0m13:51:18.317427 [info ] [Thread-1 (]: 4 of 6 OK loaded seed file public_raw.raw_products ............................. [[32mINSERT 10[0m in 0.04s]
[0m13:51:18.317761 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_products
[0m13:51:18.318013 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_stores
[0m13:51:18.318303 [info ] [Thread-1 (]: 5 of 6 START seed file public_raw.raw_stores ................................... [RUN]
[0m13:51:18.318551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_products, now seed.jaffle_shop.raw_stores)
[0m13:51:18.318745 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_stores
[0m13:51:18.318928 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_stores
[0m13:51:18.321968 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_stores"
[0m13:51:18.322173 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_stores: BEGIN
[0m13:51:18.322353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:18.329775 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m13:51:18.330150 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_stores"
[0m13:51:18.330371 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_stores: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_stores"} */

    create table "jaffle_shop"."public_raw"."raw_stores" ("id" text,"name" text,"opened_at" timestamp without time zone,"tax_rate" float8)
  
[0m13:51:18.336188 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.006 seconds
[0m13:51:18.340037 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_stores"
[0m13:51:18.340316 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_stores: 
          insert into "jaffle_shop"."public_raw"."raw_stores" ("id", "name", "opened_at", "tax_rate") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m13:51:18.342498 [debug] [Thread-1 (]: SQL status: INSERT 0 6 in 0.002 seconds
[0m13:51:18.344511 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_stores"
[0m13:51:18.349321 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_stores: COMMIT
[0m13:51:18.349705 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_stores"
[0m13:51:18.349892 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_stores: COMMIT
[0m13:51:18.355614 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m13:51:18.356191 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_stores: Close
[0m13:51:18.356681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '434622f7-dfe4-4291-b440-9babb8ffc2ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d256570>]}
[0m13:51:18.357123 [info ] [Thread-1 (]: 5 of 6 OK loaded seed file public_raw.raw_stores ............................... [[32mINSERT 6[0m in 0.04s]
[0m13:51:18.357465 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_stores
[0m13:51:18.357729 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_supplies
[0m13:51:18.358054 [info ] [Thread-1 (]: 6 of 6 START seed file public_raw.raw_supplies ................................. [RUN]
[0m13:51:18.358326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_stores, now seed.jaffle_shop.raw_supplies)
[0m13:51:18.358538 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_supplies
[0m13:51:18.358736 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_supplies
[0m13:51:18.362157 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_supplies"
[0m13:51:18.362392 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_supplies: BEGIN
[0m13:51:18.362593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:18.370438 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m13:51:18.370832 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_supplies"
[0m13:51:18.371128 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_supplies: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_supplies"} */

    create table "jaffle_shop"."public_raw"."raw_supplies" ("id" text,"name" text,"cost" integer,"perishable" boolean,"sku" text)
  
[0m13:51:18.374312 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.003 seconds
[0m13:51:18.403807 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_supplies"
[0m13:51:18.404090 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_supplies: 
          insert into "jaffle_shop"."public_raw"."raw_supplies" ("id", "name", "cost", "perishable", "sku") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s...
[0m13:51:18.406765 [debug] [Thread-1 (]: SQL status: INSERT 0 65 in 0.002 seconds
[0m13:51:18.407152 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_supplies"
[0m13:51:18.408753 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_supplies: COMMIT
[0m13:51:18.408993 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_supplies"
[0m13:51:18.409176 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_supplies: COMMIT
[0m13:51:18.411003 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:51:18.411379 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_supplies: Close
[0m13:51:18.411680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '434622f7-dfe4-4291-b440-9babb8ffc2ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd4a120>]}
[0m13:51:18.411949 [info ] [Thread-1 (]: 6 of 6 OK loaded seed file public_raw.raw_supplies ............................. [[32mINSERT 65[0m in 0.05s]
[0m13:51:18.412233 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_supplies
[0m13:51:18.413316 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:18.413514 [debug] [MainThread]: On master: BEGIN
[0m13:51:18.413682 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:51:18.421415 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:51:18.421700 [debug] [MainThread]: On master: COMMIT
[0m13:51:18.421888 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:18.422054 [debug] [MainThread]: On master: COMMIT
[0m13:51:18.422697 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:51:18.422883 [debug] [MainThread]: On master: Close
[0m13:51:18.423156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:51:18.423316 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_supplies' was properly closed.
[0m13:51:18.423629 [info ] [MainThread]: 
[0m13:51:18.423893 [info ] [MainThread]: Finished running 6 seeds in 0 hours 1 minutes and 3.12 seconds (63.12s).
[0m13:51:18.424661 [debug] [MainThread]: Command end result
[0m13:51:18.438865 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m13:51:18.442327 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m13:51:18.454183 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/run_results.json
[0m13:51:18.454465 [info ] [MainThread]: 
[0m13:51:18.454772 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:51:18.454987 [info ] [MainThread]: 
[0m13:51:18.455213 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:51:18.455796 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 64.21744, "process_in_blocks": "0", "process_kernel_time": 0.713141, "process_mem_max_rss": "272187392", "process_out_blocks": "0", "process_user_time": 62.127327}
[0m13:51:18.456119 [debug] [MainThread]: Command `dbt seed` succeeded at 13:51:18.456066 after 64.22 seconds
[0m13:51:18.456493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104997440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10403d820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049f94f0>]}
[0m13:51:18.456722 [debug] [MainThread]: Flushing usage events
[0m13:51:18.950358 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:57:43.400675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11312fc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11319d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11319d460>]}


============================== 13:57:43.410666 | 5efcbb21-c8a3-467d-8c9b-d5ca32f996a5 ==============================
[0m13:57:43.410666 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:57:43.411207 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/logs', 'profiles_dir': '/Users/jordi.vidaldellobatera/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:57:43.771369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5efcbb21-c8a3-467d-8c9b-d5ca32f996a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f6f2f0>]}
[0m13:57:43.796044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5efcbb21-c8a3-467d-8c9b-d5ca32f996a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136c3890>]}
[0m13:57:43.800649 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:57:43.952048 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m13:57:44.566272 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:57:44.566679 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:57:44.596498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5efcbb21-c8a3-467d-8c9b-d5ca32f996a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136c3770>]}
[0m13:57:44.648930 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m13:57:44.665518 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m13:57:44.777176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5efcbb21-c8a3-467d-8c9b-d5ca32f996a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e808f0>]}
[0m13:57:44.777568 [info ] [MainThread]: Found 3 models, 6 seeds, 4 data tests, 431 macros
[0m13:57:44.777816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5efcbb21-c8a3-467d-8c9b-d5ca32f996a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11194d220>]}
[0m13:57:44.778983 [info ] [MainThread]: 
[0m13:57:44.779252 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:57:44.779429 [info ] [MainThread]: 
[0m13:57:44.779720 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:57:44.781811 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m13:57:46.247057 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m13:57:46.247502 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m13:57:46.247745 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:46.320776 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.073 seconds
[0m13:57:46.322577 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m13:57:46.323864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now list_jaffle_shop_public)
[0m13:57:46.329578 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m13:57:46.330075 [debug] [ThreadPool]: On list_jaffle_shop_public: BEGIN
[0m13:57:46.330461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:46.355092 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m13:57:46.355560 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m13:57:46.355908 [debug] [ThreadPool]: On list_jaffle_shop_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_public"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:57:46.361338 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m13:57:46.363157 [debug] [ThreadPool]: On list_jaffle_shop_public: ROLLBACK
[0m13:57:46.364566 [debug] [ThreadPool]: On list_jaffle_shop_public: Close
[0m13:57:46.365104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop_public, now list_jaffle_shop_public_raw)
[0m13:57:46.368042 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public_raw"
[0m13:57:46.368514 [debug] [ThreadPool]: On list_jaffle_shop_public_raw: BEGIN
[0m13:57:46.368869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:46.382050 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m13:57:46.382536 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public_raw"
[0m13:57:46.382925 [debug] [ThreadPool]: On list_jaffle_shop_public_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_public_raw"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw'
    union all
    select
      'jaffle_shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw'
  
[0m13:57:46.386408 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m13:57:46.387732 [debug] [ThreadPool]: On list_jaffle_shop_public_raw: ROLLBACK
[0m13:57:46.388741 [debug] [ThreadPool]: On list_jaffle_shop_public_raw: Close
[0m13:57:46.393794 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:46.394710 [debug] [MainThread]: On master: BEGIN
[0m13:57:46.395144 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:57:46.412089 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m13:57:46.412686 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:46.413149 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:57:46.421519 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m13:57:46.422804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5efcbb21-c8a3-467d-8c9b-d5ca32f996a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e58ec0>]}
[0m13:57:46.423232 [debug] [MainThread]: On master: ROLLBACK
[0m13:57:46.424262 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:46.424509 [debug] [MainThread]: On master: BEGIN
[0m13:57:46.425793 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:57:46.426087 [debug] [MainThread]: On master: COMMIT
[0m13:57:46.426439 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:46.426666 [debug] [MainThread]: On master: COMMIT
[0m13:57:46.427517 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:57:46.427743 [debug] [MainThread]: On master: Close
[0m13:57:46.428854 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m13:57:46.429245 [info ] [Thread-1 (]: 1 of 3 START sql view model public.customers ................................... [RUN]
[0m13:57:46.429599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_public_raw, now model.jaffle_shop.customers)
[0m13:57:46.429856 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m13:57:46.434278 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m13:57:46.438151 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m13:57:46.465645 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m13:57:46.474237 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m13:57:46.474589 [debug] [Thread-1 (]: On model.jaffle_shop.customers: BEGIN
[0m13:57:46.474873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:46.486604 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m13:57:46.487165 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m13:57:46.487573 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  create view "jaffle_shop"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m13:57:46.488907 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "jaffle_shop.customers" does not exist
LINE 14:     from jaffle_shop.customers
                  ^

[0m13:57:46.489251 [debug] [Thread-1 (]: On model.jaffle_shop.customers: ROLLBACK
[0m13:57:46.490648 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m13:57:46.636276 [debug] [Thread-1 (]: Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "jaffle_shop.customers" does not exist
  LINE 14:     from jaffle_shop.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m13:57:46.639493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5efcbb21-c8a3-467d-8c9b-d5ca32f996a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143f78c0>]}
[0m13:57:46.639935 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.customers .......................... [[31mERROR[0m in 0.21s]
[0m13:57:46.640299 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m13:57:46.640539 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m13:57:46.640849 [debug] [Thread-4 (]: Marking all children of 'model.jaffle_shop.customers' to be skipped because of status 'error'.  Reason: Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "jaffle_shop.customers" does not exist
  LINE 14:     from jaffle_shop.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql.
[0m13:57:46.641157 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m13:57:46.641886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.customers, now model.jaffle_shop.my_first_dbt_model)
[0m13:57:46.642118 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m13:57:46.644599 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m13:57:46.647302 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m13:57:46.660934 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m13:57:46.663718 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:57:46.664031 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: BEGIN
[0m13:57:46.664251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:46.676430 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m13:57:46.676685 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:57:46.676911 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

  create  table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m13:57:46.680268 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m13:57:46.684201 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:57:46.684513 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m13:57:46.685539 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:57:46.687186 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:57:46.687510 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m13:57:46.688217 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:57:46.699174 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m13:57:46.699441 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:57:46.699636 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m13:57:46.701993 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:57:46.705450 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_first_dbt_model__dbt_backup"
[0m13:57:46.708134 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:57:46.708371 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
drop table if exists "jaffle_shop"."public"."my_first_dbt_model__dbt_backup" cascade
[0m13:57:46.712216 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m13:57:46.713537 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m13:57:46.713893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5efcbb21-c8a3-467d-8c9b-d5ca32f996a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b15d90>]}
[0m13:57:46.714254 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.07s]
[0m13:57:46.714569 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m13:57:46.714956 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m13:57:46.715270 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m13:57:46.715570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.my_second_dbt_model)
[0m13:57:46.715784 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m13:57:46.717367 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m13:57:46.719740 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m13:57:46.721931 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m13:57:46.725164 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m13:57:46.725505 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: BEGIN
[0m13:57:46.725725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:46.736205 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m13:57:46.736632 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m13:57:46.736877 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */

  create view "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "jaffle_shop"."public"."my_first_dbt_model"
where id = 1
  );
[0m13:57:46.738328 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m13:57:46.740328 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m13:57:46.740578 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
alter table "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m13:57:46.741617 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:57:46.742494 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m13:57:46.742715 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m13:57:46.742912 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m13:57:46.743922 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:57:46.745248 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_second_dbt_model__dbt_backup"
[0m13:57:46.747143 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m13:57:46.747390 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "jaffle_shop"."public"."my_second_dbt_model__dbt_backup" cascade
[0m13:57:46.748572 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:57:46.749403 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m13:57:46.749761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5efcbb21-c8a3-467d-8c9b-d5ca32f996a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113701970>]}
[0m13:57:46.750125 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.03s]
[0m13:57:46.750447 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m13:57:46.751075 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:46.751251 [debug] [MainThread]: On master: BEGIN
[0m13:57:46.751408 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:57:46.761950 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:57:46.762246 [debug] [MainThread]: On master: COMMIT
[0m13:57:46.762504 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:46.762728 [debug] [MainThread]: On master: COMMIT
[0m13:57:46.763749 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:57:46.764023 [debug] [MainThread]: On master: Close
[0m13:57:46.764321 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:57:46.764543 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m13:57:46.765006 [info ] [MainThread]: 
[0m13:57:46.766188 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 1.99 seconds (1.99s).
[0m13:57:46.767037 [debug] [MainThread]: Command end result
[0m13:57:46.780509 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m13:57:46.782052 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m13:57:46.791232 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/run_results.json
[0m13:57:46.791523 [info ] [MainThread]: 
[0m13:57:46.791739 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:57:46.791909 [info ] [MainThread]: 
[0m13:57:46.792107 [error] [MainThread]:   Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "jaffle_shop.customers" does not exist
  LINE 14:     from jaffle_shop.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m13:57:46.792270 [info ] [MainThread]: 
[0m13:57:46.792456 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m13:57:46.792840 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.5544186, "process_in_blocks": "0", "process_kernel_time": 0.782896, "process_mem_max_rss": "114262016", "process_out_blocks": "0", "process_user_time": 2.181216}
[0m13:57:46.793089 [debug] [MainThread]: Command `dbt run` failed at 13:57:46.793040 after 3.55 seconds
[0m13:57:46.793327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11312f560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c95610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11319ce60>]}
[0m13:57:46.793520 [debug] [MainThread]: Flushing usage events
[0m13:57:46.930357 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:58:17.140811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113aa1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114999640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149992b0>]}


============================== 13:58:17.144504 | af320118-e239-4b54-896c-597c9a80069c ==============================
[0m13:58:17.144504 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:58:17.144838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/logs', 'version_check': 'True', 'profiles_dir': '/Users/jordi.vidaldellobatera/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:58:17.266732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af320118-e239-4b54-896c-597c9a80069c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110016c90>]}
[0m13:58:17.291693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af320118-e239-4b54-896c-597c9a80069c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114acb470>]}
[0m13:58:17.292780 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:58:17.358127 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m13:58:17.464771 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:58:17.465175 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://jaffle_shop/models/customers.sql
[0m13:58:17.577454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af320118-e239-4b54-896c-597c9a80069c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b3ac30>]}
[0m13:58:17.613492 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m13:58:17.615969 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m13:58:17.644258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af320118-e239-4b54-896c-597c9a80069c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11601edb0>]}
[0m13:58:17.644598 [info ] [MainThread]: Found 3 models, 6 seeds, 4 data tests, 431 macros
[0m13:58:17.644801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af320118-e239-4b54-896c-597c9a80069c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115bf33b0>]}
[0m13:58:17.645747 [info ] [MainThread]: 
[0m13:58:17.645945 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:58:17.646102 [info ] [MainThread]: 
[0m13:58:17.646356 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:58:17.648222 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m13:58:17.751041 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m13:58:17.751304 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m13:58:17.751470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:58:17.795162 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.044 seconds
[0m13:58:17.796188 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m13:58:17.797296 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now list_jaffle_shop_public_raw)
[0m13:58:17.801243 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public_raw"
[0m13:58:17.801532 [debug] [ThreadPool]: On list_jaffle_shop_public_raw: BEGIN
[0m13:58:17.801709 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:58:17.814234 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m13:58:17.814612 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public_raw"
[0m13:58:17.814862 [debug] [ThreadPool]: On list_jaffle_shop_public_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_public_raw"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw'
    union all
    select
      'jaffle_shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw'
  
[0m13:58:17.820396 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m13:58:17.821394 [debug] [ThreadPool]: On list_jaffle_shop_public_raw: ROLLBACK
[0m13:58:17.822195 [debug] [ThreadPool]: On list_jaffle_shop_public_raw: Close
[0m13:58:17.822605 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop_public_raw, now list_jaffle_shop_public)
[0m13:58:17.824617 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m13:58:17.824840 [debug] [ThreadPool]: On list_jaffle_shop_public: BEGIN
[0m13:58:17.825010 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:58:17.835515 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m13:58:17.835944 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m13:58:17.836385 [debug] [ThreadPool]: On list_jaffle_shop_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_public"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:58:17.839305 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m13:58:17.840159 [debug] [ThreadPool]: On list_jaffle_shop_public: ROLLBACK
[0m13:58:17.840834 [debug] [ThreadPool]: On list_jaffle_shop_public: Close
[0m13:58:17.844170 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:17.844441 [debug] [MainThread]: On master: BEGIN
[0m13:58:17.844618 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:58:17.855614 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m13:58:17.855925 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:17.856196 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:58:17.860350 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m13:58:17.861305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af320118-e239-4b54-896c-597c9a80069c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b8f2c0>]}
[0m13:58:17.861596 [debug] [MainThread]: On master: ROLLBACK
[0m13:58:17.862404 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:17.862598 [debug] [MainThread]: On master: BEGIN
[0m13:58:17.863758 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:58:17.864068 [debug] [MainThread]: On master: COMMIT
[0m13:58:17.864374 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:17.864575 [debug] [MainThread]: On master: COMMIT
[0m13:58:17.865275 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:58:17.865466 [debug] [MainThread]: On master: Close
[0m13:58:17.866378 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m13:58:17.866742 [info ] [Thread-1 (]: 1 of 3 START sql view model public.customers ................................... [RUN]
[0m13:58:17.867040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_public, now model.jaffle_shop.customers)
[0m13:58:17.867290 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m13:58:17.871532 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m13:58:17.872653 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m13:58:17.892106 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m13:58:17.893175 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m13:58:17.893379 [debug] [Thread-1 (]: On model.jaffle_shop.customers: BEGIN
[0m13:58:17.893544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:17.900718 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m13:58:17.901044 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m13:58:17.901327 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  create view "jaffle_shop"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from public_raw.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from public_raw.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m13:58:17.902104 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public_raw.customers" does not exist
LINE 14:     from public_raw.customers
                  ^

[0m13:58:17.902339 [debug] [Thread-1 (]: On model.jaffle_shop.customers: ROLLBACK
[0m13:58:17.903501 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m13:58:17.909682 [debug] [Thread-1 (]: Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "public_raw.customers" does not exist
  LINE 14:     from public_raw.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m13:58:17.910962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af320118-e239-4b54-896c-597c9a80069c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11603b3e0>]}
[0m13:58:17.911378 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.customers .......................... [[31mERROR[0m in 0.04s]
[0m13:58:17.911690 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m13:58:17.911899 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m13:58:17.912163 [debug] [Thread-4 (]: Marking all children of 'model.jaffle_shop.customers' to be skipped because of status 'error'.  Reason: Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "public_raw.customers" does not exist
  LINE 14:     from public_raw.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql.
[0m13:58:17.912426 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m13:58:17.913012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.customers, now model.jaffle_shop.my_first_dbt_model)
[0m13:58:17.913199 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m13:58:17.914603 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m13:58:17.915233 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m13:58:17.927053 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m13:58:17.928028 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:58:17.928233 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: BEGIN
[0m13:58:17.928403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:17.938577 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m13:58:17.938906 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:58:17.939154 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

  create  table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m13:58:17.941084 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m13:58:17.944454 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:58:17.944670 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m13:58:17.945526 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:58:17.946991 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:58:17.948241 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m13:58:17.949097 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:58:17.959291 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m13:58:17.959538 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:58:17.959721 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m13:58:17.961969 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:58:17.965146 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_first_dbt_model__dbt_backup"
[0m13:58:17.967791 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:58:17.968000 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
drop table if exists "jaffle_shop"."public"."my_first_dbt_model__dbt_backup" cascade
[0m13:58:17.971924 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m13:58:17.973279 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m13:58:17.973637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af320118-e239-4b54-896c-597c9a80069c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110015dc0>]}
[0m13:58:17.973986 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.06s]
[0m13:58:17.974313 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m13:58:17.974702 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m13:58:17.975042 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m13:58:17.975366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.my_second_dbt_model)
[0m13:58:17.975579 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m13:58:17.977148 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m13:58:17.977902 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m13:58:17.979729 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m13:58:17.980279 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m13:58:17.980604 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: BEGIN
[0m13:58:17.980858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:17.989257 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m13:58:17.989568 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m13:58:17.989777 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */

  create view "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "jaffle_shop"."public"."my_first_dbt_model"
where id = 1
  );
[0m13:58:17.991356 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m13:58:17.993152 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m13:58:17.993366 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
alter table "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m13:58:17.994254 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:58:17.995052 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m13:58:17.995270 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m13:58:17.995451 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m13:58:17.996393 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:58:17.997653 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_second_dbt_model__dbt_backup"
[0m13:58:17.999458 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m13:58:17.999711 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "jaffle_shop"."public"."my_second_dbt_model__dbt_backup" cascade
[0m13:58:18.000470 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:58:18.001256 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m13:58:18.001605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af320118-e239-4b54-896c-597c9a80069c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116719070>]}
[0m13:58:18.001974 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.03s]
[0m13:58:18.002296 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m13:58:18.002891 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:18.003083 [debug] [MainThread]: On master: BEGIN
[0m13:58:18.003251 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:58:18.011528 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:58:18.011971 [debug] [MainThread]: On master: COMMIT
[0m13:58:18.012240 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:18.012416 [debug] [MainThread]: On master: COMMIT
[0m13:58:18.013661 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:58:18.013912 [debug] [MainThread]: On master: Close
[0m13:58:18.014163 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:58:18.014315 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m13:58:18.014524 [info ] [MainThread]: 
[0m13:58:18.014708 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m13:58:18.015300 [debug] [MainThread]: Command end result
[0m13:58:18.027319 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m13:58:18.029071 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m13:58:18.032242 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/run_results.json
[0m13:58:18.032442 [info ] [MainThread]: 
[0m13:58:18.032639 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:58:18.032805 [info ] [MainThread]: 
[0m13:58:18.033000 [error] [MainThread]:   Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "public_raw.customers" does not exist
  LINE 14:     from public_raw.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m13:58:18.033158 [info ] [MainThread]: 
[0m13:58:18.033319 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m13:58:18.033640 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.95122206, "process_in_blocks": "0", "process_kernel_time": 0.263301, "process_mem_max_rss": "122273792", "process_out_blocks": "0", "process_user_time": 1.11194}
[0m13:58:18.033869 [debug] [MainThread]: Command `dbt run` failed at 13:58:18.033829 after 0.95 seconds
[0m13:58:18.034076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114999640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115af78f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100d8830>]}
[0m13:58:18.034260 [debug] [MainThread]: Flushing usage events
[0m13:58:18.427278 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:01:04.391909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101587b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104671880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046714f0>]}


============================== 14:01:04.396796 | f621ab78-8429-4de7-8d79-1447302909af ==============================
[0m14:01:04.396796 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:01:04.397147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jordi.vidaldellobatera/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:01:04.525062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f621ab78-8429-4de7-8d79-1447302909af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e32f0>]}
[0m14:01:04.550134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f621ab78-8429-4de7-8d79-1447302909af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fbc680>]}
[0m14:01:04.551173 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:01:04.617378 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m14:01:04.663332 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:01:04.663649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f621ab78-8429-4de7-8d79-1447302909af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104189a00>]}
[0m14:01:05.269462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f621ab78-8429-4de7-8d79-1447302909af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105541ac0>]}
[0m14:01:05.305304 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m14:01:05.307718 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m14:01:05.337168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f621ab78-8429-4de7-8d79-1447302909af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10558f890>]}
[0m14:01:05.337476 [info ] [MainThread]: Found 3 models, 6 seeds, 4 data tests, 431 macros
[0m14:01:05.337674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f621ab78-8429-4de7-8d79-1447302909af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055c3b00>]}
[0m14:01:05.338665 [info ] [MainThread]: 
[0m14:01:05.338862 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:01:05.339016 [info ] [MainThread]: 
[0m14:01:05.339257 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:01:05.341186 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m14:01:05.458534 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m14:01:05.458805 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m14:01:05.458963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:05.497024 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.038 seconds
[0m14:01:05.497949 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m14:01:05.498445 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_public_public)
[0m14:01:05.499144 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "public_public"
"
[0m14:01:05.503323 [debug] [ThreadPool]: Using postgres connection "create_jaffle_shop_public_public"
[0m14:01:05.503568 [debug] [ThreadPool]: On create_jaffle_shop_public_public: BEGIN
[0m14:01:05.503747 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:01:05.513016 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:01:05.513299 [debug] [ThreadPool]: Using postgres connection "create_jaffle_shop_public_public"
[0m14:01:05.513498 [debug] [ThreadPool]: On create_jaffle_shop_public_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_public_public"} */
create schema if not exists "public_public"
[0m14:01:05.515169 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m14:01:05.515796 [debug] [ThreadPool]: On create_jaffle_shop_public_public: COMMIT
[0m14:01:05.516029 [debug] [ThreadPool]: Using postgres connection "create_jaffle_shop_public_public"
[0m14:01:05.516210 [debug] [ThreadPool]: On create_jaffle_shop_public_public: COMMIT
[0m14:01:05.517812 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m14:01:05.518001 [debug] [ThreadPool]: On create_jaffle_shop_public_public: Close
[0m14:01:05.519037 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_jaffle_shop_public_public, now list_jaffle_shop_public_public)
[0m14:01:05.522705 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public_public"
[0m14:01:05.522962 [debug] [ThreadPool]: On list_jaffle_shop_public_public: BEGIN
[0m14:01:05.523142 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:01:05.533435 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m14:01:05.533718 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public_public"
[0m14:01:05.533921 [debug] [ThreadPool]: On list_jaffle_shop_public_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_public_public"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'jaffle_shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m14:01:05.537316 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m14:01:05.538130 [debug] [ThreadPool]: On list_jaffle_shop_public_public: ROLLBACK
[0m14:01:05.538754 [debug] [ThreadPool]: On list_jaffle_shop_public_public: Close
[0m14:01:05.539092 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop_public_public, now list_jaffle_shop_public)
[0m14:01:05.540499 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m14:01:05.540734 [debug] [ThreadPool]: On list_jaffle_shop_public: BEGIN
[0m14:01:05.540916 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:01:05.548993 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:01:05.549246 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m14:01:05.549516 [debug] [ThreadPool]: On list_jaffle_shop_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_public"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:01:05.551728 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m14:01:05.552560 [debug] [ThreadPool]: On list_jaffle_shop_public: ROLLBACK
[0m14:01:05.553242 [debug] [ThreadPool]: On list_jaffle_shop_public: Close
[0m14:01:05.556379 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:05.556618 [debug] [MainThread]: On master: BEGIN
[0m14:01:05.556801 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:01:05.564652 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:01:05.564897 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:05.565140 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:01:05.568706 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m14:01:05.569679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f621ab78-8429-4de7-8d79-1447302909af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054e9280>]}
[0m14:01:05.569991 [debug] [MainThread]: On master: ROLLBACK
[0m14:01:05.570611 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:05.570800 [debug] [MainThread]: On master: BEGIN
[0m14:01:05.571700 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:01:05.571934 [debug] [MainThread]: On master: COMMIT
[0m14:01:05.572128 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:05.572310 [debug] [MainThread]: On master: COMMIT
[0m14:01:05.572843 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:01:05.573025 [debug] [MainThread]: On master: Close
[0m14:01:05.573848 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m14:01:05.574167 [info ] [Thread-1 (]: 1 of 6 START seed file public_public.raw_customers ............................. [RUN]
[0m14:01:05.574482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_public, now seed.jaffle_shop.raw_customers)
[0m14:01:05.574806 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m14:01:05.575023 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m14:01:05.592849 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m14:01:05.593120 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: BEGIN
[0m14:01:05.593295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:01:05.600704 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:01:05.601015 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m14:01:05.601246 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */

    create table "jaffle_shop"."public_public"."raw_customers" ("id" text,"name" text)
  
[0m14:01:05.605702 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.004 seconds
[0m14:01:05.765170 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m14:01:05.765470 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: 
          insert into "jaffle_shop"."public_public"."raw_customers" ("id", "name") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s...
[0m14:01:05.776407 [debug] [Thread-1 (]: SQL status: INSERT 0 930 in 0.011 seconds
[0m14:01:05.779929 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m14:01:05.797471 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: COMMIT
[0m14:01:05.797718 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m14:01:05.797911 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: COMMIT
[0m14:01:05.800768 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:01:05.801761 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m14:01:05.803534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f621ab78-8429-4de7-8d79-1447302909af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10176dc70>]}
[0m14:01:05.803858 [info ] [Thread-1 (]: 1 of 6 OK loaded seed file public_public.raw_customers ......................... [[32mINSERT 930[0m in 0.23s]
[0m14:01:05.804171 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m14:01:05.804387 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_items
[0m14:01:05.804669 [info ] [Thread-1 (]: 2 of 6 START seed file public_public.raw_items ................................. [RUN]
[0m14:01:05.804899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_customers, now seed.jaffle_shop.raw_items)
[0m14:01:05.805087 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_items
[0m14:01:05.805265 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_items
[0m14:01:06.079150 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m14:01:06.079443 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: BEGIN
[0m14:01:06.079619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:01:06.094299 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m14:01:06.094547 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m14:01:06.094756 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_items"} */

    create table "jaffle_shop"."public_public"."raw_items" ("id" text,"order_id" text,"sku" text)
  
[0m14:01:06.098429 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.003 seconds
[0m14:01:08.604399 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m14:01:08.604746 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: 
          insert into "jaffle_shop"."public_public"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m14:01:08.660035 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.055 seconds
[0m14:01:11.273583 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m14:01:11.274230 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: 
          insert into "jaffle_shop"."public_public"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m14:01:11.335863 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.061 seconds
[0m14:01:13.863903 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m14:01:13.864200 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: 
          insert into "jaffle_shop"."public_public"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m14:01:13.920792 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.056 seconds
[0m14:01:16.329194 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m14:01:16.329484 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: 
          insert into "jaffle_shop"."public_public"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m14:01:16.420934 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.091 seconds
[0m14:01:18.898999 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m14:01:18.900086 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: 
          insert into "jaffle_shop"."public_public"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m14:01:18.959010 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.059 seconds
[0m14:01:21.515676 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m14:01:21.516001 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: 
          insert into "jaffle_shop"."public_public"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m14:01:21.580393 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.064 seconds
[0m14:01:24.069137 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m14:01:24.069505 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: 
          insert into "jaffle_shop"."public_public"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m14:01:24.121820 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.052 seconds
[0m14:01:26.580672 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m14:01:26.581817 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: 
          insert into "jaffle_shop"."public_public"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m14:01:26.640788 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.059 seconds
[0m14:01:29.237549 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m14:01:29.237861 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: 
          insert into "jaffle_shop"."public_public"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m14:01:29.305665 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.067 seconds
[0m14:01:29.359081 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m14:01:29.359358 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: 
          insert into "jaffle_shop"."public_public"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m14:01:29.361322 [debug] [Thread-1 (]: SQL status: INSERT 0 183 in 0.002 seconds
[0m14:01:29.362667 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_items"
[0m14:01:29.389952 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: COMMIT
[0m14:01:29.390232 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m14:01:29.390429 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: COMMIT
[0m14:01:29.392251 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:01:29.392900 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: Close
[0m14:01:29.393964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f621ab78-8429-4de7-8d79-1447302909af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058a70b0>]}
[0m14:01:29.394519 [info ] [Thread-1 (]: 2 of 6 OK loaded seed file public_public.raw_items ............................. [[32mINSERT 90183[0m in 23.59s]
[0m14:01:29.394953 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_items
[0m14:01:29.395280 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_orders
[0m14:01:29.395950 [info ] [Thread-1 (]: 3 of 6 START seed file public_public.raw_orders ................................ [RUN]
[0m14:01:29.396341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_items, now seed.jaffle_shop.raw_orders)
[0m14:01:29.396604 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m14:01:29.396829 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_orders
[0m14:01:30.740999 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m14:01:30.741288 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: BEGIN
[0m14:01:30.741474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:01:30.756847 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m14:01:30.757163 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m14:01:30.757387 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */

    create table "jaffle_shop"."public_public"."raw_orders" ("id" text,"customer" text,"ordered_at" timestamp without time zone,"store_id" text,"subtotal" integer,"tax_paid" integer,"order_total" integer)
  
[0m14:01:30.763642 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.006 seconds
[0m14:01:36.411815 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m14:01:36.412846 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: 
          insert into "jaffle_shop"."public_public"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),...
[0m14:01:36.537660 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.124 seconds
[0m14:01:42.341177 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m14:01:42.341878 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: 
          insert into "jaffle_shop"."public_public"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),...
[0m14:01:42.472869 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.131 seconds
[0m14:01:48.292955 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m14:01:48.293525 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: 
          insert into "jaffle_shop"."public_public"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),...
[0m14:01:48.432937 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.139 seconds
[0m14:01:54.200253 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m14:01:54.201313 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: 
          insert into "jaffle_shop"."public_public"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),...
[0m14:01:54.324843 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.123 seconds
[0m14:02:00.153425 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m14:02:00.153846 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: 
          insert into "jaffle_shop"."public_public"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),...
[0m14:02:00.270797 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.117 seconds
[0m14:02:06.025025 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m14:02:06.026106 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: 
          insert into "jaffle_shop"."public_public"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),...
[0m14:02:06.144046 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.118 seconds
[0m14:02:07.941421 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m14:02:07.941738 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: 
          insert into "jaffle_shop"."public_public"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),...
[0m14:02:07.983112 [debug] [Thread-1 (]: SQL status: INSERT 0 3148 in 0.041 seconds
[0m14:02:07.984729 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m14:02:07.999138 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: COMMIT
[0m14:02:07.999444 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m14:02:07.999671 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: COMMIT
[0m14:02:08.001924 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:02:08.002722 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: Close
[0m14:02:08.003777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f621ab78-8429-4de7-8d79-1447302909af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a639430>]}
[0m14:02:08.004340 [info ] [Thread-1 (]: 3 of 6 OK loaded seed file public_public.raw_orders ............................ [[32mINSERT 63148[0m in 38.61s]
[0m14:02:08.004797 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_orders
[0m14:02:08.005158 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_products
[0m14:02:08.005568 [info ] [Thread-1 (]: 4 of 6 START seed file public_public.raw_products .............................. [RUN]
[0m14:02:08.006087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_orders, now seed.jaffle_shop.raw_products)
[0m14:02:08.006329 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_products
[0m14:02:08.006574 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_products
[0m14:02:08.011641 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_products"
[0m14:02:08.012107 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_products: BEGIN
[0m14:02:08.012411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:02:08.024289 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m14:02:08.024630 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_products"
[0m14:02:08.024892 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_products"} */

    create table "jaffle_shop"."public_public"."raw_products" ("sku" text,"name" text,"type" text,"price" integer,"description" text)
  
[0m14:02:08.030828 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.006 seconds
[0m14:02:08.041265 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_products"
[0m14:02:08.042960 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_products: 
          insert into "jaffle_shop"."public_public"."raw_products" ("sku", "name", "type", "price", "description") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)
      ...
[0m14:02:08.053884 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.006 seconds
[0m14:02:08.059736 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_products"
[0m14:02:08.070990 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_products: COMMIT
[0m14:02:08.071314 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_products"
[0m14:02:08.071522 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_products: COMMIT
[0m14:02:08.073371 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:02:08.074562 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_products: Close
[0m14:02:08.075483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f621ab78-8429-4de7-8d79-1447302909af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab0e9c0>]}
[0m14:02:08.077039 [info ] [Thread-1 (]: 4 of 6 OK loaded seed file public_public.raw_products .......................... [[32mINSERT 10[0m in 0.07s]
[0m14:02:08.078037 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_products
[0m14:02:08.078705 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_stores
[0m14:02:08.079933 [info ] [Thread-1 (]: 5 of 6 START seed file public_public.raw_stores ................................ [RUN]
[0m14:02:08.080412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_products, now seed.jaffle_shop.raw_stores)
[0m14:02:08.081783 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_stores
[0m14:02:08.082697 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_stores
[0m14:02:08.086710 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_stores"
[0m14:02:08.087017 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_stores: BEGIN
[0m14:02:08.087218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:02:08.102148 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m14:02:08.102473 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_stores"
[0m14:02:08.102768 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_stores: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_stores"} */

    create table "jaffle_shop"."public_public"."raw_stores" ("id" text,"name" text,"opened_at" timestamp without time zone,"tax_rate" float8)
  
[0m14:02:08.105805 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.003 seconds
[0m14:02:08.109138 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_stores"
[0m14:02:08.109512 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_stores: 
          insert into "jaffle_shop"."public_public"."raw_stores" ("id", "name", "opened_at", "tax_rate") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m14:02:08.111155 [debug] [Thread-1 (]: SQL status: INSERT 0 6 in 0.001 seconds
[0m14:02:08.111664 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_stores"
[0m14:02:08.117772 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_stores: COMMIT
[0m14:02:08.118307 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_stores"
[0m14:02:08.118525 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_stores: COMMIT
[0m14:02:08.124536 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:02:08.125982 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_stores: Close
[0m14:02:08.127919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f621ab78-8429-4de7-8d79-1447302909af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e9a900>]}
[0m14:02:08.133400 [info ] [Thread-1 (]: 5 of 6 OK loaded seed file public_public.raw_stores ............................ [[32mINSERT 6[0m in 0.05s]
[0m14:02:08.134232 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_stores
[0m14:02:08.136335 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_supplies
[0m14:02:08.136991 [info ] [Thread-1 (]: 6 of 6 START seed file public_public.raw_supplies .............................. [RUN]
[0m14:02:08.138280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_stores, now seed.jaffle_shop.raw_supplies)
[0m14:02:08.140340 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_supplies
[0m14:02:08.141061 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_supplies
[0m14:02:08.154388 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_supplies"
[0m14:02:08.156903 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_supplies: BEGIN
[0m14:02:08.157801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:02:08.173258 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m14:02:08.173772 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_supplies"
[0m14:02:08.174037 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_supplies: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_supplies"} */

    create table "jaffle_shop"."public_public"."raw_supplies" ("id" text,"name" text,"cost" integer,"perishable" boolean,"sku" text)
  
[0m14:02:08.177419 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.003 seconds
[0m14:02:08.208005 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_supplies"
[0m14:02:08.208322 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_supplies: 
          insert into "jaffle_shop"."public_public"."raw_supplies" ("id", "name", "cost", "perishable", "sku") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s...
[0m14:02:08.209967 [debug] [Thread-1 (]: SQL status: INSERT 0 65 in 0.001 seconds
[0m14:02:08.210422 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_supplies"
[0m14:02:08.219916 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_supplies: COMMIT
[0m14:02:08.220195 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_supplies"
[0m14:02:08.220419 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_supplies: COMMIT
[0m14:02:08.221502 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:02:08.222023 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_supplies: Close
[0m14:02:08.222382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f621ab78-8429-4de7-8d79-1447302909af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afd1bb0>]}
[0m14:02:08.222708 [info ] [Thread-1 (]: 6 of 6 OK loaded seed file public_public.raw_supplies .......................... [[32mINSERT 65[0m in 0.08s]
[0m14:02:08.223040 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_supplies
[0m14:02:08.224448 [debug] [MainThread]: Using postgres connection "master"
[0m14:02:08.224695 [debug] [MainThread]: On master: BEGIN
[0m14:02:08.224890 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:02:08.235679 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m14:02:08.236342 [debug] [MainThread]: On master: COMMIT
[0m14:02:08.236577 [debug] [MainThread]: Using postgres connection "master"
[0m14:02:08.236764 [debug] [MainThread]: On master: COMMIT
[0m14:02:08.237654 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:02:08.237862 [debug] [MainThread]: On master: Close
[0m14:02:08.238142 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:02:08.238307 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_supplies' was properly closed.
[0m14:02:08.238557 [info ] [MainThread]: 
[0m14:02:08.238767 [info ] [MainThread]: Finished running 6 seeds in 0 hours 1 minutes and 2.90 seconds (62.90s).
[0m14:02:08.239909 [debug] [MainThread]: Command end result
[0m14:02:08.254551 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m14:02:08.260218 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m14:02:08.265361 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/run_results.json
[0m14:02:08.265636 [info ] [MainThread]: 
[0m14:02:08.265915 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:02:08.266128 [info ] [MainThread]: 
[0m14:02:08.266327 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m14:02:08.266862 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 63.948532, "process_in_blocks": "0", "process_kernel_time": 0.719991, "process_mem_max_rss": "272105472", "process_out_blocks": "0", "process_user_time": 62.06617}
[0m14:02:08.267159 [debug] [MainThread]: Command `dbt seed` succeeded at 14:02:08.267115 after 63.95 seconds
[0m14:02:08.267469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101587b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dbb260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103db8e00>]}
[0m14:02:08.267685 [debug] [MainThread]: Flushing usage events
[0m14:02:08.735045 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:02:44.872784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103869af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106845730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068453a0>]}


============================== 14:02:44.876855 | f87572dc-754c-4e20-b90d-be8e4e9185c9 ==============================
[0m14:02:44.876855 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:02:44.877230 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jordi.vidaldellobatera/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:02:45.010634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f87572dc-754c-4e20-b90d-be8e4e9185c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10395aa80>]}
[0m14:02:45.038212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f87572dc-754c-4e20-b90d-be8e4e9185c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106847c80>]}
[0m14:02:45.039416 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:02:45.109077 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m14:02:45.158081 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:02:45.158440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f87572dc-754c-4e20-b90d-be8e4e9185c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e2720>]}
[0m14:02:45.779396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f87572dc-754c-4e20-b90d-be8e4e9185c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107796240>]}
[0m14:02:45.815041 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m14:02:45.817724 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m14:02:45.841017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f87572dc-754c-4e20-b90d-be8e4e9185c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ab200>]}
[0m14:02:45.841310 [info ] [MainThread]: Found 3 models, 6 seeds, 4 data tests, 431 macros
[0m14:02:45.841500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f87572dc-754c-4e20-b90d-be8e4e9185c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e0d40>]}
[0m14:02:45.842452 [info ] [MainThread]: 
[0m14:02:45.842637 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:02:45.842788 [info ] [MainThread]: 
[0m14:02:45.843027 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:02:45.845037 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m14:02:45.956046 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m14:02:45.956322 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m14:02:45.956503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:02:45.997468 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.041 seconds
[0m14:02:45.998408 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m14:02:45.999493 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now list_jaffle_shop_public)
[0m14:02:46.003480 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m14:02:46.003767 [debug] [ThreadPool]: On list_jaffle_shop_public: BEGIN
[0m14:02:46.003957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:02:46.012828 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:02:46.013115 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m14:02:46.013321 [debug] [ThreadPool]: On list_jaffle_shop_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_public"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:02:46.016513 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m14:02:46.017422 [debug] [ThreadPool]: On list_jaffle_shop_public: ROLLBACK
[0m14:02:46.018197 [debug] [ThreadPool]: On list_jaffle_shop_public: Close
[0m14:02:46.022380 [debug] [MainThread]: Using postgres connection "master"
[0m14:02:46.022645 [debug] [MainThread]: On master: BEGIN
[0m14:02:46.022827 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:02:46.030753 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:02:46.031052 [debug] [MainThread]: Using postgres connection "master"
[0m14:02:46.031397 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:02:46.035012 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m14:02:46.035896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f87572dc-754c-4e20-b90d-be8e4e9185c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077bfc20>]}
[0m14:02:46.036176 [debug] [MainThread]: On master: ROLLBACK
[0m14:02:46.036870 [debug] [MainThread]: Using postgres connection "master"
[0m14:02:46.037072 [debug] [MainThread]: On master: BEGIN
[0m14:02:46.038135 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:02:46.038349 [debug] [MainThread]: On master: COMMIT
[0m14:02:46.038588 [debug] [MainThread]: Using postgres connection "master"
[0m14:02:46.038772 [debug] [MainThread]: On master: COMMIT
[0m14:02:46.039424 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:02:46.039616 [debug] [MainThread]: On master: Close
[0m14:02:46.040467 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m14:02:46.040781 [info ] [Thread-1 (]: 1 of 6 START seed file public.raw_customers .................................... [RUN]
[0m14:02:46.041057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_public, now seed.jaffle_shop.raw_customers)
[0m14:02:46.041266 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m14:02:46.041526 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m14:02:46.059647 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m14:02:46.059929 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: BEGIN
[0m14:02:46.060116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:02:46.070181 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m14:02:46.070556 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m14:02:46.070808 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */

    create table "jaffle_shop"."public"."raw_customers" ("id" text,"name" text)
  
[0m14:02:46.074813 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.004 seconds
[0m14:02:46.232036 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m14:02:46.232318 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: 
          insert into "jaffle_shop"."public"."raw_customers" ("id", "name") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%...
[0m14:02:46.241776 [debug] [Thread-1 (]: SQL status: INSERT 0 930 in 0.009 seconds
[0m14:02:46.245110 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m14:02:46.256313 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: COMMIT
[0m14:02:46.256545 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m14:02:46.256726 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: COMMIT
[0m14:02:46.262328 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m14:02:46.263331 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m14:02:46.264939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f87572dc-754c-4e20-b90d-be8e4e9185c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ea000>]}
[0m14:02:46.265259 [info ] [Thread-1 (]: 1 of 6 OK loaded seed file public.raw_customers ................................ [[32mINSERT 930[0m in 0.22s]
[0m14:02:46.265580 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m14:02:46.265840 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_items
[0m14:02:46.266141 [info ] [Thread-1 (]: 2 of 6 START seed file public.raw_items ........................................ [RUN]
[0m14:02:46.266388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_customers, now seed.jaffle_shop.raw_items)
[0m14:02:46.266584 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_items
[0m14:02:46.266770 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_items
[0m14:02:46.532988 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m14:02:46.533259 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: BEGIN
[0m14:02:46.533429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:02:46.546204 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m14:02:46.546450 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m14:02:46.546670 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_items"} */

    create table "jaffle_shop"."public"."raw_items" ("id" text,"order_id" text,"sku" text)
  
[0m14:02:46.550610 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.004 seconds
[0m14:02:48.950954 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m14:02:48.951254 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: 
          insert into "jaffle_shop"."public"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,...
[0m14:02:49.020566 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.069 seconds
[0m14:02:51.504821 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m14:02:51.505119 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: 
          insert into "jaffle_shop"."public"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,...
[0m14:02:51.579348 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.074 seconds
[0m14:02:54.174540 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m14:02:54.175623 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: 
          insert into "jaffle_shop"."public"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,...
[0m14:02:54.232222 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.056 seconds
[0m14:02:56.648405 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m14:02:56.648698 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: 
          insert into "jaffle_shop"."public"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,...
[0m14:02:56.702994 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.054 seconds
[0m14:02:59.106215 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m14:02:59.106508 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: 
          insert into "jaffle_shop"."public"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,...
[0m14:02:59.163659 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.057 seconds
[0m14:03:01.580814 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m14:03:01.581534 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: 
          insert into "jaffle_shop"."public"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,...
[0m14:03:01.637778 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.056 seconds
[0m14:03:04.047114 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m14:03:04.047439 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: 
          insert into "jaffle_shop"."public"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,...
[0m14:03:04.127112 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.079 seconds
[0m14:03:06.558182 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m14:03:06.558494 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: 
          insert into "jaffle_shop"."public"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,...
[0m14:03:06.606452 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.048 seconds
[0m14:03:09.005888 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m14:03:09.006330 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: 
          insert into "jaffle_shop"."public"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,...
[0m14:03:09.058974 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.052 seconds
[0m14:03:09.111440 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m14:03:09.111759 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: 
          insert into "jaffle_shop"."public"."raw_items" ("id", "order_id", "sku") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,...
[0m14:03:09.113482 [debug] [Thread-1 (]: SQL status: INSERT 0 183 in 0.001 seconds
[0m14:03:09.114315 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_items"
[0m14:03:09.116240 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: COMMIT
[0m14:03:09.116479 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_items"
[0m14:03:09.116663 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: COMMIT
[0m14:03:09.118584 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:03:09.119139 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_items: Close
[0m14:03:09.119563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f87572dc-754c-4e20-b90d-be8e4e9185c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077616d0>]}
[0m14:03:09.119881 [info ] [Thread-1 (]: 2 of 6 OK loaded seed file public.raw_items .................................... [[32mINSERT 90183[0m in 22.85s]
[0m14:03:09.120194 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_items
[0m14:03:09.120434 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_orders
[0m14:03:09.120708 [info ] [Thread-1 (]: 3 of 6 START seed file public.raw_orders ....................................... [RUN]
[0m14:03:09.121091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_items, now seed.jaffle_shop.raw_orders)
[0m14:03:09.121362 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m14:03:09.121579 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_orders
[0m14:03:10.589496 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m14:03:10.589834 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: BEGIN
[0m14:03:10.590035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:03:10.608449 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m14:03:10.608791 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m14:03:10.609004 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */

    create table "jaffle_shop"."public"."raw_orders" ("id" text,"customer" text,"ordered_at" timestamp without time zone,"store_id" text,"subtotal" integer,"tax_paid" integer,"order_total" integer)
  
[0m14:03:10.617411 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.008 seconds
[0m14:03:16.126568 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m14:03:16.126869 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: 
          insert into "jaffle_shop"."public"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,...
[0m14:03:16.257722 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.131 seconds
[0m14:03:22.071717 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m14:03:22.072418 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: 
          insert into "jaffle_shop"."public"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,...
[0m14:03:22.227137 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.154 seconds
[0m14:03:27.933805 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m14:03:27.934111 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: 
          insert into "jaffle_shop"."public"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,...
[0m14:03:28.058454 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.124 seconds
[0m14:03:33.704021 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m14:03:33.705395 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: 
          insert into "jaffle_shop"."public"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,...
[0m14:03:33.818452 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.112 seconds
[0m14:03:39.796008 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m14:03:39.797256 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: 
          insert into "jaffle_shop"."public"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,...
[0m14:03:39.925048 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.127 seconds
[0m14:03:45.569005 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m14:03:45.569456 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: 
          insert into "jaffle_shop"."public"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,...
[0m14:03:45.689258 [debug] [Thread-1 (]: SQL status: INSERT 0 10000 in 0.119 seconds
[0m14:03:47.486575 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m14:03:47.486886 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: 
          insert into "jaffle_shop"."public"."raw_orders" ("id", "customer", "ordered_at", "store_id", "subtotal", "tax_paid", "order_total") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,...
[0m14:03:47.545805 [debug] [Thread-1 (]: SQL status: INSERT 0 3148 in 0.059 seconds
[0m14:03:47.547793 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m14:03:47.566732 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: COMMIT
[0m14:03:47.567045 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m14:03:47.567274 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: COMMIT
[0m14:03:47.569540 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:03:47.570336 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: Close
[0m14:03:47.571353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f87572dc-754c-4e20-b90d-be8e4e9185c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c185af0>]}
[0m14:03:47.572020 [info ] [Thread-1 (]: 3 of 6 OK loaded seed file public.raw_orders ................................... [[32mINSERT 63148[0m in 38.45s]
[0m14:03:47.572520 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_orders
[0m14:03:47.572991 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_products
[0m14:03:47.573680 [info ] [Thread-1 (]: 4 of 6 START seed file public.raw_products ..................................... [RUN]
[0m14:03:47.574021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_orders, now seed.jaffle_shop.raw_products)
[0m14:03:47.574252 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_products
[0m14:03:47.574468 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_products
[0m14:03:47.578872 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_products"
[0m14:03:47.579150 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_products: BEGIN
[0m14:03:47.579543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:03:47.595141 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m14:03:47.597278 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_products"
[0m14:03:47.598203 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_products"} */

    create table "jaffle_shop"."public"."raw_products" ("sku" text,"name" text,"type" text,"price" integer,"description" text)
  
[0m14:03:47.605946 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.007 seconds
[0m14:03:47.612511 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_products"
[0m14:03:47.612819 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_products: 
          insert into "jaffle_shop"."public"."raw_products" ("sku", "name", "type", "price", "description") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)
      ...
[0m14:03:47.614100 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.001 seconds
[0m14:03:47.614518 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_products"
[0m14:03:47.616260 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_products: COMMIT
[0m14:03:47.616473 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_products"
[0m14:03:47.616650 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_products: COMMIT
[0m14:03:47.618131 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:03:47.618615 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_products: Close
[0m14:03:47.618952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f87572dc-754c-4e20-b90d-be8e4e9185c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8d9b80>]}
[0m14:03:47.619309 [info ] [Thread-1 (]: 4 of 6 OK loaded seed file public.raw_products ................................. [[32mINSERT 10[0m in 0.04s]
[0m14:03:47.620100 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_products
[0m14:03:47.620393 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_stores
[0m14:03:47.620708 [info ] [Thread-1 (]: 5 of 6 START seed file public.raw_stores ....................................... [RUN]
[0m14:03:47.621087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_products, now seed.jaffle_shop.raw_stores)
[0m14:03:47.621312 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_stores
[0m14:03:47.621504 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_stores
[0m14:03:47.625203 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_stores"
[0m14:03:47.625547 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_stores: BEGIN
[0m14:03:47.625721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:03:47.638404 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m14:03:47.639011 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_stores"
[0m14:03:47.639320 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_stores: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_stores"} */

    create table "jaffle_shop"."public"."raw_stores" ("id" text,"name" text,"opened_at" timestamp without time zone,"tax_rate" float8)
  
[0m14:03:47.642820 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.003 seconds
[0m14:03:47.646757 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_stores"
[0m14:03:47.647056 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_stores: 
          insert into "jaffle_shop"."public"."raw_stores" ("id", "name", "opened_at", "tax_rate") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m14:03:47.648205 [debug] [Thread-1 (]: SQL status: INSERT 0 6 in 0.001 seconds
[0m14:03:47.648612 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_stores"
[0m14:03:47.650244 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_stores: COMMIT
[0m14:03:47.650452 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_stores"
[0m14:03:47.650627 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_stores: COMMIT
[0m14:03:47.651380 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:03:47.651740 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_stores: Close
[0m14:03:47.652099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f87572dc-754c-4e20-b90d-be8e4e9185c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c46fd40>]}
[0m14:03:47.652420 [info ] [Thread-1 (]: 5 of 6 OK loaded seed file public.raw_stores ................................... [[32mINSERT 6[0m in 0.03s]
[0m14:03:47.652722 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_stores
[0m14:03:47.652935 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_supplies
[0m14:03:47.653372 [info ] [Thread-1 (]: 6 of 6 START seed file public.raw_supplies ..................................... [RUN]
[0m14:03:47.653664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_stores, now seed.jaffle_shop.raw_supplies)
[0m14:03:47.653876 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_supplies
[0m14:03:47.654064 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_supplies
[0m14:03:47.657155 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_supplies"
[0m14:03:47.657381 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_supplies: BEGIN
[0m14:03:47.657550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:03:47.665297 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m14:03:47.665670 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_supplies"
[0m14:03:47.665917 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_supplies: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_supplies"} */

    create table "jaffle_shop"."public"."raw_supplies" ("id" text,"name" text,"cost" integer,"perishable" boolean,"sku" text)
  
[0m14:03:47.668932 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.003 seconds
[0m14:03:47.699235 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_supplies"
[0m14:03:47.699577 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_supplies: 
          insert into "jaffle_shop"."public"."raw_supplies" ("id", "name", "cost", "perishable", "sku") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)...
[0m14:03:47.701477 [debug] [Thread-1 (]: SQL status: INSERT 0 65 in 0.002 seconds
[0m14:03:47.701868 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_supplies"
[0m14:03:47.703560 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_supplies: COMMIT
[0m14:03:47.703787 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_supplies"
[0m14:03:47.704003 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_supplies: COMMIT
[0m14:03:47.705010 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:03:47.705411 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_supplies: Close
[0m14:03:47.705725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f87572dc-754c-4e20-b90d-be8e4e9185c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0b1640>]}
[0m14:03:47.706071 [info ] [Thread-1 (]: 6 of 6 OK loaded seed file public.raw_supplies ................................. [[32mINSERT 65[0m in 0.05s]
[0m14:03:47.706384 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_supplies
[0m14:03:47.707447 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:47.707645 [debug] [MainThread]: On master: BEGIN
[0m14:03:47.707801 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:03:47.715825 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:03:47.716165 [debug] [MainThread]: On master: COMMIT
[0m14:03:47.716370 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:47.716538 [debug] [MainThread]: On master: COMMIT
[0m14:03:47.717232 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:03:47.717458 [debug] [MainThread]: On master: Close
[0m14:03:47.717771 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:03:47.717942 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_supplies' was properly closed.
[0m14:03:47.718194 [info ] [MainThread]: 
[0m14:03:47.718402 [info ] [MainThread]: Finished running 6 seeds in 0 hours 1 minutes and 1.88 seconds (61.88s).
[0m14:03:47.719091 [debug] [MainThread]: Command end result
[0m14:03:47.732344 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m14:03:47.735562 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m14:03:47.739808 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/run_results.json
[0m14:03:47.740050 [info ] [MainThread]: 
[0m14:03:47.740326 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:03:47.740520 [info ] [MainThread]: 
[0m14:03:47.740740 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m14:03:47.741452 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 62.95163, "process_in_blocks": "0", "process_kernel_time": 0.654794, "process_mem_max_rss": "276676608", "process_out_blocks": "0", "process_user_time": 61.024364}
[0m14:03:47.741804 [debug] [MainThread]: Command `dbt seed` succeeded at 14:03:47.741751 after 62.95 seconds
[0m14:03:47.743504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cde1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068458b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106845580>]}
[0m14:03:47.744070 [debug] [MainThread]: Flushing usage events
[0m14:03:48.249077 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:03:59.108508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108309640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109019880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090194f0>]}


============================== 14:03:59.112076 | d9489443-e05b-4cbb-b129-fbe1eb5a1e56 ==============================
[0m14:03:59.112076 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:03:59.112424 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/jordi.vidaldellobatera/.dbt', 'log_path': '/Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:03:59.231795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9489443-e05b-4cbb-b129-fbe1eb5a1e56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094f8fb0>]}
[0m14:03:59.256958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9489443-e05b-4cbb-b129-fbe1eb5a1e56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094f8680>]}
[0m14:03:59.257883 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:03:59.322916 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m14:03:59.421716 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:03:59.422006 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:03:59.443777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9489443-e05b-4cbb-b129-fbe1eb5a1e56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095a9220>]}
[0m14:03:59.480832 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m14:03:59.483270 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m14:03:59.504347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9489443-e05b-4cbb-b129-fbe1eb5a1e56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d288c0>]}
[0m14:03:59.504665 [info ] [MainThread]: Found 3 models, 6 seeds, 4 data tests, 431 macros
[0m14:03:59.504860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9489443-e05b-4cbb-b129-fbe1eb5a1e56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d08fe0>]}
[0m14:03:59.505826 [info ] [MainThread]: 
[0m14:03:59.506018 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:03:59.506169 [info ] [MainThread]: 
[0m14:03:59.506426 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:03:59.508338 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m14:03:59.631021 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m14:03:59.631285 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m14:03:59.631449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:03:59.668732 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.037 seconds
[0m14:03:59.669611 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m14:03:59.670600 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now list_jaffle_shop_public)
[0m14:03:59.674084 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m14:03:59.674308 [debug] [ThreadPool]: On list_jaffle_shop_public: BEGIN
[0m14:03:59.674492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:03:59.682901 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:03:59.683186 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m14:03:59.683392 [debug] [ThreadPool]: On list_jaffle_shop_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_public"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:03:59.686564 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m14:03:59.687528 [debug] [ThreadPool]: On list_jaffle_shop_public: ROLLBACK
[0m14:03:59.688274 [debug] [ThreadPool]: On list_jaffle_shop_public: Close
[0m14:03:59.691794 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:59.692055 [debug] [MainThread]: On master: BEGIN
[0m14:03:59.692238 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:03:59.703417 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m14:03:59.703678 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:59.703947 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:03:59.708019 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m14:03:59.708909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9489443-e05b-4cbb-b129-fbe1eb5a1e56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094fbcb0>]}
[0m14:03:59.709190 [debug] [MainThread]: On master: ROLLBACK
[0m14:03:59.709897 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:59.710078 [debug] [MainThread]: On master: BEGIN
[0m14:03:59.711121 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:03:59.711313 [debug] [MainThread]: On master: COMMIT
[0m14:03:59.711506 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:59.711700 [debug] [MainThread]: On master: COMMIT
[0m14:03:59.712275 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:03:59.712465 [debug] [MainThread]: On master: Close
[0m14:03:59.713286 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m14:03:59.713647 [info ] [Thread-1 (]: 1 of 3 START sql view model public.customers ................................... [RUN]
[0m14:03:59.713941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_public, now model.jaffle_shop.customers)
[0m14:03:59.714216 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m14:03:59.718206 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m14:03:59.719257 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m14:03:59.738845 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m14:03:59.739871 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m14:03:59.740071 [debug] [Thread-1 (]: On model.jaffle_shop.customers: BEGIN
[0m14:03:59.740240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:03:59.750303 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m14:03:59.750547 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m14:03:59.750747 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  create view "jaffle_shop"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from public_raw.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from public_raw.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m14:03:59.751666 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public_raw.customers" does not exist
LINE 14:     from public_raw.customers
                  ^

[0m14:03:59.751911 [debug] [Thread-1 (]: On model.jaffle_shop.customers: ROLLBACK
[0m14:03:59.752983 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m14:03:59.759299 [debug] [Thread-1 (]: Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "public_raw.customers" does not exist
  LINE 14:     from public_raw.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m14:03:59.760696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9489443-e05b-4cbb-b129-fbe1eb5a1e56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10832bd10>]}
[0m14:03:59.761059 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.customers .......................... [[31mERROR[0m in 0.05s]
[0m14:03:59.761373 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m14:03:59.761584 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m14:03:59.761831 [debug] [Thread-4 (]: Marking all children of 'model.jaffle_shop.customers' to be skipped because of status 'error'.  Reason: Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "public_raw.customers" does not exist
  LINE 14:     from public_raw.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql.
[0m14:03:59.762063 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m14:03:59.762634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.customers, now model.jaffle_shop.my_first_dbt_model)
[0m14:03:59.762813 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m14:03:59.764286 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m14:03:59.765102 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m14:03:59.777714 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m14:03:59.778532 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m14:03:59.778751 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: BEGIN
[0m14:03:59.778929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:03:59.788145 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m14:03:59.788457 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m14:03:59.788724 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

  create  table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:03:59.790184 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m14:03:59.793768 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m14:03:59.794009 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:03:59.794901 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:03:59.796476 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m14:03:59.796775 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:03:59.797405 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:03:59.807635 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m14:03:59.807872 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m14:03:59.808060 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m14:03:59.809207 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:03:59.812569 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_first_dbt_model__dbt_backup"
[0m14:03:59.815076 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m14:03:59.815292 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
drop table if exists "jaffle_shop"."public"."my_first_dbt_model__dbt_backup" cascade
[0m14:03:59.817474 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:03:59.818773 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m14:03:59.819168 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9489443-e05b-4cbb-b129-fbe1eb5a1e56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106115b50>]}
[0m14:03:59.819562 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.06s]
[0m14:03:59.819868 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m14:03:59.820270 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m14:03:59.820543 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m14:03:59.820835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.my_second_dbt_model)
[0m14:03:59.821045 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m14:03:59.822563 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m14:03:59.823452 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m14:03:59.825229 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m14:03:59.825719 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m14:03:59.825999 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: BEGIN
[0m14:03:59.826276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:03:59.834874 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m14:03:59.835300 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m14:03:59.835599 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */

  create view "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "jaffle_shop"."public"."my_first_dbt_model"
where id = 1
  );
[0m14:03:59.837435 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m14:03:59.839176 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m14:03:59.839398 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
alter table "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:03:59.840047 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:03:59.840807 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m14:03:59.841001 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m14:03:59.841172 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m14:03:59.841890 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:03:59.843023 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_second_dbt_model__dbt_backup"
[0m14:03:59.844744 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m14:03:59.844971 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "jaffle_shop"."public"."my_second_dbt_model__dbt_backup" cascade
[0m14:03:59.845687 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:03:59.846377 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m14:03:59.846679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9489443-e05b-4cbb-b129-fbe1eb5a1e56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a215100>]}
[0m14:03:59.846994 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.03s]
[0m14:03:59.847279 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m14:03:59.847839 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:59.848040 [debug] [MainThread]: On master: BEGIN
[0m14:03:59.848245 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:03:59.856385 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:03:59.856684 [debug] [MainThread]: On master: COMMIT
[0m14:03:59.856872 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:59.857190 [debug] [MainThread]: On master: COMMIT
[0m14:03:59.858563 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:03:59.858881 [debug] [MainThread]: On master: Close
[0m14:03:59.859171 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:03:59.859331 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m14:03:59.859577 [info ] [MainThread]: 
[0m14:03:59.860015 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m14:03:59.860627 [debug] [MainThread]: Command end result
[0m14:03:59.872933 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m14:03:59.874347 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m14:03:59.877760 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/run_results.json
[0m14:03:59.877993 [info ] [MainThread]: 
[0m14:03:59.878203 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:03:59.878374 [info ] [MainThread]: 
[0m14:03:59.878570 [error] [MainThread]:   Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "public_raw.customers" does not exist
  LINE 14:     from public_raw.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m14:03:59.878726 [info ] [MainThread]: 
[0m14:03:59.878894 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m14:03:59.879469 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8281435, "process_in_blocks": "0", "process_kernel_time": 0.247989, "process_mem_max_rss": "118308864", "process_out_blocks": "0", "process_user_time": 1.011478}
[0m14:03:59.879777 [debug] [MainThread]: Command `dbt run` failed at 14:03:59.879714 after 0.83 seconds
[0m14:03:59.880031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108309640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c93da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10851d940>]}
[0m14:03:59.880247 [debug] [MainThread]: Flushing usage events
[0m14:03:59.953534 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:04:17.724715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11160b0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11269d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11269d9a0>]}


============================== 14:04:17.728606 | c225490b-0388-43a8-9544-b56fa58aca9c ==============================
[0m14:04:17.728606 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:04:17.728962 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jordi.vidaldellobatera/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:17.856336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c225490b-0388-43a8-9544-b56fa58aca9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126c1640>]}
[0m14:04:17.881490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c225490b-0388-43a8-9544-b56fa58aca9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111626720>]}
[0m14:04:17.882471 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:04:17.948232 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m14:04:18.054419 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:04:18.054885 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://jaffle_shop/models/customers.sql
[0m14:04:18.170703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c225490b-0388-43a8-9544-b56fa58aca9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137a9370>]}
[0m14:04:18.212968 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m14:04:18.215263 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m14:04:18.233992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c225490b-0388-43a8-9544-b56fa58aca9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a0ee40>]}
[0m14:04:18.234303 [info ] [MainThread]: Found 3 models, 6 seeds, 4 data tests, 431 macros
[0m14:04:18.234497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c225490b-0388-43a8-9544-b56fa58aca9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137ab410>]}
[0m14:04:18.235445 [info ] [MainThread]: 
[0m14:04:18.235648 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:04:18.235808 [info ] [MainThread]: 
[0m14:04:18.236062 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:04:18.237903 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m14:04:18.318037 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m14:04:18.318303 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m14:04:18.318479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:18.351515 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.033 seconds
[0m14:04:18.352438 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m14:04:18.353406 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now list_jaffle_shop_public)
[0m14:04:18.357013 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m14:04:18.357246 [debug] [ThreadPool]: On list_jaffle_shop_public: BEGIN
[0m14:04:18.357418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:18.366239 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:04:18.366547 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m14:04:18.366754 [debug] [ThreadPool]: On list_jaffle_shop_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_public"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:04:18.370365 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m14:04:18.371288 [debug] [ThreadPool]: On list_jaffle_shop_public: ROLLBACK
[0m14:04:18.372012 [debug] [ThreadPool]: On list_jaffle_shop_public: Close
[0m14:04:18.375628 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:18.375883 [debug] [MainThread]: On master: BEGIN
[0m14:04:18.376054 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:18.384568 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:04:18.384820 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:18.385120 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:04:18.389525 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m14:04:18.390439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c225490b-0388-43a8-9544-b56fa58aca9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11373f290>]}
[0m14:04:18.390712 [debug] [MainThread]: On master: ROLLBACK
[0m14:04:18.391327 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:18.391507 [debug] [MainThread]: On master: BEGIN
[0m14:04:18.392496 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:04:18.392735 [debug] [MainThread]: On master: COMMIT
[0m14:04:18.392952 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:18.393140 [debug] [MainThread]: On master: COMMIT
[0m14:04:18.393841 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:04:18.394027 [debug] [MainThread]: On master: Close
[0m14:04:18.394790 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m14:04:18.395111 [info ] [Thread-1 (]: 1 of 3 START sql view model public.customers ................................... [RUN]
[0m14:04:18.395401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_public, now model.jaffle_shop.customers)
[0m14:04:18.395611 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m14:04:18.399746 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m14:04:18.400623 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m14:04:18.420428 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m14:04:18.421408 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m14:04:18.421610 [debug] [Thread-1 (]: On model.jaffle_shop.customers: BEGIN
[0m14:04:18.421786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:18.428796 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:04:18.429066 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m14:04:18.429278 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  create view "jaffle_shop"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from public.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from public.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m14:04:18.430094 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.customers" does not exist
LINE 14:     from public.customers
                  ^

[0m14:04:18.430543 [debug] [Thread-1 (]: On model.jaffle_shop.customers: ROLLBACK
[0m14:04:18.431596 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m14:04:18.437759 [debug] [Thread-1 (]: Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "public.customers" does not exist
  LINE 14:     from public.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m14:04:18.438979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c225490b-0388-43a8-9544-b56fa58aca9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a0a2a0>]}
[0m14:04:18.439314 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.customers .......................... [[31mERROR[0m in 0.04s]
[0m14:04:18.439613 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m14:04:18.439818 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m14:04:18.440061 [debug] [Thread-4 (]: Marking all children of 'model.jaffle_shop.customers' to be skipped because of status 'error'.  Reason: Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "public.customers" does not exist
  LINE 14:     from public.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql.
[0m14:04:18.440305 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m14:04:18.440854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.customers, now model.jaffle_shop.my_first_dbt_model)
[0m14:04:18.441074 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m14:04:18.442502 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m14:04:18.443034 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m14:04:18.453712 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m14:04:18.454452 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m14:04:18.454644 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: BEGIN
[0m14:04:18.454807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:18.466878 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m14:04:18.467182 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m14:04:18.467399 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

  create  table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:04:18.469535 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m14:04:18.473217 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m14:04:18.473469 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:04:18.474430 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:04:18.475873 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m14:04:18.476122 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:04:18.476749 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:04:18.486410 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m14:04:18.486635 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m14:04:18.486817 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m14:04:18.488928 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:04:18.492888 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_first_dbt_model__dbt_backup"
[0m14:04:18.495248 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m14:04:18.495453 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
drop table if exists "jaffle_shop"."public"."my_first_dbt_model__dbt_backup" cascade
[0m14:04:18.498983 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:04:18.500357 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m14:04:18.500728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c225490b-0388-43a8-9544-b56fa58aca9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115801490>]}
[0m14:04:18.501086 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.06s]
[0m14:04:18.501403 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m14:04:18.501802 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m14:04:18.502099 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m14:04:18.502496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.my_second_dbt_model)
[0m14:04:18.502733 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m14:04:18.504403 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m14:04:18.505284 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m14:04:18.507179 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m14:04:18.507847 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m14:04:18.508052 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: BEGIN
[0m14:04:18.508232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:18.516184 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m14:04:18.516532 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m14:04:18.516777 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */

  create view "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "jaffle_shop"."public"."my_first_dbt_model"
where id = 1
  );
[0m14:04:18.518155 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m14:04:18.519991 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m14:04:18.520205 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
alter table "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:04:18.521054 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:04:18.521899 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m14:04:18.522105 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m14:04:18.522291 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m14:04:18.523350 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:04:18.524783 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_second_dbt_model__dbt_backup"
[0m14:04:18.526388 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m14:04:18.526594 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "jaffle_shop"."public"."my_second_dbt_model__dbt_backup" cascade
[0m14:04:18.527822 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:04:18.528551 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m14:04:18.528870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c225490b-0388-43a8-9544-b56fa58aca9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fc47d0>]}
[0m14:04:18.529205 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.03s]
[0m14:04:18.529503 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m14:04:18.530033 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:18.530194 [debug] [MainThread]: On master: BEGIN
[0m14:04:18.530339 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:04:18.538711 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:04:18.539029 [debug] [MainThread]: On master: COMMIT
[0m14:04:18.539302 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:18.539488 [debug] [MainThread]: On master: COMMIT
[0m14:04:18.540105 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:04:18.540283 [debug] [MainThread]: On master: Close
[0m14:04:18.540621 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:18.540950 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m14:04:18.541192 [info ] [MainThread]: 
[0m14:04:18.541399 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m14:04:18.542027 [debug] [MainThread]: Command end result
[0m14:04:18.554463 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m14:04:18.555951 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m14:04:18.559242 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/run_results.json
[0m14:04:18.559449 [info ] [MainThread]: 
[0m14:04:18.559651 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:04:18.559822 [info ] [MainThread]: 
[0m14:04:18.560019 [error] [MainThread]:   Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "public.customers" does not exist
  LINE 14:     from public.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m14:04:18.560177 [info ] [MainThread]: 
[0m14:04:18.560342 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m14:04:18.560665 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.89813006, "process_in_blocks": "0", "process_kernel_time": 0.253646, "process_mem_max_rss": "121602048", "process_out_blocks": "0", "process_user_time": 1.099445}
[0m14:04:18.560886 [debug] [MainThread]: Command `dbt run` failed at 14:04:18.560847 after 0.90 seconds
[0m14:04:18.561100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11269d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a19be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11262fad0>]}
[0m14:04:18.561281 [debug] [MainThread]: Flushing usage events
[0m14:04:18.635153 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:05:11.096920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072a9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107795820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107795430>]}


============================== 14:05:11.103515 | 38bbb925-1b11-4088-8bc7-dfcff7359aa6 ==============================
[0m14:05:11.103515 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:05:11.103881 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jordi.vidaldellobatera/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:11.241785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38bbb925-1b11-4088-8bc7-dfcff7359aa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c00830>]}
[0m14:05:11.267672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38bbb925-1b11-4088-8bc7-dfcff7359aa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107781e20>]}
[0m14:05:11.268742 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:05:11.339593 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m14:05:11.448815 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:05:11.449211 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://jaffle_shop/models/customers.sql
[0m14:05:11.561551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38bbb925-1b11-4088-8bc7-dfcff7359aa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118601190>]}
[0m14:05:11.596875 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m14:05:11.599047 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m14:05:11.621993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38bbb925-1b11-4088-8bc7-dfcff7359aa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118616cc0>]}
[0m14:05:11.622294 [info ] [MainThread]: Found 3 models, 6 seeds, 4 data tests, 431 macros
[0m14:05:11.622483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38bbb925-1b11-4088-8bc7-dfcff7359aa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1185ff590>]}
[0m14:05:11.623378 [info ] [MainThread]: 
[0m14:05:11.623562 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:05:11.623712 [info ] [MainThread]: 
[0m14:05:11.623960 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:05:11.625803 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m14:05:11.733764 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m14:05:11.734030 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m14:05:11.734199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:11.775850 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.042 seconds
[0m14:05:11.776810 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m14:05:11.777868 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now list_jaffle_shop_public)
[0m14:05:11.781791 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m14:05:11.782025 [debug] [ThreadPool]: On list_jaffle_shop_public: BEGIN
[0m14:05:11.782201 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:11.794039 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m14:05:11.794366 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m14:05:11.794600 [debug] [ThreadPool]: On list_jaffle_shop_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_public"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:05:11.798074 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m14:05:11.799024 [debug] [ThreadPool]: On list_jaffle_shop_public: ROLLBACK
[0m14:05:11.799685 [debug] [ThreadPool]: On list_jaffle_shop_public: Close
[0m14:05:11.803193 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:11.803437 [debug] [MainThread]: On master: BEGIN
[0m14:05:11.803616 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:11.812881 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:05:11.813190 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:11.813524 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:05:11.817387 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m14:05:11.818411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38bbb925-1b11-4088-8bc7-dfcff7359aa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1184bbbc0>]}
[0m14:05:11.818702 [debug] [MainThread]: On master: ROLLBACK
[0m14:05:11.819428 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:11.819611 [debug] [MainThread]: On master: BEGIN
[0m14:05:11.820659 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:05:11.820909 [debug] [MainThread]: On master: COMMIT
[0m14:05:11.821109 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:11.821281 [debug] [MainThread]: On master: COMMIT
[0m14:05:11.821925 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:05:11.822196 [debug] [MainThread]: On master: Close
[0m14:05:11.823047 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m14:05:11.823383 [info ] [Thread-1 (]: 1 of 3 START sql view model public.customers ................................... [RUN]
[0m14:05:11.823665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_public, now model.jaffle_shop.customers)
[0m14:05:11.823872 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m14:05:11.827783 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m14:05:11.828722 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m14:05:11.847674 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m14:05:11.848719 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m14:05:11.848985 [debug] [Thread-1 (]: On model.jaffle_shop.customers: BEGIN
[0m14:05:11.849173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:11.856883 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m14:05:11.857196 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m14:05:11.857417 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  create view "jaffle_shop"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m14:05:11.858304 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "customers" does not exist
LINE 14:     from customers
                  ^
DETAIL:  There is a WITH item named "customers", but it cannot be referenced from this part of the query.
HINT:  Use WITH RECURSIVE, or re-order the WITH items to remove forward references.

[0m14:05:11.858559 [debug] [Thread-1 (]: On model.jaffle_shop.customers: ROLLBACK
[0m14:05:11.859659 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m14:05:11.865418 [debug] [Thread-1 (]: Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "customers" does not exist
  LINE 14:     from customers
                    ^
  DETAIL:  There is a WITH item named "customers", but it cannot be referenced from this part of the query.
  HINT:  Use WITH RECURSIVE, or re-order the WITH items to remove forward references.
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m14:05:11.866762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38bbb925-1b11-4088-8bc7-dfcff7359aa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1184fb5c0>]}
[0m14:05:11.867135 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.customers .......................... [[31mERROR[0m in 0.04s]
[0m14:05:11.867436 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m14:05:11.867640 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m14:05:11.867913 [debug] [Thread-4 (]: Marking all children of 'model.jaffle_shop.customers' to be skipped because of status 'error'.  Reason: Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "customers" does not exist
  LINE 14:     from customers
                    ^
  DETAIL:  There is a WITH item named "customers", but it cannot be referenced from this part of the query.
  HINT:  Use WITH RECURSIVE, or re-order the WITH items to remove forward references.
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql.
[0m14:05:11.868162 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m14:05:11.868739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.customers, now model.jaffle_shop.my_first_dbt_model)
[0m14:05:11.868921 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m14:05:11.870357 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m14:05:11.870983 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m14:05:11.882025 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m14:05:11.883357 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m14:05:11.883649 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: BEGIN
[0m14:05:11.883837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:11.893694 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m14:05:11.894004 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m14:05:11.894212 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

  create  table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:05:11.896294 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m14:05:11.899900 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m14:05:11.900165 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:05:11.901015 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:05:11.902525 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m14:05:11.902803 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:05:11.903431 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:05:11.913105 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m14:05:11.913335 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m14:05:11.913516 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m14:05:11.915678 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:05:11.919732 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_first_dbt_model__dbt_backup"
[0m14:05:11.922137 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m14:05:11.922340 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
drop table if exists "jaffle_shop"."public"."my_first_dbt_model__dbt_backup" cascade
[0m14:05:11.926530 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m14:05:11.927827 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m14:05:11.928189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38bbb925-1b11-4088-8bc7-dfcff7359aa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10536dd90>]}
[0m14:05:11.928539 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.06s]
[0m14:05:11.928916 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m14:05:11.929312 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m14:05:11.929595 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m14:05:11.929868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.my_second_dbt_model)
[0m14:05:11.930082 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m14:05:11.931564 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m14:05:11.959348 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m14:05:11.962355 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m14:05:11.964751 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m14:05:11.965050 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: BEGIN
[0m14:05:11.965270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:11.975004 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m14:05:11.975477 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m14:05:11.975731 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */

  create view "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "jaffle_shop"."public"."my_first_dbt_model"
where id = 1
  );
[0m14:05:11.978141 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m14:05:11.982199 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m14:05:11.982567 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
alter table "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:05:11.984221 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:05:11.985354 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m14:05:11.985620 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m14:05:11.985834 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m14:05:11.987492 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:05:11.989064 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_second_dbt_model__dbt_backup"
[0m14:05:11.990874 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m14:05:11.991107 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "jaffle_shop"."public"."my_second_dbt_model__dbt_backup" cascade
[0m14:05:11.992109 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:05:11.993031 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m14:05:11.993406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38bbb925-1b11-4088-8bc7-dfcff7359aa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1195621b0>]}
[0m14:05:11.993785 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.06s]
[0m14:05:11.994119 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m14:05:11.994790 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:11.995010 [debug] [MainThread]: On master: BEGIN
[0m14:05:11.995256 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:12.005328 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m14:05:12.006124 [debug] [MainThread]: On master: COMMIT
[0m14:05:12.006362 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:12.006553 [debug] [MainThread]: On master: COMMIT
[0m14:05:12.008136 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:05:12.008405 [debug] [MainThread]: On master: Close
[0m14:05:12.008878 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:12.009157 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m14:05:12.009440 [info ] [MainThread]: 
[0m14:05:12.009890 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m14:05:12.010659 [debug] [MainThread]: Command end result
[0m14:05:12.031636 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m14:05:12.033120 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m14:05:12.036549 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/run_results.json
[0m14:05:12.036757 [info ] [MainThread]: 
[0m14:05:12.036962 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:05:12.037142 [info ] [MainThread]: 
[0m14:05:12.037340 [error] [MainThread]:   Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "customers" does not exist
  LINE 14:     from customers
                    ^
  DETAIL:  There is a WITH item named "customers", but it cannot be referenced from this part of the query.
  HINT:  Use WITH RECURSIVE, or re-order the WITH items to remove forward references.
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m14:05:12.037503 [info ] [MainThread]: 
[0m14:05:12.037666 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m14:05:12.038001 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0074182, "process_in_blocks": "0", "process_kernel_time": 0.277285, "process_mem_max_rss": "121290752", "process_out_blocks": "0", "process_user_time": 1.127433}
[0m14:05:12.038224 [debug] [MainThread]: Command `dbt run` failed at 14:05:12.038185 after 1.01 seconds
[0m14:05:12.038436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10763f920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10536dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe0680>]}
[0m14:05:12.038627 [debug] [MainThread]: Flushing usage events
[0m14:05:12.188890 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:07:10.637210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040499a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104949730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104949370>]}


============================== 14:07:10.640899 | e3d9ded6-184c-4d81-b5db-2f1e18396164 ==============================
[0m14:07:10.640899 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:07:10.641256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jordi.vidaldellobatera/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:07:10.761234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3d9ded6-184c-4d81-b5db-2f1e18396164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aa4320>]}
[0m14:07:10.786366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3d9ded6-184c-4d81-b5db-2f1e18396164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c5a450>]}
[0m14:07:10.787353 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:07:10.852864 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m14:07:10.957297 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:07:10.957746 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://jaffle_shop/models/customers.sql
[0m14:07:11.072088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3d9ded6-184c-4d81-b5db-2f1e18396164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056a7860>]}
[0m14:07:11.107993 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m14:07:11.110400 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m14:07:11.132149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3d9ded6-184c-4d81-b5db-2f1e18396164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057bae40>]}
[0m14:07:11.132446 [info ] [MainThread]: Found 3 models, 6 seeds, 4 data tests, 431 macros
[0m14:07:11.132644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3d9ded6-184c-4d81-b5db-2f1e18396164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056a4bf0>]}
[0m14:07:11.133636 [info ] [MainThread]: 
[0m14:07:11.133860 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:07:11.134026 [info ] [MainThread]: 
[0m14:07:11.134290 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:07:11.136104 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m14:07:11.260891 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m14:07:11.261139 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m14:07:11.261306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:11.327174 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.066 seconds
[0m14:07:11.328243 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m14:07:11.329600 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now list_jaffle_shop_public)
[0m14:07:11.334244 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m14:07:11.334548 [debug] [ThreadPool]: On list_jaffle_shop_public: BEGIN
[0m14:07:11.334731 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:11.349366 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m14:07:11.349760 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m14:07:11.350003 [debug] [ThreadPool]: On list_jaffle_shop_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_public"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:07:11.354637 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m14:07:11.355778 [debug] [ThreadPool]: On list_jaffle_shop_public: ROLLBACK
[0m14:07:11.357109 [debug] [ThreadPool]: On list_jaffle_shop_public: Close
[0m14:07:11.361060 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:11.361350 [debug] [MainThread]: On master: BEGIN
[0m14:07:11.361534 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:07:11.383689 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m14:07:11.384015 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:11.384375 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:07:11.392630 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m14:07:11.393705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3d9ded6-184c-4d81-b5db-2f1e18396164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056a5880>]}
[0m14:07:11.394031 [debug] [MainThread]: On master: ROLLBACK
[0m14:07:11.397103 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:11.397313 [debug] [MainThread]: On master: BEGIN
[0m14:07:11.401735 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:07:11.402210 [debug] [MainThread]: On master: COMMIT
[0m14:07:11.402434 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:11.402628 [debug] [MainThread]: On master: COMMIT
[0m14:07:11.404759 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m14:07:11.404962 [debug] [MainThread]: On master: Close
[0m14:07:11.405833 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m14:07:11.406153 [info ] [Thread-1 (]: 1 of 3 START sql view model public.customers ................................... [RUN]
[0m14:07:11.406424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_public, now model.jaffle_shop.customers)
[0m14:07:11.406724 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m14:07:11.411130 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m14:07:11.412070 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m14:07:11.433082 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m14:07:11.434191 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m14:07:11.434420 [debug] [Thread-1 (]: On model.jaffle_shop.customers: BEGIN
[0m14:07:11.434607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:11.443345 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m14:07:11.443710 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m14:07:11.443958 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  create view "jaffle_shop"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m14:07:11.444963 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "jaffle_shop.customers" does not exist
LINE 14:     from jaffle_shop.customers
                  ^

[0m14:07:11.445177 [debug] [Thread-1 (]: On model.jaffle_shop.customers: ROLLBACK
[0m14:07:11.446080 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m14:07:11.452696 [debug] [Thread-1 (]: Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "jaffle_shop.customers" does not exist
  LINE 14:     from jaffle_shop.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m14:07:11.454205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3d9ded6-184c-4d81-b5db-2f1e18396164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057ab290>]}
[0m14:07:11.454622 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.customers .......................... [[31mERROR[0m in 0.05s]
[0m14:07:11.454955 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m14:07:11.455175 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m14:07:11.455455 [debug] [Thread-4 (]: Marking all children of 'model.jaffle_shop.customers' to be skipped because of status 'error'.  Reason: Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "jaffle_shop.customers" does not exist
  LINE 14:     from jaffle_shop.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql.
[0m14:07:11.455725 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m14:07:11.456368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.customers, now model.jaffle_shop.my_first_dbt_model)
[0m14:07:11.456558 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m14:07:11.458161 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m14:07:11.458924 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m14:07:11.471929 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m14:07:11.473094 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m14:07:11.473295 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: BEGIN
[0m14:07:11.473468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:11.483248 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m14:07:11.483544 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m14:07:11.483749 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

  create  table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:07:11.486189 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m14:07:11.489748 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m14:07:11.490010 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:07:11.491086 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:07:11.492705 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m14:07:11.492979 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:07:11.493901 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:07:11.504687 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m14:07:11.505037 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m14:07:11.505281 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m14:07:11.507420 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:07:11.512138 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_first_dbt_model__dbt_backup"
[0m14:07:11.515063 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m14:07:11.515348 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
drop table if exists "jaffle_shop"."public"."my_first_dbt_model__dbt_backup" cascade
[0m14:07:11.519108 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m14:07:11.520521 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m14:07:11.520939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3d9ded6-184c-4d81-b5db-2f1e18396164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101aa9d30>]}
[0m14:07:11.521304 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.06s]
[0m14:07:11.521677 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m14:07:11.522130 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m14:07:11.522406 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m14:07:11.522691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.my_second_dbt_model)
[0m14:07:11.523079 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m14:07:11.524670 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m14:07:11.525529 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m14:07:11.527709 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m14:07:11.528479 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m14:07:11.528688 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: BEGIN
[0m14:07:11.528869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:11.538832 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m14:07:11.539158 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m14:07:11.539365 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */

  create view "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "jaffle_shop"."public"."my_first_dbt_model"
where id = 1
  );
[0m14:07:11.540696 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m14:07:11.542307 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m14:07:11.542542 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
alter table "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:07:11.543453 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:07:11.544280 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m14:07:11.544479 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m14:07:11.544652 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m14:07:11.545426 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:07:11.546595 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_second_dbt_model__dbt_backup"
[0m14:07:11.548205 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m14:07:11.548410 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "jaffle_shop"."public"."my_second_dbt_model__dbt_backup" cascade
[0m14:07:11.549091 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:07:11.549869 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m14:07:11.550203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3d9ded6-184c-4d81-b5db-2f1e18396164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10573ea20>]}
[0m14:07:11.550540 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.03s]
[0m14:07:11.550833 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m14:07:11.551434 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:11.551654 [debug] [MainThread]: On master: BEGIN
[0m14:07:11.551808 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:07:11.560873 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:07:11.561387 [debug] [MainThread]: On master: COMMIT
[0m14:07:11.561585 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:11.561745 [debug] [MainThread]: On master: COMMIT
[0m14:07:11.562525 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:07:11.562737 [debug] [MainThread]: On master: Close
[0m14:07:11.563034 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:11.563205 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m14:07:11.563431 [info ] [MainThread]: 
[0m14:07:11.563633 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m14:07:11.564117 [debug] [MainThread]: Command end result
[0m14:07:11.576827 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m14:07:11.578553 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m14:07:11.581922 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/run_results.json
[0m14:07:11.582170 [info ] [MainThread]: 
[0m14:07:11.582390 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:07:11.582616 [info ] [MainThread]: 
[0m14:07:11.582890 [error] [MainThread]:   Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "jaffle_shop.customers" does not exist
  LINE 14:     from jaffle_shop.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m14:07:11.583179 [info ] [MainThread]: 
[0m14:07:11.583414 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m14:07:11.583830 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0074637, "process_in_blocks": "0", "process_kernel_time": 0.270154, "process_mem_max_rss": "119308288", "process_out_blocks": "0", "process_user_time": 1.10638}
[0m14:07:11.584086 [debug] [MainThread]: Command `dbt run` failed at 14:07:11.584038 after 1.01 seconds
[0m14:07:11.584359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104949850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104949880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e75b20>]}
[0m14:07:11.584572 [debug] [MainThread]: Flushing usage events
[0m14:07:12.126567 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:07:46.909569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049b7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10509d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10509d490>]}


============================== 14:07:46.913435 | 8d8e7d05-cc24-4045-a3b6-65154b068409 ==============================
[0m14:07:46.913435 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:07:46.913818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jordi.vidaldellobatera/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:07:47.032168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d8e7d05-cc24-4045-a3b6-65154b068409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10517be00>]}
[0m14:07:47.056485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d8e7d05-cc24-4045-a3b6-65154b068409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048f0980>]}
[0m14:07:47.057456 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:07:47.124154 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m14:07:47.232648 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:07:47.233030 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://jaffle_shop/models/customers.sql
[0m14:07:47.345653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d8e7d05-cc24-4045-a3b6-65154b068409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f9250>]}
[0m14:07:47.380978 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m14:07:47.383452 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m14:07:47.405888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d8e7d05-cc24-4045-a3b6-65154b068409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10640ed80>]}
[0m14:07:47.406194 [info ] [MainThread]: Found 3 models, 6 seeds, 4 data tests, 431 macros
[0m14:07:47.406388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d8e7d05-cc24-4045-a3b6-65154b068409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f9670>]}
[0m14:07:47.407311 [info ] [MainThread]: 
[0m14:07:47.407532 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:07:47.407695 [info ] [MainThread]: 
[0m14:07:47.407949 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:07:47.409762 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m14:07:47.517703 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m14:07:47.517956 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m14:07:47.518120 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:47.553686 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.035 seconds
[0m14:07:47.554607 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m14:07:47.555644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now list_jaffle_shop_public)
[0m14:07:47.559209 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m14:07:47.559438 [debug] [ThreadPool]: On list_jaffle_shop_public: BEGIN
[0m14:07:47.559605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:47.568666 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:07:47.568933 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m14:07:47.569128 [debug] [ThreadPool]: On list_jaffle_shop_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_public"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:07:47.574679 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.005 seconds
[0m14:07:47.575632 [debug] [ThreadPool]: On list_jaffle_shop_public: ROLLBACK
[0m14:07:47.576319 [debug] [ThreadPool]: On list_jaffle_shop_public: Close
[0m14:07:47.579909 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:47.580177 [debug] [MainThread]: On master: BEGIN
[0m14:07:47.580367 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:07:47.588606 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:07:47.588838 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:47.589082 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:07:47.592901 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m14:07:47.593879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d8e7d05-cc24-4045-a3b6-65154b068409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642f020>]}
[0m14:07:47.594181 [debug] [MainThread]: On master: ROLLBACK
[0m14:07:47.594901 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:47.595100 [debug] [MainThread]: On master: BEGIN
[0m14:07:47.596149 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:07:47.596366 [debug] [MainThread]: On master: COMMIT
[0m14:07:47.596576 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:47.596751 [debug] [MainThread]: On master: COMMIT
[0m14:07:47.597379 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:07:47.597572 [debug] [MainThread]: On master: Close
[0m14:07:47.598384 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m14:07:47.598715 [info ] [Thread-1 (]: 1 of 3 START sql view model public.customers ................................... [RUN]
[0m14:07:47.598998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_public, now model.jaffle_shop.customers)
[0m14:07:47.599218 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m14:07:47.603087 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m14:07:47.604153 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m14:07:47.623121 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m14:07:47.624018 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m14:07:47.624208 [debug] [Thread-1 (]: On model.jaffle_shop.customers: BEGIN
[0m14:07:47.624374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:47.634097 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m14:07:47.634403 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m14:07:47.634626 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  create view "jaffle_shop"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from public.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from public.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m14:07:47.635719 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "public.jaffle_shop.customers"
LINE 14:     from public.jaffle_shop.customers
                  ^

[0m14:07:47.636017 [debug] [Thread-1 (]: On model.jaffle_shop.customers: ROLLBACK
[0m14:07:47.637906 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m14:07:47.644481 [debug] [Thread-1 (]: Database Error in model customers (jaffle_shop/models/customers.sql)
  cross-database references are not implemented: "public.jaffle_shop.customers"
  LINE 14:     from public.jaffle_shop.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m14:07:47.645815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d8e7d05-cc24-4045-a3b6-65154b068409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642f2f0>]}
[0m14:07:47.646194 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.customers .......................... [[31mERROR[0m in 0.05s]
[0m14:07:47.646512 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m14:07:47.646737 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m14:07:47.646996 [debug] [Thread-4 (]: Marking all children of 'model.jaffle_shop.customers' to be skipped because of status 'error'.  Reason: Database Error in model customers (jaffle_shop/models/customers.sql)
  cross-database references are not implemented: "public.jaffle_shop.customers"
  LINE 14:     from public.jaffle_shop.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql.
[0m14:07:47.647243 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m14:07:47.647822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.customers, now model.jaffle_shop.my_first_dbt_model)
[0m14:07:47.648024 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m14:07:47.649515 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m14:07:47.650157 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m14:07:47.662023 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m14:07:47.662852 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m14:07:47.663100 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: BEGIN
[0m14:07:47.663308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:47.670808 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:07:47.671118 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m14:07:47.671325 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

  create  table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:07:47.673452 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m14:07:47.676890 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m14:07:47.677108 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:07:47.678001 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:07:47.679449 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m14:07:47.679698 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:07:47.680445 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:07:47.690013 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m14:07:47.690248 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m14:07:47.690437 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m14:07:47.692574 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:07:47.696655 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_first_dbt_model__dbt_backup"
[0m14:07:47.699080 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m14:07:47.699290 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
drop table if exists "jaffle_shop"."public"."my_first_dbt_model__dbt_backup" cascade
[0m14:07:47.703915 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m14:07:47.705243 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m14:07:47.705590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d8e7d05-cc24-4045-a3b6-65154b068409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ef4a0>]}
[0m14:07:47.705954 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.06s]
[0m14:07:47.706269 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m14:07:47.706661 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m14:07:47.706943 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m14:07:47.707204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.my_second_dbt_model)
[0m14:07:47.707404 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m14:07:47.708927 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m14:07:47.709712 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m14:07:47.711632 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m14:07:47.712177 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m14:07:47.712487 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: BEGIN
[0m14:07:47.712735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:47.722870 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m14:07:47.723192 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m14:07:47.723399 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */

  create view "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "jaffle_shop"."public"."my_first_dbt_model"
where id = 1
  );
[0m14:07:47.725039 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m14:07:47.726871 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m14:07:47.727107 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
alter table "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:07:47.727907 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:07:47.728718 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m14:07:47.728923 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m14:07:47.729105 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m14:07:47.730114 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:07:47.731537 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_second_dbt_model__dbt_backup"
[0m14:07:47.733306 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m14:07:47.733533 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "jaffle_shop"."public"."my_second_dbt_model__dbt_backup" cascade
[0m14:07:47.734315 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:07:47.735050 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m14:07:47.735374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d8e7d05-cc24-4045-a3b6-65154b068409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10785ec00>]}
[0m14:07:47.735703 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.03s]
[0m14:07:47.736008 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m14:07:47.736613 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:47.736826 [debug] [MainThread]: On master: BEGIN
[0m14:07:47.736992 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:07:47.745153 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:07:47.745455 [debug] [MainThread]: On master: COMMIT
[0m14:07:47.745715 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:47.745893 [debug] [MainThread]: On master: COMMIT
[0m14:07:47.746662 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:07:47.746914 [debug] [MainThread]: On master: Close
[0m14:07:47.747222 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:47.747493 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m14:07:47.747744 [info ] [MainThread]: 
[0m14:07:47.747961 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m14:07:47.748455 [debug] [MainThread]: Command end result
[0m14:07:47.760782 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m14:07:47.762074 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m14:07:47.765352 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/run_results.json
[0m14:07:47.765553 [info ] [MainThread]: 
[0m14:07:47.765757 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:07:47.765921 [info ] [MainThread]: 
[0m14:07:47.766119 [error] [MainThread]:   Database Error in model customers (jaffle_shop/models/customers.sql)
  cross-database references are not implemented: "public.jaffle_shop.customers"
  LINE 14:     from public.jaffle_shop.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m14:07:47.766299 [info ] [MainThread]: 
[0m14:07:47.766462 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m14:07:47.766782 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9232121, "process_in_blocks": "0", "process_kernel_time": 0.262597, "process_mem_max_rss": "120815616", "process_out_blocks": "0", "process_user_time": 1.075525}
[0m14:07:47.767008 [debug] [MainThread]: Command `dbt run` failed at 14:07:47.766968 after 0.92 seconds
[0m14:07:47.767208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101cbfa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062d5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d0d3a0>]}
[0m14:07:47.767393 [debug] [MainThread]: Flushing usage events
[0m14:07:48.154343 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:08:08.820055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083c88c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b71340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b70fb0>]}


============================== 14:08:08.823958 | dd6a4c1d-1d48-4fdc-aac1-daac6e0927fe ==============================
[0m14:08:08.823958 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:08:08.824317 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/jordi.vidaldellobatera/.dbt', 'log_path': '/Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:08:08.855257 [info ] [MainThread]: dbt version: 1.9.2
[0m14:08:08.855617 [info ] [MainThread]: python version: 3.12.8
[0m14:08:08.855793 [info ] [MainThread]: python path: /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/.venv/bin/python3
[0m14:08:08.855952 [info ] [MainThread]: os info: macOS-15.2-arm64-arm-64bit
[0m14:08:08.912021 [info ] [MainThread]: Using profiles dir at /Users/jordi.vidaldellobatera/.dbt
[0m14:08:08.912292 [info ] [MainThread]: Using profiles.yml file at /Users/jordi.vidaldellobatera/.dbt/profiles.yml
[0m14:08:08.912456 [info ] [MainThread]: Using dbt_project.yml file at /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/dbt_project.yml
[0m14:08:08.913047 [info ] [MainThread]: adapter type: postgres
[0m14:08:08.913208 [info ] [MainThread]: adapter version: 1.9.0
[0m14:08:08.957354 [info ] [MainThread]: Configuration:
[0m14:08:08.957662 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:08:08.957841 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:08:08.957995 [info ] [MainThread]: Required dependencies:
[0m14:08:08.958263 [debug] [MainThread]: Executing "git --help"
[0m14:08:08.991090 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:08:08.991681 [debug] [MainThread]: STDERR: "b''"
[0m14:08:08.991930 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:08:08.992148 [info ] [MainThread]: Connection:
[0m14:08:08.992354 [info ] [MainThread]:   host: localhost
[0m14:08:08.992520 [info ] [MainThread]:   port: 5432
[0m14:08:08.992685 [info ] [MainThread]:   user: dbt_user
[0m14:08:08.992841 [info ] [MainThread]:   database: jaffle_shop
[0m14:08:08.993007 [info ] [MainThread]:   schema: public
[0m14:08:08.993167 [info ] [MainThread]:   connect_timeout: 10
[0m14:08:08.993330 [info ] [MainThread]:   role: None
[0m14:08:08.993484 [info ] [MainThread]:   search_path: None
[0m14:08:08.993768 [info ] [MainThread]:   keepalives_idle: 0
[0m14:08:08.993999 [info ] [MainThread]:   sslmode: None
[0m14:08:08.994180 [info ] [MainThread]:   sslcert: None
[0m14:08:08.994349 [info ] [MainThread]:   sslkey: None
[0m14:08:08.994517 [info ] [MainThread]:   sslrootcert: None
[0m14:08:08.994680 [info ] [MainThread]:   application_name: dbt
[0m14:08:08.994843 [info ] [MainThread]:   retries: 1
[0m14:08:08.995262 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:08:09.070769 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:08:09.144727 [debug] [MainThread]: Using postgres connection "debug"
[0m14:08:09.145009 [debug] [MainThread]: On debug: select 1 as id
[0m14:08:09.145181 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:08:09.180910 [debug] [MainThread]: SQL status: SELECT 1 in 0.036 seconds
[0m14:08:09.181653 [debug] [MainThread]: On debug: Close
[0m14:08:09.181911 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:08:09.182142 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:08:09.182586 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.42098853, "process_in_blocks": "0", "process_kernel_time": 0.233211, "process_mem_max_rss": "108216320", "process_out_blocks": "0", "process_user_time": 0.744028}
[0m14:08:09.182877 [debug] [MainThread]: Command `dbt debug` succeeded at 14:08:09.182819 after 0.42 seconds
[0m14:08:09.183097 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:08:09.183334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10908f680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c33260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083c88c0>]}
[0m14:08:09.183647 [debug] [MainThread]: Flushing usage events
[0m14:08:09.295666 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:19:18.149623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110779730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d9d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d9d550>]}


============================== 20:19:18.162330 | 338a5ec0-acd3-49ee-9660-d8250a8312a7 ==============================
[0m20:19:18.162330 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:19:18.162876 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jordi.vidaldellobatera/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:19:18.666645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '338a5ec0-acd3-49ee-9660-d8250a8312a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b16cc0>]}
[0m20:19:18.694338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '338a5ec0-acd3-49ee-9660-d8250a8312a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fd2a50>]}
[0m20:19:18.698674 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:19:18.820327 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m20:19:19.281459 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:19:19.281816 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:19:19.309515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '338a5ec0-acd3-49ee-9660-d8250a8312a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fd33e0>]}
[0m20:19:19.355685 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m20:19:19.365622 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m20:19:19.501341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '338a5ec0-acd3-49ee-9660-d8250a8312a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111988bf0>]}
[0m20:19:19.501881 [info ] [MainThread]: Found 3 models, 6 seeds, 4 data tests, 431 macros
[0m20:19:19.502226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '338a5ec0-acd3-49ee-9660-d8250a8312a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111015df0>]}
[0m20:19:19.504052 [info ] [MainThread]: 
[0m20:19:19.504431 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:19:19.504710 [info ] [MainThread]: 
[0m20:19:19.505143 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:19:19.508076 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m20:19:21.062317 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m20:19:21.062727 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m20:19:21.063000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:21.334551 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.271 seconds
[0m20:19:21.335832 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m20:19:21.337561 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now list_jaffle_shop_public)
[0m20:19:21.344431 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m20:19:21.344751 [debug] [ThreadPool]: On list_jaffle_shop_public: BEGIN
[0m20:19:21.344923 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:19:21.358903 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m20:19:21.359235 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m20:19:21.359611 [debug] [ThreadPool]: On list_jaffle_shop_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_public"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:19:21.363795 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m20:19:21.403174 [debug] [ThreadPool]: On list_jaffle_shop_public: ROLLBACK
[0m20:19:21.404567 [debug] [ThreadPool]: On list_jaffle_shop_public: Close
[0m20:19:21.409495 [debug] [MainThread]: Using postgres connection "master"
[0m20:19:21.415257 [debug] [MainThread]: On master: BEGIN
[0m20:19:21.415944 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:19:21.428443 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m20:19:21.428831 [debug] [MainThread]: Using postgres connection "master"
[0m20:19:21.429100 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:19:21.433444 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m20:19:21.434459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '338a5ec0-acd3-49ee-9660-d8250a8312a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e96570>]}
[0m20:19:21.434752 [debug] [MainThread]: On master: ROLLBACK
[0m20:19:21.435654 [debug] [MainThread]: Using postgres connection "master"
[0m20:19:21.435830 [debug] [MainThread]: On master: BEGIN
[0m20:19:21.436958 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:19:21.437169 [debug] [MainThread]: On master: COMMIT
[0m20:19:21.437362 [debug] [MainThread]: Using postgres connection "master"
[0m20:19:21.437573 [debug] [MainThread]: On master: COMMIT
[0m20:19:21.438274 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:19:21.438534 [debug] [MainThread]: On master: Close
[0m20:19:21.439460 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m20:19:21.439836 [info ] [Thread-1 (]: 1 of 3 START sql view model public.customers ................................... [RUN]
[0m20:19:21.440138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_public, now model.jaffle_shop.customers)
[0m20:19:21.440341 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m20:19:21.444935 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m20:19:21.449056 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m20:19:21.473619 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m20:19:21.477342 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m20:19:21.477704 [debug] [Thread-1 (]: On model.jaffle_shop.customers: BEGIN
[0m20:19:21.477899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:21.493657 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m20:19:21.494628 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m20:19:21.495002 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  create view "jaffle_shop"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from public.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from public.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m20:19:21.497163 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "public.jaffle_shop.customers"
LINE 14:     from public.jaffle_shop.customers
                  ^

[0m20:19:21.499926 [debug] [Thread-1 (]: On model.jaffle_shop.customers: ROLLBACK
[0m20:19:21.502625 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m20:19:21.758558 [debug] [Thread-1 (]: Database Error in model customers (jaffle_shop/models/customers.sql)
  cross-database references are not implemented: "public.jaffle_shop.customers"
  LINE 14:     from public.jaffle_shop.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m20:19:21.763370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '338a5ec0-acd3-49ee-9660-d8250a8312a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f27bc0>]}
[0m20:19:21.763909 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.customers .......................... [[31mERROR[0m in 0.32s]
[0m20:19:21.764465 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m20:19:21.764726 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m20:19:21.765045 [debug] [Thread-4 (]: Marking all children of 'model.jaffle_shop.customers' to be skipped because of status 'error'.  Reason: Database Error in model customers (jaffle_shop/models/customers.sql)
  cross-database references are not implemented: "public.jaffle_shop.customers"
  LINE 14:     from public.jaffle_shop.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql.
[0m20:19:21.765344 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:19:21.766187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.customers, now model.jaffle_shop.my_first_dbt_model)
[0m20:19:21.766466 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m20:19:21.769894 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m20:19:21.773064 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m20:19:21.790826 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m20:19:21.795337 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:19:21.795645 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: BEGIN
[0m20:19:21.795848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:21.810996 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m20:19:21.811334 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:19:21.811749 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

  create  table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m20:19:21.814984 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m20:19:21.819562 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:19:21.819899 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m20:19:21.821380 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:19:21.823533 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:19:21.823898 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:19:21.826194 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:19:21.839013 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m20:19:21.839350 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:19:21.839554 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m20:19:21.842624 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m20:19:21.847098 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_first_dbt_model__dbt_backup"
[0m20:19:21.850384 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:19:21.850669 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
drop table if exists "jaffle_shop"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:19:21.854695 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m20:19:21.856252 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m20:19:21.856651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '338a5ec0-acd3-49ee-9660-d8250a8312a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b15dc0>]}
[0m20:19:21.857006 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.09s]
[0m20:19:21.857567 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m20:19:21.858343 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m20:19:21.858690 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:19:21.859024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.my_second_dbt_model)
[0m20:19:21.859285 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m20:19:21.861063 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m20:19:21.863558 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m20:19:21.866611 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m20:19:21.873796 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:19:21.874566 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: BEGIN
[0m20:19:21.875256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:21.890407 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m20:19:21.891283 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:19:21.891613 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */

  create view "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "jaffle_shop"."public"."my_first_dbt_model"
where id = 1
  );
[0m20:19:21.893867 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:19:21.895740 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:19:21.895979 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
alter table "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:19:21.897774 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:19:21.898825 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m20:19:21.899105 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:19:21.899298 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m20:19:21.902093 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:19:21.905948 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_second_dbt_model__dbt_backup"
[0m20:19:21.908003 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:19:21.908316 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "jaffle_shop"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:19:21.909524 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m20:19:21.910392 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m20:19:21.910778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '338a5ec0-acd3-49ee-9660-d8250a8312a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fc4950>]}
[0m20:19:21.911129 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.05s]
[0m20:19:21.911493 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m20:19:21.912619 [debug] [MainThread]: Using postgres connection "master"
[0m20:19:21.912836 [debug] [MainThread]: On master: BEGIN
[0m20:19:21.912995 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:19:21.924378 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m20:19:21.925078 [debug] [MainThread]: On master: COMMIT
[0m20:19:21.925280 [debug] [MainThread]: Using postgres connection "master"
[0m20:19:21.925500 [debug] [MainThread]: On master: COMMIT
[0m20:19:21.926655 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:19:21.926923 [debug] [MainThread]: On master: Close
[0m20:19:21.927224 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:19:21.927450 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m20:19:21.927690 [info ] [MainThread]: 
[0m20:19:21.927895 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 2.42 seconds (2.42s).
[0m20:19:21.928379 [debug] [MainThread]: Command end result
[0m20:19:21.941093 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m20:19:21.942437 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m20:19:21.949251 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/run_results.json
[0m20:19:21.949523 [info ] [MainThread]: 
[0m20:19:21.949746 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:19:21.949923 [info ] [MainThread]: 
[0m20:19:21.950126 [error] [MainThread]:   Database Error in model customers (jaffle_shop/models/customers.sql)
  cross-database references are not implemented: "public.jaffle_shop.customers"
  LINE 14:     from public.jaffle_shop.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m20:19:21.950290 [info ] [MainThread]: 
[0m20:19:21.950576 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:19:21.951027 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.9677734, "process_in_blocks": "0", "process_kernel_time": 0.835006, "process_mem_max_rss": "119635968", "process_out_blocks": "0", "process_user_time": 2.046028}
[0m20:19:21.951283 [debug] [MainThread]: Command `dbt run` failed at 20:19:21.951237 after 3.97 seconds
[0m20:19:21.951534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110779820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11027dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d2f740>]}
[0m20:19:21.951757 [debug] [MainThread]: Flushing usage events
[0m20:19:22.458741 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:22:38.263762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bf63c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067a9970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067a95b0>]}


============================== 20:22:38.267643 | 0a1b610f-4ffc-45e5-b8cf-963e3a61a6fe ==============================
[0m20:22:38.267643 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:22:38.267989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/logs', 'profiles_dir': '/Users/jordi.vidaldellobatera/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:22:38.389951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a1b610f-4ffc-45e5-b8cf-963e3a61a6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10387aa50>]}
[0m20:22:38.414990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a1b610f-4ffc-45e5-b8cf-963e3a61a6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c84920>]}
[0m20:22:38.416045 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:22:38.485705 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m20:22:38.588455 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:22:38.588825 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://jaffle_shop/models/customers.sql
[0m20:22:38.702838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a1b610f-4ffc-45e5-b8cf-963e3a61a6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10749cb30>]}
[0m20:22:38.738386 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m20:22:38.741150 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m20:22:38.762387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a1b610f-4ffc-45e5-b8cf-963e3a61a6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107572cc0>]}
[0m20:22:38.762701 [info ] [MainThread]: Found 3 models, 6 seeds, 4 data tests, 431 macros
[0m20:22:38.762901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a1b610f-4ffc-45e5-b8cf-963e3a61a6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10758b350>]}
[0m20:22:38.763831 [info ] [MainThread]: 
[0m20:22:38.764024 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:22:38.764179 [info ] [MainThread]: 
[0m20:22:38.764431 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:22:38.766244 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m20:22:38.850107 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m20:22:38.850362 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m20:22:38.850524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:22:38.884209 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.034 seconds
[0m20:22:38.885055 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m20:22:38.885952 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now list_jaffle_shop_public)
[0m20:22:38.889289 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m20:22:38.889487 [debug] [ThreadPool]: On list_jaffle_shop_public: BEGIN
[0m20:22:38.889639 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:22:38.898082 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m20:22:38.898342 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m20:22:38.898593 [debug] [ThreadPool]: On list_jaffle_shop_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_public"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:22:38.900692 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m20:22:38.901556 [debug] [ThreadPool]: On list_jaffle_shop_public: ROLLBACK
[0m20:22:38.902233 [debug] [ThreadPool]: On list_jaffle_shop_public: Close
[0m20:22:38.905694 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:38.905944 [debug] [MainThread]: On master: BEGIN
[0m20:22:38.906111 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:22:38.913586 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m20:22:38.913828 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:38.914093 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:22:38.917146 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m20:22:38.918096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a1b610f-4ffc-45e5-b8cf-963e3a61a6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107417290>]}
[0m20:22:38.918388 [debug] [MainThread]: On master: ROLLBACK
[0m20:22:38.919121 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:38.919309 [debug] [MainThread]: On master: BEGIN
[0m20:22:38.920402 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:22:38.920618 [debug] [MainThread]: On master: COMMIT
[0m20:22:38.920817 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:38.920999 [debug] [MainThread]: On master: COMMIT
[0m20:22:38.921591 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:22:38.921788 [debug] [MainThread]: On master: Close
[0m20:22:38.922691 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m20:22:38.923043 [info ] [Thread-1 (]: 1 of 3 START sql view model public.customers ................................... [RUN]
[0m20:22:38.923371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_public, now model.jaffle_shop.customers)
[0m20:22:38.923610 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m20:22:38.927421 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m20:22:38.928373 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m20:22:38.946601 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m20:22:38.947510 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m20:22:38.947714 [debug] [Thread-1 (]: On model.jaffle_shop.customers: BEGIN
[0m20:22:38.947885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:22:38.958079 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m20:22:38.958320 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m20:22:38.958597 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  create view "jaffle_shop"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m20:22:38.959434 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "jaffle_shop.customers" does not exist
LINE 14:     from jaffle_shop.customers
                  ^

[0m20:22:38.959656 [debug] [Thread-1 (]: On model.jaffle_shop.customers: ROLLBACK
[0m20:22:38.960489 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m20:22:38.967652 [debug] [Thread-1 (]: Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "jaffle_shop.customers" does not exist
  LINE 14:     from jaffle_shop.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m20:22:38.968875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a1b610f-4ffc-45e5-b8cf-963e3a61a6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106356900>]}
[0m20:22:38.969244 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.customers .......................... [[31mERROR[0m in 0.04s]
[0m20:22:38.969608 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m20:22:38.969826 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m20:22:38.970069 [debug] [Thread-4 (]: Marking all children of 'model.jaffle_shop.customers' to be skipped because of status 'error'.  Reason: Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "jaffle_shop.customers" does not exist
  LINE 14:     from jaffle_shop.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql.
[0m20:22:38.970322 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:22:38.970871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.customers, now model.jaffle_shop.my_first_dbt_model)
[0m20:22:38.971061 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m20:22:38.972531 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m20:22:38.973090 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m20:22:38.984779 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m20:22:38.985621 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:22:38.985813 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: BEGIN
[0m20:22:38.985975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:22:38.996372 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m20:22:38.996610 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:22:38.996803 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

  create  table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m20:22:38.999157 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m20:22:39.002917 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:22:39.003156 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m20:22:39.003968 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:39.005523 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:22:39.005798 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:22:39.006520 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:39.017282 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m20:22:39.017526 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:22:39.017712 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m20:22:39.019824 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:22:39.024208 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_first_dbt_model__dbt_backup"
[0m20:22:39.026801 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:22:39.027032 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
drop table if exists "jaffle_shop"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:22:39.030267 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:22:39.031651 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m20:22:39.032018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a1b610f-4ffc-45e5-b8cf-963e3a61a6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103879be0>]}
[0m20:22:39.032370 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.06s]
[0m20:22:39.032679 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m20:22:39.033077 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m20:22:39.033377 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:22:39.033636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.my_second_dbt_model)
[0m20:22:39.033838 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m20:22:39.035331 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m20:22:39.036096 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m20:22:39.037846 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m20:22:39.038328 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:22:39.038512 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: BEGIN
[0m20:22:39.038814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:22:39.047782 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m20:22:39.048109 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:22:39.048328 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */

  create view "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "jaffle_shop"."public"."my_first_dbt_model"
where id = 1
  );
[0m20:22:39.049699 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:22:39.051498 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:22:39.051714 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
alter table "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:22:39.053427 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:22:39.054255 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m20:22:39.054458 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:22:39.054693 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m20:22:39.056776 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:22:39.058049 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_second_dbt_model__dbt_backup"
[0m20:22:39.059831 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:22:39.060141 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "jaffle_shop"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:22:39.061032 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m20:22:39.061850 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m20:22:39.062200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a1b610f-4ffc-45e5-b8cf-963e3a61a6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a520f0>]}
[0m20:22:39.062558 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.03s]
[0m20:22:39.062866 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m20:22:39.063648 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:39.063855 [debug] [MainThread]: On master: BEGIN
[0m20:22:39.064020 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:22:39.073650 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m20:22:39.073912 [debug] [MainThread]: On master: COMMIT
[0m20:22:39.074135 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:39.074333 [debug] [MainThread]: On master: COMMIT
[0m20:22:39.075048 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:22:39.075283 [debug] [MainThread]: On master: Close
[0m20:22:39.075647 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:22:39.076026 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m20:22:39.076352 [info ] [MainThread]: 
[0m20:22:39.076629 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m20:22:39.077238 [debug] [MainThread]: Command end result
[0m20:22:39.090027 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m20:22:39.091511 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m20:22:39.095286 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/run_results.json
[0m20:22:39.095534 [info ] [MainThread]: 
[0m20:22:39.095744 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:22:39.095914 [info ] [MainThread]: 
[0m20:22:39.096114 [error] [MainThread]:   Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "jaffle_shop.customers" does not exist
  LINE 14:     from jaffle_shop.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m20:22:39.096275 [info ] [MainThread]: 
[0m20:22:39.096442 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:22:39.096762 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8905491, "process_in_blocks": "0", "process_kernel_time": 0.251411, "process_mem_max_rss": "120799232", "process_out_blocks": "0", "process_user_time": 1.082134}
[0m20:22:39.096986 [debug] [MainThread]: Command `dbt run` failed at 20:22:39.096946 after 0.89 seconds
[0m20:22:39.097196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105abbb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106629010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10662ba70>]}
[0m20:22:39.097449 [debug] [MainThread]: Flushing usage events
[0m20:22:39.636659 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:24:40.360708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085b1430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a997c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a99340>]}


============================== 20:24:40.364351 | 3c07c4f1-e21e-4185-9852-85eb8f193313 ==============================
[0m20:24:40.364351 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:24:40.364707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/jordi.vidaldellobatera/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:24:40.488544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c07c4f1-e21e-4185-9852-85eb8f193313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b0c8c0>]}
[0m20:24:40.513015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c07c4f1-e21e-4185-9852-85eb8f193313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bc0140>]}
[0m20:24:40.513979 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:24:40.579014 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m20:24:40.625369 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:24:40.625690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3c07c4f1-e21e-4185-9852-85eb8f193313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10972e780>]}
[0m20:24:41.228909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c07c4f1-e21e-4185-9852-85eb8f193313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ad4800>]}
[0m20:24:41.264027 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m20:24:41.266400 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m20:24:41.291758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c07c4f1-e21e-4185-9852-85eb8f193313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099f5790>]}
[0m20:24:41.292061 [info ] [MainThread]: Found 3 models, 6 seeds, 4 data tests, 431 macros
[0m20:24:41.292246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c07c4f1-e21e-4185-9852-85eb8f193313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a62fc0>]}
[0m20:24:41.293239 [info ] [MainThread]: 
[0m20:24:41.293449 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:24:41.293608 [info ] [MainThread]: 
[0m20:24:41.293863 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:24:41.295887 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m20:24:41.410940 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m20:24:41.411200 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m20:24:41.411361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:24:41.445497 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.034 seconds
[0m20:24:41.446396 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m20:24:41.446838 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_public_public)
[0m20:24:41.447325 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "public_public"
"
[0m20:24:41.450349 [debug] [ThreadPool]: Using postgres connection "create_jaffle_shop_public_public"
[0m20:24:41.450559 [debug] [ThreadPool]: On create_jaffle_shop_public_public: BEGIN
[0m20:24:41.450723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:24:41.459442 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m20:24:41.459701 [debug] [ThreadPool]: Using postgres connection "create_jaffle_shop_public_public"
[0m20:24:41.459926 [debug] [ThreadPool]: On create_jaffle_shop_public_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_public_public"} */
create schema if not exists "public_public"
[0m20:24:41.460832 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m20:24:41.461451 [debug] [ThreadPool]: On create_jaffle_shop_public_public: COMMIT
[0m20:24:41.461664 [debug] [ThreadPool]: Using postgres connection "create_jaffle_shop_public_public"
[0m20:24:41.461846 [debug] [ThreadPool]: On create_jaffle_shop_public_public: COMMIT
[0m20:24:41.462858 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m20:24:41.463043 [debug] [ThreadPool]: On create_jaffle_shop_public_public: Close
[0m20:24:41.464006 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_jaffle_shop_public_public, now list_jaffle_shop_public_public)
[0m20:24:41.468384 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public_public"
[0m20:24:41.468621 [debug] [ThreadPool]: On list_jaffle_shop_public_public: BEGIN
[0m20:24:41.468788 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:24:41.476606 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m20:24:41.476928 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public_public"
[0m20:24:41.477135 [debug] [ThreadPool]: On list_jaffle_shop_public_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_public_public"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'jaffle_shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m20:24:41.479514 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m20:24:41.480345 [debug] [ThreadPool]: On list_jaffle_shop_public_public: ROLLBACK
[0m20:24:41.481033 [debug] [ThreadPool]: On list_jaffle_shop_public_public: Close
[0m20:24:41.481393 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop_public_public, now list_jaffle_shop_public)
[0m20:24:41.482747 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m20:24:41.482993 [debug] [ThreadPool]: On list_jaffle_shop_public: BEGIN
[0m20:24:41.483170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:24:41.491195 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m20:24:41.491484 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m20:24:41.491694 [debug] [ThreadPool]: On list_jaffle_shop_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_public"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:24:41.493790 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m20:24:41.494675 [debug] [ThreadPool]: On list_jaffle_shop_public: ROLLBACK
[0m20:24:41.495322 [debug] [ThreadPool]: On list_jaffle_shop_public: Close
[0m20:24:41.498799 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:41.499051 [debug] [MainThread]: On master: BEGIN
[0m20:24:41.499233 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:24:41.506971 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:24:41.507272 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:41.507531 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:24:41.510704 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m20:24:41.511615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c07c4f1-e21e-4185-9852-85eb8f193313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098e3f50>]}
[0m20:24:41.511909 [debug] [MainThread]: On master: ROLLBACK
[0m20:24:41.512509 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:41.512686 [debug] [MainThread]: On master: BEGIN
[0m20:24:41.513692 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:24:41.513879 [debug] [MainThread]: On master: COMMIT
[0m20:24:41.514052 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:41.514217 [debug] [MainThread]: On master: COMMIT
[0m20:24:41.514793 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:24:41.514974 [debug] [MainThread]: On master: Close
[0m20:24:41.515784 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m20:24:41.516092 [info ] [Thread-1 (]: 1 of 3 START sql view model public_public.customers ............................ [RUN]
[0m20:24:41.516361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_public, now model.jaffle_shop.customers)
[0m20:24:41.516565 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m20:24:41.520585 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m20:24:41.521554 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m20:24:41.540070 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m20:24:41.541060 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m20:24:41.541267 [debug] [Thread-1 (]: On model.jaffle_shop.customers: BEGIN
[0m20:24:41.541441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:41.551496 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m20:24:41.551794 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m20:24:41.552035 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  create view "jaffle_shop"."public_public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m20:24:41.552887 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "jaffle_shop.customers" does not exist
LINE 14:     from jaffle_shop.customers
                  ^

[0m20:24:41.553133 [debug] [Thread-1 (]: On model.jaffle_shop.customers: ROLLBACK
[0m20:24:41.554035 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m20:24:41.560589 [debug] [Thread-1 (]: Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "jaffle_shop.customers" does not exist
  LINE 14:     from jaffle_shop.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m20:24:41.562056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c07c4f1-e21e-4185-9852-85eb8f193313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a7ca10>]}
[0m20:24:41.562412 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public_public.customers ................... [[31mERROR[0m in 0.04s]
[0m20:24:41.562716 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m20:24:41.562925 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m20:24:41.563187 [debug] [Thread-4 (]: Marking all children of 'model.jaffle_shop.customers' to be skipped because of status 'error'.  Reason: Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "jaffle_shop.customers" does not exist
  LINE 14:     from jaffle_shop.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql.
[0m20:24:41.563430 [info ] [Thread-1 (]: 2 of 3 START sql table model public_public.my_first_dbt_model .................. [RUN]
[0m20:24:41.563996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.customers, now model.jaffle_shop.my_first_dbt_model)
[0m20:24:41.564173 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m20:24:41.565675 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m20:24:41.566283 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m20:24:41.577830 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m20:24:41.578705 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:24:41.578917 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: BEGIN
[0m20:24:41.579090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:41.587987 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m20:24:41.588290 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:24:41.588588 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

  create  table "jaffle_shop"."public_public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m20:24:41.589828 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m20:24:41.593127 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:24:41.593349 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public_public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:24:41.594098 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:24:41.603073 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m20:24:41.603299 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:24:41.603475 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m20:24:41.605341 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:24:41.609100 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public_public"."my_first_dbt_model__dbt_backup"
[0m20:24:41.611716 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:24:41.611937 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
drop table if exists "jaffle_shop"."public_public"."my_first_dbt_model__dbt_backup" cascade
[0m20:24:41.613117 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m20:24:41.614317 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m20:24:41.614650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c07c4f1-e21e-4185-9852-85eb8f193313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bb5b50>]}
[0m20:24:41.615020 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public_public.my_first_dbt_model ............. [[32mSELECT 2[0m in 0.05s]
[0m20:24:41.615311 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m20:24:41.615677 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m20:24:41.615937 [info ] [Thread-1 (]: 3 of 3 START sql view model public_public.my_second_dbt_model .................. [RUN]
[0m20:24:41.616158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.my_second_dbt_model)
[0m20:24:41.616334 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m20:24:41.617683 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m20:24:41.618509 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m20:24:41.620280 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m20:24:41.620844 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:24:41.621046 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: BEGIN
[0m20:24:41.621243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:41.630657 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m20:24:41.631020 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:24:41.631319 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */

  create view "jaffle_shop"."public_public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "jaffle_shop"."public_public"."my_first_dbt_model"
where id = 1
  );
[0m20:24:41.632573 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:24:41.634239 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:24:41.634433 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
alter table "jaffle_shop"."public_public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:24:41.635025 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:24:41.635825 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m20:24:41.636026 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:24:41.636208 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m20:24:41.637186 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:24:41.638406 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public_public"."my_second_dbt_model__dbt_backup"
[0m20:24:41.640105 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:24:41.640331 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "jaffle_shop"."public_public"."my_second_dbt_model__dbt_backup" cascade
[0m20:24:41.641467 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m20:24:41.642174 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m20:24:41.642483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c07c4f1-e21e-4185-9852-85eb8f193313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8b9700>]}
[0m20:24:41.642823 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public_public.my_second_dbt_model ............. [[32mCREATE VIEW[0m in 0.03s]
[0m20:24:41.643155 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m20:24:41.643818 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:41.644015 [debug] [MainThread]: On master: BEGIN
[0m20:24:41.644177 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:24:41.651992 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:24:41.652308 [debug] [MainThread]: On master: COMMIT
[0m20:24:41.652522 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:41.652693 [debug] [MainThread]: On master: COMMIT
[0m20:24:41.653327 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:24:41.653505 [debug] [MainThread]: On master: Close
[0m20:24:41.653772 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:24:41.653932 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m20:24:41.654146 [info ] [MainThread]: 
[0m20:24:41.654347 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m20:24:41.654842 [debug] [MainThread]: Command end result
[0m20:24:41.668033 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m20:24:41.669599 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m20:24:41.672748 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/run_results.json
[0m20:24:41.672941 [info ] [MainThread]: 
[0m20:24:41.673145 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:24:41.673311 [info ] [MainThread]: 
[0m20:24:41.673541 [error] [MainThread]:   Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "jaffle_shop.customers" does not exist
  LINE 14:     from jaffle_shop.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m20:24:41.673719 [info ] [MainThread]: 
[0m20:24:41.673891 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:24:41.674212 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3789489, "process_in_blocks": "0", "process_kernel_time": 0.266603, "process_mem_max_rss": "123142144", "process_out_blocks": "0", "process_user_time": 1.540295}
[0m20:24:41.674432 [debug] [MainThread]: Command `dbt run` failed at 20:24:41.674391 after 1.38 seconds
[0m20:24:41.674631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a99940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108779e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f998e0>]}
[0m20:24:41.674822 [debug] [MainThread]: Flushing usage events
[0m20:24:42.158665 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:26:58.508678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103835820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045a9670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045a92e0>]}


============================== 20:26:58.512661 | 32ed5b03-05e1-411f-bcc5-64b3c24fa5f7 ==============================
[0m20:26:58.512661 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:26:58.513011 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/logs', 'version_check': 'True', 'profiles_dir': '/Users/jordi.vidaldellobatera/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:26:58.636119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32ed5b03-05e1-411f-bcc5-64b3c24fa5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105206c30>]}
[0m20:26:58.664446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32ed5b03-05e1-411f-bcc5-64b3c24fa5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105204110>]}
[0m20:26:58.665461 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:26:58.737815 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m20:26:58.788609 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:26:58.788951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '32ed5b03-05e1-411f-bcc5-64b3c24fa5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054df470>]}
[0m20:26:59.390561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32ed5b03-05e1-411f-bcc5-64b3c24fa5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061afb30>]}
[0m20:26:59.425370 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m20:26:59.427796 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m20:26:59.449656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32ed5b03-05e1-411f-bcc5-64b3c24fa5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061a0620>]}
[0m20:26:59.449960 [info ] [MainThread]: Found 3 models, 6 seeds, 4 data tests, 431 macros
[0m20:26:59.450149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32ed5b03-05e1-411f-bcc5-64b3c24fa5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061d8e60>]}
[0m20:26:59.451053 [info ] [MainThread]: 
[0m20:26:59.451250 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:26:59.451405 [info ] [MainThread]: 
[0m20:26:59.451649 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:26:59.453366 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m20:26:59.537127 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m20:26:59.537375 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m20:26:59.537536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:26:59.572919 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.035 seconds
[0m20:26:59.573802 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m20:26:59.574697 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now list_jaffle_shop_public)
[0m20:26:59.578168 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m20:26:59.578400 [debug] [ThreadPool]: On list_jaffle_shop_public: BEGIN
[0m20:26:59.578572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:26:59.588634 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m20:26:59.588909 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m20:26:59.589198 [debug] [ThreadPool]: On list_jaffle_shop_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_public"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:26:59.591432 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m20:26:59.592331 [debug] [ThreadPool]: On list_jaffle_shop_public: ROLLBACK
[0m20:26:59.593148 [debug] [ThreadPool]: On list_jaffle_shop_public: Close
[0m20:26:59.597478 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:59.597726 [debug] [MainThread]: On master: BEGIN
[0m20:26:59.597890 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:26:59.606709 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m20:26:59.606954 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:59.607211 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:26:59.610614 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m20:26:59.611583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32ed5b03-05e1-411f-bcc5-64b3c24fa5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106283a10>]}
[0m20:26:59.611878 [debug] [MainThread]: On master: ROLLBACK
[0m20:26:59.612525 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:59.612718 [debug] [MainThread]: On master: BEGIN
[0m20:26:59.613752 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:26:59.613947 [debug] [MainThread]: On master: COMMIT
[0m20:26:59.614185 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:59.614382 [debug] [MainThread]: On master: COMMIT
[0m20:26:59.615042 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:26:59.615231 [debug] [MainThread]: On master: Close
[0m20:26:59.615983 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m20:26:59.616313 [info ] [Thread-1 (]: 1 of 3 START sql view model public.customers ................................... [RUN]
[0m20:26:59.616587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_public, now model.jaffle_shop.customers)
[0m20:26:59.616792 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m20:26:59.620594 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m20:26:59.621416 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m20:26:59.640620 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m20:26:59.641584 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m20:26:59.641805 [debug] [Thread-1 (]: On model.jaffle_shop.customers: BEGIN
[0m20:26:59.641976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:59.651424 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m20:26:59.651708 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m20:26:59.651917 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  create view "jaffle_shop"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m20:26:59.652732 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "customers" does not exist
LINE 14:     from customers
                  ^
DETAIL:  There is a WITH item named "customers", but it cannot be referenced from this part of the query.
HINT:  Use WITH RECURSIVE, or re-order the WITH items to remove forward references.

[0m20:26:59.653015 [debug] [Thread-1 (]: On model.jaffle_shop.customers: ROLLBACK
[0m20:26:59.653759 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m20:26:59.661037 [debug] [Thread-1 (]: Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "customers" does not exist
  LINE 14:     from customers
                    ^
  DETAIL:  There is a WITH item named "customers", but it cannot be referenced from this part of the query.
  HINT:  Use WITH RECURSIVE, or re-order the WITH items to remove forward references.
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m20:26:59.662369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32ed5b03-05e1-411f-bcc5-64b3c24fa5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10620f290>]}
[0m20:26:59.662765 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.customers .......................... [[31mERROR[0m in 0.04s]
[0m20:26:59.663164 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m20:26:59.663395 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m20:26:59.663637 [debug] [Thread-4 (]: Marking all children of 'model.jaffle_shop.customers' to be skipped because of status 'error'.  Reason: Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "customers" does not exist
  LINE 14:     from customers
                    ^
  DETAIL:  There is a WITH item named "customers", but it cannot be referenced from this part of the query.
  HINT:  Use WITH RECURSIVE, or re-order the WITH items to remove forward references.
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql.
[0m20:26:59.663885 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:26:59.664463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.customers, now model.jaffle_shop.my_first_dbt_model)
[0m20:26:59.664656 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m20:26:59.666176 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m20:26:59.666888 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m20:26:59.678118 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m20:26:59.679093 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:26:59.679338 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: BEGIN
[0m20:26:59.679522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:59.690944 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m20:26:59.691211 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:26:59.691428 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

  create  table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m20:26:59.693032 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m20:26:59.697015 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:26:59.697315 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m20:26:59.698294 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:26:59.700004 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:26:59.700234 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:26:59.700877 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:26:59.711504 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m20:26:59.711749 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:26:59.711936 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m20:26:59.713909 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:26:59.717086 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_first_dbt_model__dbt_backup"
[0m20:26:59.719547 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:26:59.719757 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
drop table if exists "jaffle_shop"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:26:59.723404 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:26:59.724744 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m20:26:59.725106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32ed5b03-05e1-411f-bcc5-64b3c24fa5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101445850>]}
[0m20:26:59.725462 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.06s]
[0m20:26:59.725774 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m20:26:59.726168 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m20:26:59.726454 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:26:59.726689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.my_second_dbt_model)
[0m20:26:59.726939 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m20:26:59.729370 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m20:26:59.730187 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m20:26:59.732045 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m20:26:59.732671 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:26:59.732865 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: BEGIN
[0m20:26:59.733038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:59.743673 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m20:26:59.744036 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:26:59.744295 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */

  create view "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "jaffle_shop"."public"."my_first_dbt_model"
where id = 1
  );
[0m20:26:59.745859 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:26:59.747831 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:26:59.748070 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
alter table "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:26:59.748987 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:26:59.749824 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m20:26:59.750029 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:26:59.750211 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m20:26:59.751188 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:26:59.752419 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_second_dbt_model__dbt_backup"
[0m20:26:59.754212 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:26:59.754438 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "jaffle_shop"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:26:59.755660 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m20:26:59.756390 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m20:26:59.756722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32ed5b03-05e1-411f-bcc5-64b3c24fa5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065df200>]}
[0m20:26:59.757067 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.03s]
[0m20:26:59.757374 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m20:26:59.757916 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:59.758095 [debug] [MainThread]: On master: BEGIN
[0m20:26:59.758252 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:26:59.765889 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:26:59.766192 [debug] [MainThread]: On master: COMMIT
[0m20:26:59.766375 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:59.766536 [debug] [MainThread]: On master: COMMIT
[0m20:26:59.767193 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:26:59.767395 [debug] [MainThread]: On master: Close
[0m20:26:59.767658 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:26:59.767856 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m20:26:59.768089 [info ] [MainThread]: 
[0m20:26:59.768286 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m20:26:59.768794 [debug] [MainThread]: Command end result
[0m20:26:59.780957 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m20:26:59.782598 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m20:26:59.785664 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/run_results.json
[0m20:26:59.785845 [info ] [MainThread]: 
[0m20:26:59.786032 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:26:59.786187 [info ] [MainThread]: 
[0m20:26:59.786377 [error] [MainThread]:   Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "customers" does not exist
  LINE 14:     from customers
                    ^
  DETAIL:  There is a WITH item named "customers", but it cannot be referenced from this part of the query.
  HINT:  Use WITH RECURSIVE, or re-order the WITH items to remove forward references.
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m20:26:59.786534 [info ] [MainThread]: 
[0m20:26:59.786693 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:26:59.786999 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3408576, "process_in_blocks": "0", "process_kernel_time": 0.256075, "process_mem_max_rss": "122503168", "process_out_blocks": "0", "process_user_time": 1.538645}
[0m20:26:59.787205 [debug] [MainThread]: Command `dbt run` failed at 20:26:59.787167 after 1.34 seconds
[0m20:26:59.787418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035cf860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045a95e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10607aa80>]}
[0m20:26:59.787621 [debug] [MainThread]: Flushing usage events
[0m20:27:00.249276 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:28:10.571122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b63620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b295730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b295370>]}


============================== 20:28:10.581164 | 0e19dde9-3416-4e5a-96c8-0aeaf1fdbfaa ==============================
[0m20:28:10.581164 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:28:10.581726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/logs', 'debug': 'False', 'profiles_dir': '/Users/jordi.vidaldellobatera/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:28:10.853345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e19dde9-3416-4e5a-96c8-0aeaf1fdbfaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b666bd0>]}
[0m20:28:10.881050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e19dde9-3416-4e5a-96c8-0aeaf1fdbfaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a618cb0>]}
[0m20:28:10.886964 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:28:11.267677 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m20:28:11.668582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:28:11.669269 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://jaffle_shop/models/customers.sql
[0m20:28:11.813501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e19dde9-3416-4e5a-96c8-0aeaf1fdbfaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c23ca70>]}
[0m20:28:11.863290 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m20:28:11.881782 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m20:28:12.034129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e19dde9-3416-4e5a-96c8-0aeaf1fdbfaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c30ec00>]}
[0m20:28:12.034637 [info ] [MainThread]: Found 3 models, 6 seeds, 4 data tests, 431 macros
[0m20:28:12.034950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e19dde9-3416-4e5a-96c8-0aeaf1fdbfaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afd9700>]}
[0m20:28:12.036598 [info ] [MainThread]: 
[0m20:28:12.036960 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:28:12.037208 [info ] [MainThread]: 
[0m20:28:12.037601 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:28:12.040304 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m20:28:13.371534 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m20:28:13.371861 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m20:28:13.372085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:13.432290 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.060 seconds
[0m20:28:13.433709 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m20:28:13.434987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now list_jaffle_shop_public)
[0m20:28:13.440248 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m20:28:13.440626 [debug] [ThreadPool]: On list_jaffle_shop_public: BEGIN
[0m20:28:13.440894 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:28:13.454234 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m20:28:13.454753 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m20:28:13.455141 [debug] [ThreadPool]: On list_jaffle_shop_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_public"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:28:13.458476 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m20:28:13.459851 [debug] [ThreadPool]: On list_jaffle_shop_public: ROLLBACK
[0m20:28:13.461245 [debug] [ThreadPool]: On list_jaffle_shop_public: Close
[0m20:28:13.466564 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:13.466939 [debug] [MainThread]: On master: BEGIN
[0m20:28:13.467194 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:28:13.479590 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m20:28:13.480196 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:13.480716 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:28:13.485827 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m20:28:13.487335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e19dde9-3416-4e5a-96c8-0aeaf1fdbfaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c30fbf0>]}
[0m20:28:13.487758 [debug] [MainThread]: On master: ROLLBACK
[0m20:28:13.488677 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:13.488917 [debug] [MainThread]: On master: BEGIN
[0m20:28:13.490333 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:28:13.490665 [debug] [MainThread]: On master: COMMIT
[0m20:28:13.490947 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:13.491185 [debug] [MainThread]: On master: COMMIT
[0m20:28:13.491996 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:28:13.492316 [debug] [MainThread]: On master: Close
[0m20:28:13.493416 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m20:28:13.493806 [info ] [Thread-1 (]: 1 of 3 START sql view model public.customers ................................... [RUN]
[0m20:28:13.494189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_public, now model.jaffle_shop.customers)
[0m20:28:13.494489 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m20:28:13.500346 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m20:28:13.505108 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m20:28:13.527360 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m20:28:13.533144 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m20:28:13.533426 [debug] [Thread-1 (]: On model.jaffle_shop.customers: BEGIN
[0m20:28:13.533624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:13.546752 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m20:28:13.547008 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m20:28:13.547246 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  create view "jaffle_shop"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from public.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m20:28:13.548354 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.customers" does not exist
LINE 14:     from public.customers
                  ^

[0m20:28:13.548627 [debug] [Thread-1 (]: On model.jaffle_shop.customers: ROLLBACK
[0m20:28:13.549913 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m20:28:13.614090 [debug] [Thread-1 (]: Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "public.customers" does not exist
  LINE 14:     from public.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m20:28:13.617958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e19dde9-3416-4e5a-96c8-0aeaf1fdbfaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a427b90>]}
[0m20:28:13.618541 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.customers .......................... [[31mERROR[0m in 0.12s]
[0m20:28:13.619011 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m20:28:13.619334 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m20:28:13.619749 [debug] [Thread-4 (]: Marking all children of 'model.jaffle_shop.customers' to be skipped because of status 'error'.  Reason: Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "public.customers" does not exist
  LINE 14:     from public.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql.
[0m20:28:13.620176 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:28:13.620991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.customers, now model.jaffle_shop.my_first_dbt_model)
[0m20:28:13.621263 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m20:28:13.623355 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m20:28:13.626788 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m20:28:13.642546 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m20:28:13.645948 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:28:13.646255 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: BEGIN
[0m20:28:13.646479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:13.661445 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m20:28:13.661778 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:28:13.662035 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

  create  table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m20:28:13.663660 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m20:28:13.667900 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:28:13.668159 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m20:28:13.669060 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:28:13.670777 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:28:13.670994 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:28:13.671677 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:28:13.684374 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m20:28:13.684684 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:28:13.684886 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m20:28:13.686854 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:28:13.690400 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_first_dbt_model__dbt_backup"
[0m20:28:13.693122 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:28:13.693352 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
drop table if exists "jaffle_shop"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:28:13.697071 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:28:13.698400 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m20:28:13.698763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e19dde9-3416-4e5a-96c8-0aeaf1fdbfaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c99d90>]}
[0m20:28:13.699113 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.08s]
[0m20:28:13.699429 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m20:28:13.699859 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m20:28:13.700191 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:28:13.700463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.my_second_dbt_model)
[0m20:28:13.700672 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m20:28:13.702175 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m20:28:13.707951 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m20:28:13.710038 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m20:28:13.715055 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:28:13.715327 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: BEGIN
[0m20:28:13.715528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:13.726029 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m20:28:13.726394 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:28:13.726634 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */

  create view "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "jaffle_shop"."public"."my_first_dbt_model"
where id = 1
  );
[0m20:28:13.728312 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:28:13.731785 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:28:13.735090 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
alter table "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:28:13.764269 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.025 seconds
[0m20:28:13.765314 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m20:28:13.765562 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:28:13.765743 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m20:28:13.767090 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:28:13.770343 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_second_dbt_model__dbt_backup"
[0m20:28:13.775974 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:28:13.776569 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "jaffle_shop"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:28:13.777676 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m20:28:13.778473 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m20:28:13.778789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e19dde9-3416-4e5a-96c8-0aeaf1fdbfaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b13dc40>]}
[0m20:28:13.779131 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.08s]
[0m20:28:13.779423 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m20:28:13.780052 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:13.780264 [debug] [MainThread]: On master: BEGIN
[0m20:28:13.780426 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:28:13.787682 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m20:28:13.787967 [debug] [MainThread]: On master: COMMIT
[0m20:28:13.788142 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:13.788286 [debug] [MainThread]: On master: COMMIT
[0m20:28:13.788815 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:28:13.789007 [debug] [MainThread]: On master: Close
[0m20:28:13.789385 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:28:13.789634 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m20:28:13.789851 [info ] [MainThread]: 
[0m20:28:13.790088 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 1.75 seconds (1.75s).
[0m20:28:13.790572 [debug] [MainThread]: Command end result
[0m20:28:13.802445 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m20:28:13.803921 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m20:28:13.816567 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/run_results.json
[0m20:28:13.816828 [info ] [MainThread]: 
[0m20:28:13.817035 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:28:13.817199 [info ] [MainThread]: 
[0m20:28:13.817396 [error] [MainThread]:   Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "public.customers" does not exist
  LINE 14:     from public.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m20:28:13.817558 [info ] [MainThread]: 
[0m20:28:13.817815 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:28:13.818179 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.4138517, "process_in_blocks": "0", "process_kernel_time": 0.745885, "process_mem_max_rss": "124387328", "process_out_blocks": "0", "process_user_time": 2.11303}
[0m20:28:13.818411 [debug] [MainThread]: Command `dbt run` failed at 20:28:13.818368 after 3.41 seconds
[0m20:28:13.818630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a999970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b22f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c99d90>]}
[0m20:28:13.818828 [debug] [MainThread]: Flushing usage events
[0m20:28:13.992993 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:29:37.489649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ae900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f2a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106695190>]}


============================== 20:29:37.493291 | 888ba31e-0cf5-47b9-a8ae-f1aa28ac227a ==============================
[0m20:29:37.493291 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:29:37.493628 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/jordi.vidaldellobatera/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:29:37.559965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '888ba31e-0cf5-47b9-a8ae-f1aa28ac227a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f2a20>]}
[0m20:29:37.596614 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.16984071, "process_in_blocks": "0", "process_kernel_time": 0.15679, "process_mem_max_rss": "94404608", "process_out_blocks": "0", "process_user_time": 0.639342}
[0m20:29:37.596900 [debug] [MainThread]: Command `dbt clean` succeeded at 20:29:37.596848 after 0.17 seconds
[0m20:29:37.597131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066480e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ba19a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c74ef0>]}
[0m20:29:37.597442 [debug] [MainThread]: Flushing usage events
[0m20:29:38.067739 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:29:46.049806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108295730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d958b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d95400>]}


============================== 20:29:46.052998 | a9b1946e-4b01-47e4-aa09-60133ce6ff9d ==============================
[0m20:29:46.052998 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:29:46.053338 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/logs', 'profiles_dir': '/Users/jordi.vidaldellobatera/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:29:46.175222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9b1946e-4b01-47e4-aa09-60133ce6ff9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e92cc0>]}
[0m20:29:46.200628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9b1946e-4b01-47e4-aa09-60133ce6ff9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108754650>]}
[0m20:29:46.201766 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:29:46.267463 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m20:29:46.267985 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:29:46.268198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a9b1946e-4b01-47e4-aa09-60133ce6ff9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e8cbc0>]}
[0m20:29:46.907061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9b1946e-4b01-47e4-aa09-60133ce6ff9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10934e0c0>]}
[0m20:29:46.976294 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m20:29:46.978745 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m20:29:47.004685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9b1946e-4b01-47e4-aa09-60133ce6ff9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dc8860>]}
[0m20:29:47.004988 [info ] [MainThread]: Found 3 models, 6 seeds, 4 data tests, 431 macros
[0m20:29:47.005176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9b1946e-4b01-47e4-aa09-60133ce6ff9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c516d0>]}
[0m20:29:47.006228 [info ] [MainThread]: 
[0m20:29:47.006436 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:29:47.006592 [info ] [MainThread]: 
[0m20:29:47.006836 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:29:47.008822 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop_public'
[0m20:29:47.096358 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m20:29:47.096605 [debug] [ThreadPool]: On list_jaffle_shop_public: BEGIN
[0m20:29:47.096764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:29:47.129338 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m20:29:47.129602 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m20:29:47.129852 [debug] [ThreadPool]: On list_jaffle_shop_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_public"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:29:47.134222 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m20:29:47.135048 [debug] [ThreadPool]: On list_jaffle_shop_public: ROLLBACK
[0m20:29:47.135639 [debug] [ThreadPool]: On list_jaffle_shop_public: Close
[0m20:29:47.139014 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:47.139253 [debug] [MainThread]: On master: BEGIN
[0m20:29:47.139411 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:29:47.146966 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:29:47.147214 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:47.147490 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:29:47.150785 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m20:29:47.151765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9b1946e-4b01-47e4-aa09-60133ce6ff9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dc9ac0>]}
[0m20:29:47.152057 [debug] [MainThread]: On master: ROLLBACK
[0m20:29:47.152704 [debug] [MainThread]: On master: Close
[0m20:29:47.154534 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m20:29:47.154925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_public, now model.jaffle_shop.customers)
[0m20:29:47.155154 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m20:29:47.158859 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m20:29:47.160075 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m20:29:47.160475 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m20:29:47.160697 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m20:29:47.160953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.customers, now model.jaffle_shop.my_first_dbt_model)
[0m20:29:47.161177 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m20:29:47.162699 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m20:29:47.163340 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m20:29:47.163693 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m20:29:47.163909 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m20:29:47.164137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now seed.jaffle_shop.raw_customers)
[0m20:29:47.164350 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m20:29:47.165339 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m20:29:47.165657 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m20:29:47.165851 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_items
[0m20:29:47.166053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_customers, now seed.jaffle_shop.raw_items)
[0m20:29:47.166232 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_items
[0m20:29:47.167110 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_items
[0m20:29:47.167536 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_items
[0m20:29:47.167741 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_orders
[0m20:29:47.167952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_items, now seed.jaffle_shop.raw_orders)
[0m20:29:47.168135 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m20:29:47.168982 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_orders
[0m20:29:47.169269 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_orders
[0m20:29:47.169448 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_products
[0m20:29:47.169627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_orders, now seed.jaffle_shop.raw_products)
[0m20:29:47.169792 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_products
[0m20:29:47.170632 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_products
[0m20:29:47.170916 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_products
[0m20:29:47.171092 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_stores
[0m20:29:47.171270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_products, now seed.jaffle_shop.raw_stores)
[0m20:29:47.171433 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_stores
[0m20:29:47.172238 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_stores
[0m20:29:47.172527 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_stores
[0m20:29:47.172701 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_supplies
[0m20:29:47.172881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_stores, now seed.jaffle_shop.raw_supplies)
[0m20:29:47.173042 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_supplies
[0m20:29:47.174433 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_supplies
[0m20:29:47.174726 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_supplies
[0m20:29:47.174911 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m20:29:47.175095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_supplies, now model.jaffle_shop.my_second_dbt_model)
[0m20:29:47.175262 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m20:29:47.176493 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m20:29:47.176990 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m20:29:47.177322 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m20:29:47.177524 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:29:47.177811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_second_dbt_model, now test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710)
[0m20:29:47.178090 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:29:47.183926 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:29:47.184815 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:29:47.185146 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:29:47.185338 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m20:29:47.185539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710, now test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321)
[0m20:29:47.185710 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m20:29:47.188841 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321"
[0m20:29:47.189775 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m20:29:47.190111 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m20:29:47.190307 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m20:29:47.190512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_my_first_dbt_model_id.16e066b321, now test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778)
[0m20:29:47.190683 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m20:29:47.192585 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778"
[0m20:29:47.193189 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m20:29:47.193495 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m20:29:47.193712 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m20:29:47.193943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_my_second_dbt_model_id.151b76d778, now test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493)
[0m20:29:47.194127 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m20:29:47.195952 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:29:47.196558 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m20:29:47.196848 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m20:29:47.197283 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:29:47.197453 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m20:29:47.198311 [debug] [MainThread]: Command end result
[0m20:29:47.209303 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m20:29:47.210593 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m20:29:47.214033 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/run_results.json
[0m20:29:47.214382 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.2218102, "process_in_blocks": "0", "process_kernel_time": 0.243163, "process_mem_max_rss": "122961920", "process_out_blocks": "0", "process_user_time": 1.492984}
[0m20:29:47.214605 [debug] [MainThread]: Command `dbt compile` succeeded at 20:29:47.214562 after 1.22 seconds
[0m20:29:47.214799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108295730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10848c6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb0470>]}
[0m20:29:47.215011 [debug] [MainThread]: Flushing usage events
[0m20:29:47.294157 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:29:57.153864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064b7110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b956a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b952e0>]}


============================== 20:29:57.158020 | 2d798dcc-2d9c-4c0e-8ce7-09ef8d31225e ==============================
[0m20:29:57.158020 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:29:57.158384 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jordi.vidaldellobatera/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:29:57.281510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d798dcc-2d9c-4c0e-8ce7-09ef8d31225e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b97590>]}
[0m20:29:57.307252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d798dcc-2d9c-4c0e-8ce7-09ef8d31225e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064df7d0>]}
[0m20:29:57.308388 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:29:57.373927 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m20:29:57.467747 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:29:57.468015 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:29:57.489506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d798dcc-2d9c-4c0e-8ce7-09ef8d31225e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107141100>]}
[0m20:29:57.526014 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m20:29:57.528406 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m20:29:57.547977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d798dcc-2d9c-4c0e-8ce7-09ef8d31225e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078587d0>]}
[0m20:29:57.548280 [info ] [MainThread]: Found 3 models, 6 seeds, 4 data tests, 431 macros
[0m20:29:57.548476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d798dcc-2d9c-4c0e-8ce7-09ef8d31225e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107839a30>]}
[0m20:29:57.549446 [info ] [MainThread]: 
[0m20:29:57.549633 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:29:57.549784 [info ] [MainThread]: 
[0m20:29:57.550049 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:29:57.551958 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m20:29:57.641667 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m20:29:57.641937 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m20:29:57.642108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:29:57.675949 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.034 seconds
[0m20:29:57.676817 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m20:29:57.677703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now list_jaffle_shop_public)
[0m20:29:57.681241 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m20:29:57.681480 [debug] [ThreadPool]: On list_jaffle_shop_public: BEGIN
[0m20:29:57.681662 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:29:57.690309 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m20:29:57.690634 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m20:29:57.690860 [debug] [ThreadPool]: On list_jaffle_shop_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_public"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:29:57.693370 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m20:29:57.694302 [debug] [ThreadPool]: On list_jaffle_shop_public: ROLLBACK
[0m20:29:57.694902 [debug] [ThreadPool]: On list_jaffle_shop_public: Close
[0m20:29:57.698443 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:57.698690 [debug] [MainThread]: On master: BEGIN
[0m20:29:57.698871 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:29:57.706797 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:29:57.707096 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:57.707394 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:29:57.711018 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m20:29:57.711984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d798dcc-2d9c-4c0e-8ce7-09ef8d31225e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070fdcd0>]}
[0m20:29:57.712279 [debug] [MainThread]: On master: ROLLBACK
[0m20:29:57.712942 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:57.713145 [debug] [MainThread]: On master: BEGIN
[0m20:29:57.714164 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:29:57.714366 [debug] [MainThread]: On master: COMMIT
[0m20:29:57.714577 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:57.714759 [debug] [MainThread]: On master: COMMIT
[0m20:29:57.715445 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:29:57.715685 [debug] [MainThread]: On master: Close
[0m20:29:57.716550 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m20:29:57.716889 [info ] [Thread-1 (]: 1 of 3 START sql view model public.customers ................................... [RUN]
[0m20:29:57.717170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_public, now model.jaffle_shop.customers)
[0m20:29:57.717385 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m20:29:57.721240 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m20:29:57.722031 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m20:29:57.740836 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m20:29:57.742600 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m20:29:57.742799 [debug] [Thread-1 (]: On model.jaffle_shop.customers: BEGIN
[0m20:29:57.742982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:29:57.753490 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m20:29:57.753902 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m20:29:57.754131 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  create view "jaffle_shop"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from public.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from public.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m20:29:57.755100 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.customers" does not exist
LINE 14:     from public.customers
                  ^

[0m20:29:57.755302 [debug] [Thread-1 (]: On model.jaffle_shop.customers: ROLLBACK
[0m20:29:57.756190 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m20:29:57.762158 [debug] [Thread-1 (]: Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "public.customers" does not exist
  LINE 14:     from public.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m20:29:57.763540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d798dcc-2d9c-4c0e-8ce7-09ef8d31225e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c23e90>]}
[0m20:29:57.763916 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.customers .......................... [[31mERROR[0m in 0.05s]
[0m20:29:57.764231 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m20:29:57.764484 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m20:29:57.764739 [debug] [Thread-4 (]: Marking all children of 'model.jaffle_shop.customers' to be skipped because of status 'error'.  Reason: Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "public.customers" does not exist
  LINE 14:     from public.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql.
[0m20:29:57.764984 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:29:57.765560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.customers, now model.jaffle_shop.my_first_dbt_model)
[0m20:29:57.765745 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m20:29:57.767175 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m20:29:57.767748 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m20:29:57.780162 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m20:29:57.781260 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:29:57.781473 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: BEGIN
[0m20:29:57.781648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:29:57.792348 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m20:29:57.792538 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:29:57.792734 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

  create  table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m20:29:57.794243 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m20:29:57.797942 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:29:57.798197 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m20:29:57.799040 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:29:57.800589 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:29:57.800870 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:29:57.801680 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:29:57.812368 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m20:29:57.812621 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:29:57.812811 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m20:29:57.815614 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m20:29:57.819141 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_first_dbt_model__dbt_backup"
[0m20:29:57.821800 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:29:57.822035 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
drop table if exists "jaffle_shop"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:29:57.826203 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m20:29:57.827579 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m20:29:57.827947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d798dcc-2d9c-4c0e-8ce7-09ef8d31225e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101819c10>]}
[0m20:29:57.828313 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.06s]
[0m20:29:57.828682 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m20:29:57.829092 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m20:29:57.829346 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:29:57.829633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.my_second_dbt_model)
[0m20:29:57.829880 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m20:29:57.831952 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m20:29:57.832841 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m20:29:57.835027 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m20:29:57.835731 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:29:57.835941 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: BEGIN
[0m20:29:57.836130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:29:57.844947 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m20:29:57.845330 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:29:57.845594 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */

  create view "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "jaffle_shop"."public"."my_first_dbt_model"
where id = 1
  );
[0m20:29:57.847943 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:29:57.849927 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:29:57.850181 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
alter table "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:29:57.851117 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:29:57.851972 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m20:29:57.852186 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:29:57.852375 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m20:29:57.853310 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:29:57.854581 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_second_dbt_model__dbt_backup"
[0m20:29:57.856422 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:29:57.856660 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "jaffle_shop"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:29:57.857374 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m20:29:57.858107 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m20:29:57.858430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d798dcc-2d9c-4c0e-8ce7-09ef8d31225e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bf9040>]}
[0m20:29:57.858777 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.03s]
[0m20:29:57.859084 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m20:29:57.859700 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:57.859897 [debug] [MainThread]: On master: BEGIN
[0m20:29:57.860109 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:29:57.868069 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:29:57.868357 [debug] [MainThread]: On master: COMMIT
[0m20:29:57.868542 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:57.868703 [debug] [MainThread]: On master: COMMIT
[0m20:29:57.869275 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:29:57.869492 [debug] [MainThread]: On master: Close
[0m20:29:57.869763 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:29:57.869932 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m20:29:57.870162 [info ] [MainThread]: 
[0m20:29:57.870362 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m20:29:57.870857 [debug] [MainThread]: Command end result
[0m20:29:57.883717 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m20:29:57.885380 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m20:29:57.890530 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/run_results.json
[0m20:29:57.890743 [info ] [MainThread]: 
[0m20:29:57.890961 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:29:57.891145 [info ] [MainThread]: 
[0m20:29:57.891355 [error] [MainThread]:   Database Error in model customers (jaffle_shop/models/customers.sql)
  relation "public.customers" does not exist
  LINE 14:     from public.customers
                    ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m20:29:57.891525 [info ] [MainThread]: 
[0m20:29:57.891702 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:29:57.892036 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.80625755, "process_in_blocks": "0", "process_kernel_time": 0.244236, "process_mem_max_rss": "118358016", "process_out_blocks": "0", "process_user_time": 1.04328}
[0m20:29:57.892270 [debug] [MainThread]: Command `dbt run` failed at 20:29:57.892227 after 0.81 seconds
[0m20:29:57.892570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064b54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106130860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107887440>]}
[0m20:29:57.892799 [debug] [MainThread]: Flushing usage events
[0m20:29:57.973508 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:34:52.933023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120b5eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11279d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11279d5e0>]}


============================== 20:34:52.937345 | 80a5d6f4-8a7b-40bf-a6b4-9a58628deca7 ==============================
[0m20:34:52.937345 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:34:52.937752 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/jordi.vidaldellobatera/.dbt', 'log_path': '/Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:34:53.069360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80a5d6f4-8a7b-40bf-a6b4-9a58628deca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10704a9f0>]}
[0m20:34:53.096700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80a5d6f4-8a7b-40bf-a6b4-9a58628deca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133a08f0>]}
[0m20:34:53.097968 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:34:53.169715 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m20:34:53.309925 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:34:53.310329 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://jaffle_shop/models/customers.sql
[0m20:34:53.428533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80a5d6f4-8a7b-40bf-a6b4-9a58628deca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11413bdd0>]}
[0m20:34:53.464034 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m20:34:53.466435 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m20:34:53.486087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80a5d6f4-8a7b-40bf-a6b4-9a58628deca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11420ee40>]}
[0m20:34:53.486394 [info ] [MainThread]: Found 3 models, 6 seeds, 4 data tests, 431 macros
[0m20:34:53.486587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80a5d6f4-8a7b-40bf-a6b4-9a58628deca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114139070>]}
[0m20:34:53.487537 [info ] [MainThread]: 
[0m20:34:53.487761 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:34:53.487929 [info ] [MainThread]: 
[0m20:34:53.488197 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:34:53.490004 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m20:34:53.597225 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m20:34:53.597481 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m20:34:53.597647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:34:53.633657 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.036 seconds
[0m20:34:53.634532 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m20:34:53.635459 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now list_jaffle_shop_public)
[0m20:34:53.638830 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m20:34:53.639050 [debug] [ThreadPool]: On list_jaffle_shop_public: BEGIN
[0m20:34:53.639218 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:34:53.647743 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m20:34:53.648002 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m20:34:53.648200 [debug] [ThreadPool]: On list_jaffle_shop_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_public"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:34:53.650757 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m20:34:53.651620 [debug] [ThreadPool]: On list_jaffle_shop_public: ROLLBACK
[0m20:34:53.652281 [debug] [ThreadPool]: On list_jaffle_shop_public: Close
[0m20:34:53.655785 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:53.656028 [debug] [MainThread]: On master: BEGIN
[0m20:34:53.656197 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:34:53.663908 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:34:53.664188 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:53.664460 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:34:53.668044 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m20:34:53.669021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80a5d6f4-8a7b-40bf-a6b4-9a58628deca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11413a120>]}
[0m20:34:53.669307 [debug] [MainThread]: On master: ROLLBACK
[0m20:34:53.669938 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:53.670135 [debug] [MainThread]: On master: BEGIN
[0m20:34:53.671181 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:34:53.671444 [debug] [MainThread]: On master: COMMIT
[0m20:34:53.671655 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:53.671827 [debug] [MainThread]: On master: COMMIT
[0m20:34:53.672444 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:34:53.672626 [debug] [MainThread]: On master: Close
[0m20:34:53.673485 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m20:34:53.673825 [info ] [Thread-1 (]: 1 of 3 START sql view model public.customers ................................... [RUN]
[0m20:34:53.674104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_public, now model.jaffle_shop.customers)
[0m20:34:53.674319 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m20:34:53.678203 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m20:34:53.679083 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m20:34:53.698721 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m20:34:53.699777 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m20:34:53.699989 [debug] [Thread-1 (]: On model.jaffle_shop.customers: BEGIN
[0m20:34:53.700170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:34:53.712145 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m20:34:53.712578 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m20:34:53.712842 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  create view "jaffle_shop"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from public.raw_customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from public.raw_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m20:34:53.713946 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "first_name" does not exist
LINE 11:         first_name,
                 ^

[0m20:34:53.714174 [debug] [Thread-1 (]: On model.jaffle_shop.customers: ROLLBACK
[0m20:34:53.715017 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m20:34:53.721867 [debug] [Thread-1 (]: Database Error in model customers (jaffle_shop/models/customers.sql)
  column "first_name" does not exist
  LINE 11:         first_name,
                   ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m20:34:53.723332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80a5d6f4-8a7b-40bf-a6b4-9a58628deca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103ebc80>]}
[0m20:34:53.723692 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.customers .......................... [[31mERROR[0m in 0.05s]
[0m20:34:53.724010 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m20:34:53.724218 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m20:34:53.724473 [debug] [Thread-4 (]: Marking all children of 'model.jaffle_shop.customers' to be skipped because of status 'error'.  Reason: Database Error in model customers (jaffle_shop/models/customers.sql)
  column "first_name" does not exist
  LINE 11:         first_name,
                   ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql.
[0m20:34:53.724733 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:34:53.725311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.customers, now model.jaffle_shop.my_first_dbt_model)
[0m20:34:53.725492 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m20:34:53.726981 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m20:34:53.727714 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m20:34:53.738919 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m20:34:53.739811 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:34:53.740014 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: BEGIN
[0m20:34:53.740194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:34:53.747596 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m20:34:53.748057 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:34:53.748356 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

  create  table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m20:34:53.750105 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m20:34:53.753591 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:34:53.753849 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m20:34:53.754676 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:34:53.756199 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:34:53.756410 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:34:53.757164 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:34:53.768527 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m20:34:53.768823 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:34:53.769005 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m20:34:53.771155 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:34:53.774308 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_first_dbt_model__dbt_backup"
[0m20:34:53.776857 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:34:53.777079 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
drop table if exists "jaffle_shop"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:34:53.781102 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m20:34:53.782428 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m20:34:53.782787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80a5d6f4-8a7b-40bf-a6b4-9a58628deca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147ee3f0>]}
[0m20:34:53.783136 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.06s]
[0m20:34:53.783443 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m20:34:53.783836 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m20:34:53.784111 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:34:53.784342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.my_second_dbt_model)
[0m20:34:53.784533 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m20:34:53.786018 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m20:34:53.786817 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m20:34:53.788673 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m20:34:53.789308 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:34:53.789531 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: BEGIN
[0m20:34:53.789724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:34:53.799826 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m20:34:53.800139 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:34:53.800349 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */

  create view "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "jaffle_shop"."public"."my_first_dbt_model"
where id = 1
  );
[0m20:34:53.801824 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:34:53.803660 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:34:53.803881 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
alter table "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:34:53.804757 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:34:53.805603 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m20:34:53.805819 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:34:53.806004 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m20:34:53.806992 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:34:53.808260 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_second_dbt_model__dbt_backup"
[0m20:34:53.810036 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:34:53.810255 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "jaffle_shop"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:34:53.810968 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m20:34:53.811714 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m20:34:53.812048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80a5d6f4-8a7b-40bf-a6b4-9a58628deca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114762030>]}
[0m20:34:53.812383 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.03s]
[0m20:34:53.812696 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m20:34:53.813271 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:53.813449 [debug] [MainThread]: On master: BEGIN
[0m20:34:53.813609 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:34:53.821864 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:34:53.822169 [debug] [MainThread]: On master: COMMIT
[0m20:34:53.822413 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:53.822589 [debug] [MainThread]: On master: COMMIT
[0m20:34:53.823232 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:34:53.823486 [debug] [MainThread]: On master: Close
[0m20:34:53.823767 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:34:53.823934 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m20:34:53.824156 [info ] [MainThread]: 
[0m20:34:53.824373 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m20:34:53.824892 [debug] [MainThread]: Command end result
[0m20:34:53.836989 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m20:34:53.838492 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m20:34:53.841912 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/run_results.json
[0m20:34:53.842110 [info ] [MainThread]: 
[0m20:34:53.842312 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:34:53.842475 [info ] [MainThread]: 
[0m20:34:53.842662 [error] [MainThread]:   Database Error in model customers (jaffle_shop/models/customers.sql)
  column "first_name" does not exist
  LINE 11:         first_name,
                   ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m20:34:53.842819 [info ] [MainThread]: 
[0m20:34:53.842982 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:34:53.843292 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9736875, "process_in_blocks": "0", "process_kernel_time": 0.268532, "process_mem_max_rss": "122404864", "process_out_blocks": "0", "process_user_time": 1.1142}
[0m20:34:53.843513 [debug] [MainThread]: Command `dbt run` failed at 20:34:53.843473 after 0.97 seconds
[0m20:34:53.843726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11263cf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120b5eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107049ac0>]}
[0m20:34:53.843913 [debug] [MainThread]: Flushing usage events
[0m20:34:54.344430 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:36:26.215646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057bd9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062ad850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062ad4f0>]}


============================== 20:36:26.219501 | 20de3d71-c4eb-41fb-9714-11a215a08d30 ==============================
[0m20:36:26.219501 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:36:26.219830 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jordi.vidaldellobatera/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:36:26.340341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20de3d71-c4eb-41fb-9714-11a215a08d30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062afe90>]}
[0m20:36:26.364963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20de3d71-c4eb-41fb-9714-11a215a08d30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d08980>]}
[0m20:36:26.366100 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:36:26.430923 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m20:36:26.531612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:36:26.532003 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://jaffle_shop/models/customers.sql
[0m20:36:26.645033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20de3d71-c4eb-41fb-9714-11a215a08d30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070787a0>]}
[0m20:36:26.680122 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m20:36:26.682456 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m20:36:26.704629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20de3d71-c4eb-41fb-9714-11a215a08d30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10717ecc0>]}
[0m20:36:26.704935 [info ] [MainThread]: Found 3 models, 6 seeds, 4 data tests, 431 macros
[0m20:36:26.705131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20de3d71-c4eb-41fb-9714-11a215a08d30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068c2150>]}
[0m20:36:26.706041 [info ] [MainThread]: 
[0m20:36:26.706233 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:36:26.706387 [info ] [MainThread]: 
[0m20:36:26.706642 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:36:26.708434 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m20:36:26.789459 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m20:36:26.789718 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m20:36:26.789882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:36:26.831128 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.041 seconds
[0m20:36:26.832099 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m20:36:26.833060 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now list_jaffle_shop_public)
[0m20:36:26.836643 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m20:36:26.836845 [debug] [ThreadPool]: On list_jaffle_shop_public: BEGIN
[0m20:36:26.837012 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:36:26.845953 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m20:36:26.846301 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m20:36:26.846514 [debug] [ThreadPool]: On list_jaffle_shop_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_public"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:36:26.848752 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m20:36:26.849678 [debug] [ThreadPool]: On list_jaffle_shop_public: ROLLBACK
[0m20:36:26.850332 [debug] [ThreadPool]: On list_jaffle_shop_public: Close
[0m20:36:26.853842 [debug] [MainThread]: Using postgres connection "master"
[0m20:36:26.854105 [debug] [MainThread]: On master: BEGIN
[0m20:36:26.854285 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:36:26.862014 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:36:26.862280 [debug] [MainThread]: Using postgres connection "master"
[0m20:36:26.862601 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:36:26.865921 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m20:36:26.866854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20de3d71-c4eb-41fb-9714-11a215a08d30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10752c710>]}
[0m20:36:26.867138 [debug] [MainThread]: On master: ROLLBACK
[0m20:36:26.867834 [debug] [MainThread]: Using postgres connection "master"
[0m20:36:26.868036 [debug] [MainThread]: On master: BEGIN
[0m20:36:26.869109 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:36:26.869324 [debug] [MainThread]: On master: COMMIT
[0m20:36:26.869515 [debug] [MainThread]: Using postgres connection "master"
[0m20:36:26.869682 [debug] [MainThread]: On master: COMMIT
[0m20:36:26.870279 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:36:26.870516 [debug] [MainThread]: On master: Close
[0m20:36:26.871343 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m20:36:26.871675 [info ] [Thread-1 (]: 1 of 3 START sql view model public.customers ................................... [RUN]
[0m20:36:26.871956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_public, now model.jaffle_shop.customers)
[0m20:36:26.872196 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m20:36:26.876164 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m20:36:26.877049 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m20:36:26.895705 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m20:36:26.896706 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m20:36:26.896927 [debug] [Thread-1 (]: On model.jaffle_shop.customers: BEGIN
[0m20:36:26.897106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:26.908128 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m20:36:26.908391 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m20:36:26.908612 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  create view "jaffle_shop"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select
        id as customer_id,
        name
        --first_name,
        --last_name

    from public.raw_customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from public.raw_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m20:36:26.909596 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "user_id" does not exist
LINE 23:         user_id as customer_id,
                 ^

[0m20:36:26.909856 [debug] [Thread-1 (]: On model.jaffle_shop.customers: ROLLBACK
[0m20:36:26.910671 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m20:36:26.917243 [debug] [Thread-1 (]: Database Error in model customers (jaffle_shop/models/customers.sql)
  column "user_id" does not exist
  LINE 23:         user_id as customer_id,
                   ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m20:36:26.918546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20de3d71-c4eb-41fb-9714-11a215a08d30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055c7c50>]}
[0m20:36:26.918931 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.customers .......................... [[31mERROR[0m in 0.05s]
[0m20:36:26.919257 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m20:36:26.919481 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m20:36:26.919767 [debug] [Thread-4 (]: Marking all children of 'model.jaffle_shop.customers' to be skipped because of status 'error'.  Reason: Database Error in model customers (jaffle_shop/models/customers.sql)
  column "user_id" does not exist
  LINE 23:         user_id as customer_id,
                   ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql.
[0m20:36:26.920033 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:36:26.920644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.customers, now model.jaffle_shop.my_first_dbt_model)
[0m20:36:26.920837 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m20:36:26.922418 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m20:36:26.923066 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m20:36:26.935011 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m20:36:26.935862 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:36:26.936078 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: BEGIN
[0m20:36:26.936262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:26.947256 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m20:36:26.947558 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:36:26.947780 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

  create  table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m20:36:26.949203 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m20:36:26.952904 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:36:26.953140 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m20:36:26.954631 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:36:26.956296 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:36:26.956522 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:36:26.957876 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:36:26.969473 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m20:36:26.969717 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:36:26.969911 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m20:36:26.972441 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:36:26.975877 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_first_dbt_model__dbt_backup"
[0m20:36:26.978526 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:36:26.978792 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
drop table if exists "jaffle_shop"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:36:26.982203 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:36:26.983531 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m20:36:26.983895 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20de3d71-c4eb-41fb-9714-11a215a08d30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10765f500>]}
[0m20:36:26.984249 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.06s]
[0m20:36:26.984557 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m20:36:26.984949 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m20:36:26.985238 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:36:26.985467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.my_second_dbt_model)
[0m20:36:26.985654 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m20:36:26.987229 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m20:36:26.988069 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m20:36:26.989978 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m20:36:26.990599 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:36:26.990810 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: BEGIN
[0m20:36:26.990996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:27.000778 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m20:36:27.001109 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:36:27.001317 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */

  create view "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "jaffle_shop"."public"."my_first_dbt_model"
where id = 1
  );
[0m20:36:27.002486 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:36:27.004222 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:36:27.004431 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
alter table "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:36:27.005081 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:36:27.005911 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m20:36:27.006112 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:36:27.006296 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m20:36:27.007300 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:36:27.008689 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_second_dbt_model__dbt_backup"
[0m20:36:27.010484 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:36:27.010709 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "jaffle_shop"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:36:27.011457 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m20:36:27.012211 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m20:36:27.012637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20de3d71-c4eb-41fb-9714-11a215a08d30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10765e2a0>]}
[0m20:36:27.013043 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.03s]
[0m20:36:27.013372 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m20:36:27.014000 [debug] [MainThread]: Using postgres connection "master"
[0m20:36:27.014197 [debug] [MainThread]: On master: BEGIN
[0m20:36:27.014364 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:36:27.021514 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m20:36:27.021886 [debug] [MainThread]: On master: COMMIT
[0m20:36:27.022117 [debug] [MainThread]: Using postgres connection "master"
[0m20:36:27.022296 [debug] [MainThread]: On master: COMMIT
[0m20:36:27.022902 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:36:27.023126 [debug] [MainThread]: On master: Close
[0m20:36:27.023405 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:36:27.023587 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m20:36:27.023813 [info ] [MainThread]: 
[0m20:36:27.024019 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m20:36:27.024517 [debug] [MainThread]: Command end result
[0m20:36:27.037195 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m20:36:27.038734 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m20:36:27.042133 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/run_results.json
[0m20:36:27.042319 [info ] [MainThread]: 
[0m20:36:27.042512 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:36:27.042684 [info ] [MainThread]: 
[0m20:36:27.042880 [error] [MainThread]:   Database Error in model customers (jaffle_shop/models/customers.sql)
  column "user_id" does not exist
  LINE 23:         user_id as customer_id,
                   ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m20:36:27.043038 [info ] [MainThread]: 
[0m20:36:27.043203 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:36:27.043514 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8848346, "process_in_blocks": "0", "process_kernel_time": 0.259427, "process_mem_max_rss": "122191872", "process_out_blocks": "0", "process_user_time": 1.107941}
[0m20:36:27.043743 [debug] [MainThread]: Command `dbt run` failed at 20:36:27.043703 after 0.89 seconds
[0m20:36:27.043955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062ad7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062ad6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f1da30>]}
[0m20:36:27.044145 [debug] [MainThread]: Flushing usage events
[0m20:36:27.557290 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:37:06.403094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105850b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067357f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106735340>]}


============================== 20:37:06.406880 | 41640204-9e46-4e22-b84c-fca91ff99fd5 ==============================
[0m20:37:06.406880 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:37:06.407222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/logs', 'profiles_dir': '/Users/jordi.vidaldellobatera/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:37:06.532491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41640204-9e46-4e22-b84c-fca91ff99fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103836c00>]}
[0m20:37:06.557334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41640204-9e46-4e22-b84c-fca91ff99fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106277890>]}
[0m20:37:06.558556 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:37:06.623091 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m20:37:06.725431 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:37:06.725814 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://jaffle_shop/models/customers.sql
[0m20:37:06.841234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41640204-9e46-4e22-b84c-fca91ff99fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107594f50>]}
[0m20:37:06.876694 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m20:37:06.878963 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m20:37:06.901070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41640204-9e46-4e22-b84c-fca91ff99fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075a6ea0>]}
[0m20:37:06.901377 [info ] [MainThread]: Found 3 models, 6 seeds, 4 data tests, 431 macros
[0m20:37:06.901570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41640204-9e46-4e22-b84c-fca91ff99fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107595370>]}
[0m20:37:06.902496 [info ] [MainThread]: 
[0m20:37:06.902703 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:37:06.902859 [info ] [MainThread]: 
[0m20:37:06.903111 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:37:06.904926 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m20:37:06.986297 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m20:37:06.986559 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m20:37:06.986728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:37:07.016132 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.029 seconds
[0m20:37:07.017001 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m20:37:07.017918 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now list_jaffle_shop_public)
[0m20:37:07.021306 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m20:37:07.021525 [debug] [ThreadPool]: On list_jaffle_shop_public: BEGIN
[0m20:37:07.021691 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:37:07.030083 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m20:37:07.030407 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m20:37:07.030636 [debug] [ThreadPool]: On list_jaffle_shop_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_public"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:37:07.032622 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m20:37:07.033469 [debug] [ThreadPool]: On list_jaffle_shop_public: ROLLBACK
[0m20:37:07.034214 [debug] [ThreadPool]: On list_jaffle_shop_public: Close
[0m20:37:07.037633 [debug] [MainThread]: Using postgres connection "master"
[0m20:37:07.037875 [debug] [MainThread]: On master: BEGIN
[0m20:37:07.038041 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:37:07.046970 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m20:37:07.047261 [debug] [MainThread]: Using postgres connection "master"
[0m20:37:07.047497 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:37:07.050591 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m20:37:07.051510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41640204-9e46-4e22-b84c-fca91ff99fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107569ee0>]}
[0m20:37:07.051800 [debug] [MainThread]: On master: ROLLBACK
[0m20:37:07.052458 [debug] [MainThread]: Using postgres connection "master"
[0m20:37:07.052639 [debug] [MainThread]: On master: BEGIN
[0m20:37:07.053625 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:37:07.053810 [debug] [MainThread]: On master: COMMIT
[0m20:37:07.054015 [debug] [MainThread]: Using postgres connection "master"
[0m20:37:07.054216 [debug] [MainThread]: On master: COMMIT
[0m20:37:07.054835 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:37:07.055017 [debug] [MainThread]: On master: Close
[0m20:37:07.055855 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m20:37:07.056240 [info ] [Thread-1 (]: 1 of 3 START sql view model public.customers ................................... [RUN]
[0m20:37:07.056544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_public, now model.jaffle_shop.customers)
[0m20:37:07.056769 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m20:37:07.060508 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m20:37:07.061342 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m20:37:07.080012 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m20:37:07.080954 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m20:37:07.081164 [debug] [Thread-1 (]: On model.jaffle_shop.customers: BEGIN
[0m20:37:07.081684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:37:07.092738 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m20:37:07.093061 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m20:37:07.093349 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  create view "jaffle_shop"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select
        id as customer_id,
        name
        --first_name,
        --last_name

    from public.raw_customers

),

orders as (

    select
        id as order_id,
        customer as customer_id,
        --user_id as customer_id,
        order_date,
        status

    from public.raw_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m20:37:07.094317 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "order_date" does not exist
LINE 25:         order_date,
                 ^
HINT:  Perhaps you meant to reference the column "raw_orders.ordered_at".

[0m20:37:07.094591 [debug] [Thread-1 (]: On model.jaffle_shop.customers: ROLLBACK
[0m20:37:07.095971 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m20:37:07.102282 [debug] [Thread-1 (]: Database Error in model customers (jaffle_shop/models/customers.sql)
  column "order_date" does not exist
  LINE 25:         order_date,
                   ^
  HINT:  Perhaps you meant to reference the column "raw_orders.ordered_at".
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m20:37:07.103593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41640204-9e46-4e22-b84c-fca91ff99fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079555e0>]}
[0m20:37:07.103966 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.customers .......................... [[31mERROR[0m in 0.05s]
[0m20:37:07.104274 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m20:37:07.104489 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m20:37:07.104764 [debug] [Thread-4 (]: Marking all children of 'model.jaffle_shop.customers' to be skipped because of status 'error'.  Reason: Database Error in model customers (jaffle_shop/models/customers.sql)
  column "order_date" does not exist
  LINE 25:         order_date,
                   ^
  HINT:  Perhaps you meant to reference the column "raw_orders.ordered_at".
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql.
[0m20:37:07.105029 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:37:07.105648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.customers, now model.jaffle_shop.my_first_dbt_model)
[0m20:37:07.105848 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m20:37:07.107341 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m20:37:07.108178 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m20:37:07.120259 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m20:37:07.121070 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:37:07.121294 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: BEGIN
[0m20:37:07.121476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:37:07.132193 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m20:37:07.132526 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:37:07.132732 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

  create  table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m20:37:07.134276 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m20:37:07.138013 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:37:07.138290 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m20:37:07.139496 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:37:07.141423 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:37:07.141674 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:37:07.142585 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:37:07.154810 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m20:37:07.155103 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:37:07.155294 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m20:37:07.157490 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:37:07.161294 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_first_dbt_model__dbt_backup"
[0m20:37:07.164441 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:37:07.164704 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
drop table if exists "jaffle_shop"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:37:07.167708 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:37:07.169031 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m20:37:07.169394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41640204-9e46-4e22-b84c-fca91ff99fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103835d60>]}
[0m20:37:07.169730 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.06s]
[0m20:37:07.170019 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m20:37:07.170372 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m20:37:07.170627 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:37:07.170864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.my_second_dbt_model)
[0m20:37:07.171044 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m20:37:07.172498 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m20:37:07.173345 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m20:37:07.175106 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m20:37:07.175829 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:37:07.176074 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: BEGIN
[0m20:37:07.176287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:37:07.186603 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m20:37:07.186964 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:37:07.187177 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */

  create view "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "jaffle_shop"."public"."my_first_dbt_model"
where id = 1
  );
[0m20:37:07.188669 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:37:07.190387 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:37:07.190592 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
alter table "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:37:07.191730 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:37:07.192575 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m20:37:07.192779 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:37:07.192952 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m20:37:07.193984 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:37:07.195290 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_second_dbt_model__dbt_backup"
[0m20:37:07.197172 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:37:07.197424 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "jaffle_shop"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:37:07.198356 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m20:37:07.199131 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m20:37:07.199475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41640204-9e46-4e22-b84c-fca91ff99fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a01730>]}
[0m20:37:07.199832 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.03s]
[0m20:37:07.200138 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m20:37:07.200752 [debug] [MainThread]: Using postgres connection "master"
[0m20:37:07.200967 [debug] [MainThread]: On master: BEGIN
[0m20:37:07.201134 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:37:07.208494 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m20:37:07.208800 [debug] [MainThread]: On master: COMMIT
[0m20:37:07.209059 [debug] [MainThread]: Using postgres connection "master"
[0m20:37:07.209235 [debug] [MainThread]: On master: COMMIT
[0m20:37:07.209860 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:37:07.210070 [debug] [MainThread]: On master: Close
[0m20:37:07.210343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:37:07.210502 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m20:37:07.210711 [info ] [MainThread]: 
[0m20:37:07.210905 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m20:37:07.211380 [debug] [MainThread]: Command end result
[0m20:37:07.223637 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m20:37:07.225273 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m20:37:07.228626 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/run_results.json
[0m20:37:07.228828 [info ] [MainThread]: 
[0m20:37:07.229091 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:37:07.229307 [info ] [MainThread]: 
[0m20:37:07.229532 [error] [MainThread]:   Database Error in model customers (jaffle_shop/models/customers.sql)
  column "order_date" does not exist
  LINE 25:         order_date,
                   ^
  HINT:  Perhaps you meant to reference the column "raw_orders.ordered_at".
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m20:37:07.229705 [info ] [MainThread]: 
[0m20:37:07.229876 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:37:07.230224 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.88415253, "process_in_blocks": "0", "process_kernel_time": 0.249583, "process_mem_max_rss": "120651776", "process_out_blocks": "0", "process_user_time": 1.087326}
[0m20:37:07.230458 [debug] [MainThread]: Command `dbt run` failed at 20:37:07.230420 after 0.88 seconds
[0m20:37:07.230671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105850b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106735910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067351c0>]}
[0m20:37:07.230870 [debug] [MainThread]: Flushing usage events
[0m20:37:07.676140 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:38:03.999533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10549d190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10629d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10629d3a0>]}


============================== 20:38:04.002696 | f7b83644-a508-4d80-bfda-a03702292acc ==============================
[0m20:38:04.002696 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:38:04.003046 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/jordi.vidaldellobatera/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:38:04.109310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7b83644-a508-4d80-bfda-a03702292acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10647b500>]}
[0m20:38:04.134226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7b83644-a508-4d80-bfda-a03702292acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10677baa0>]}
[0m20:38:04.135074 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:38:04.197218 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m20:38:04.297623 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:38:04.297986 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://jaffle_shop/models/customers.sql
[0m20:38:04.409277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7b83644-a508-4d80-bfda-a03702292acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c5d100>]}
[0m20:38:04.444637 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m20:38:04.446798 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m20:38:04.467713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7b83644-a508-4d80-bfda-a03702292acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c72bd0>]}
[0m20:38:04.468022 [info ] [MainThread]: Found 3 models, 6 seeds, 4 data tests, 431 macros
[0m20:38:04.468216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7b83644-a508-4d80-bfda-a03702292acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba2150>]}
[0m20:38:04.469177 [info ] [MainThread]: 
[0m20:38:04.469385 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:38:04.469537 [info ] [MainThread]: 
[0m20:38:04.469797 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:38:04.471725 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m20:38:04.554785 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m20:38:04.555038 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m20:38:04.555200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:38:04.574889 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.020 seconds
[0m20:38:04.575676 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m20:38:04.576483 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now list_jaffle_shop_public)
[0m20:38:04.579610 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m20:38:04.579824 [debug] [ThreadPool]: On list_jaffle_shop_public: BEGIN
[0m20:38:04.579973 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:38:04.588054 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m20:38:04.588295 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m20:38:04.588484 [debug] [ThreadPool]: On list_jaffle_shop_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_public"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:38:04.590372 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m20:38:04.591137 [debug] [ThreadPool]: On list_jaffle_shop_public: ROLLBACK
[0m20:38:04.591708 [debug] [ThreadPool]: On list_jaffle_shop_public: Close
[0m20:38:04.595086 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:04.595308 [debug] [MainThread]: On master: BEGIN
[0m20:38:04.595474 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:38:04.602969 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m20:38:04.603193 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:04.603426 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:38:04.606601 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m20:38:04.607529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7b83644-a508-4d80-bfda-a03702292acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf3020>]}
[0m20:38:04.607813 [debug] [MainThread]: On master: ROLLBACK
[0m20:38:04.608489 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:04.608707 [debug] [MainThread]: On master: BEGIN
[0m20:38:04.609722 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:38:04.610009 [debug] [MainThread]: On master: COMMIT
[0m20:38:04.610357 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:04.610595 [debug] [MainThread]: On master: COMMIT
[0m20:38:04.611337 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:38:04.611535 [debug] [MainThread]: On master: Close
[0m20:38:04.612356 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m20:38:04.612679 [info ] [Thread-1 (]: 1 of 3 START sql view model public.customers ................................... [RUN]
[0m20:38:04.612952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_public, now model.jaffle_shop.customers)
[0m20:38:04.613165 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m20:38:04.617081 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m20:38:04.617796 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m20:38:04.636444 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m20:38:04.637312 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m20:38:04.637508 [debug] [Thread-1 (]: On model.jaffle_shop.customers: BEGIN
[0m20:38:04.637669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:04.656157 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m20:38:04.656443 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m20:38:04.656666 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  create view "jaffle_shop"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select
        id as customer_id,
        name
        --first_name,
        --last_name

    from public.raw_customers

),

orders as (

    select
        id as order_id,
        customer as customer_id,
        --user_id as customer_id,
        ordered_at as order_date,
        status

    from public.raw_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m20:38:04.658108 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "status" does not exist
LINE 26:         status
                 ^

[0m20:38:04.658348 [debug] [Thread-1 (]: On model.jaffle_shop.customers: ROLLBACK
[0m20:38:04.659702 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m20:38:04.665915 [debug] [Thread-1 (]: Database Error in model customers (jaffle_shop/models/customers.sql)
  column "status" does not exist
  LINE 26:         status
                   ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m20:38:04.667357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7b83644-a508-4d80-bfda-a03702292acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10765a960>]}
[0m20:38:04.667771 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.customers .......................... [[31mERROR[0m in 0.05s]
[0m20:38:04.668108 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m20:38:04.668325 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m20:38:04.668592 [debug] [Thread-4 (]: Marking all children of 'model.jaffle_shop.customers' to be skipped because of status 'error'.  Reason: Database Error in model customers (jaffle_shop/models/customers.sql)
  column "status" does not exist
  LINE 26:         status
                   ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql.
[0m20:38:04.668844 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:38:04.669477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.customers, now model.jaffle_shop.my_first_dbt_model)
[0m20:38:04.669671 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m20:38:04.671213 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m20:38:04.671983 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m20:38:04.684324 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m20:38:04.685150 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:38:04.685364 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: BEGIN
[0m20:38:04.685544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:04.696352 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m20:38:04.696651 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:38:04.696923 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

  create  table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m20:38:04.698317 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m20:38:04.701984 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:38:04.702243 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m20:38:04.703064 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:38:04.704722 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:38:04.704932 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:38:04.706112 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:38:04.717523 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m20:38:04.717760 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:38:04.717941 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m20:38:04.720107 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:38:04.723387 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_first_dbt_model__dbt_backup"
[0m20:38:04.726132 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:38:04.726363 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
drop table if exists "jaffle_shop"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:38:04.729319 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:38:04.730599 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m20:38:04.730945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7b83644-a508-4d80-bfda-a03702292acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076f9d00>]}
[0m20:38:04.731288 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.06s]
[0m20:38:04.731587 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m20:38:04.732003 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m20:38:04.732286 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:38:04.732512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.my_second_dbt_model)
[0m20:38:04.732700 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m20:38:04.734158 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m20:38:04.734984 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m20:38:04.736806 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m20:38:04.737428 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:38:04.737632 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: BEGIN
[0m20:38:04.737819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:04.747939 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m20:38:04.748205 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:38:04.748395 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */

  create view "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "jaffle_shop"."public"."my_first_dbt_model"
where id = 1
  );
[0m20:38:04.750686 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:38:04.752563 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:38:04.752789 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
alter table "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:38:04.753736 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:38:04.754569 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m20:38:04.754790 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:38:04.754986 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m20:38:04.755918 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:38:04.757258 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_second_dbt_model__dbt_backup"
[0m20:38:04.759088 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:38:04.759368 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "jaffle_shop"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:38:04.760610 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m20:38:04.761329 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m20:38:04.761655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7b83644-a508-4d80-bfda-a03702292acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107668a70>]}
[0m20:38:04.761987 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.03s]
[0m20:38:04.762283 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m20:38:04.762839 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:04.763011 [debug] [MainThread]: On master: BEGIN
[0m20:38:04.763161 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:38:04.771080 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:38:04.771403 [debug] [MainThread]: On master: COMMIT
[0m20:38:04.771631 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:04.771805 [debug] [MainThread]: On master: COMMIT
[0m20:38:04.772367 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:38:04.772547 [debug] [MainThread]: On master: Close
[0m20:38:04.772794 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:38:04.772950 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m20:38:04.773164 [info ] [MainThread]: 
[0m20:38:04.773363 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m20:38:04.773851 [debug] [MainThread]: Command end result
[0m20:38:04.786567 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m20:38:04.790852 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m20:38:04.794372 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/run_results.json
[0m20:38:04.794616 [info ] [MainThread]: 
[0m20:38:04.795112 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:38:04.795328 [info ] [MainThread]: 
[0m20:38:04.795563 [error] [MainThread]:   Database Error in model customers (jaffle_shop/models/customers.sql)
  column "status" does not exist
  LINE 26:         status
                   ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m20:38:04.795739 [info ] [MainThread]: 
[0m20:38:04.795929 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:38:04.796296 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.85538477, "process_in_blocks": "0", "process_kernel_time": 0.225979, "process_mem_max_rss": "121061376", "process_out_blocks": "0", "process_user_time": 1.102261}
[0m20:38:04.796538 [debug] [MainThread]: Command `dbt run` failed at 20:38:04.796494 after 0.86 seconds
[0m20:38:04.796767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10603ce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e15e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b3de80>]}
[0m20:38:04.796971 [debug] [MainThread]: Flushing usage events
[0m20:38:05.264606 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:38:52.905185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ac2f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ffd670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ffd2e0>]}


============================== 20:38:52.908412 | 6c794ce6-839c-4e7d-82f2-660051beb942 ==============================
[0m20:38:52.908412 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:38:52.908779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jordi.vidaldellobatera/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:38:53.021074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c794ce6-839c-4e7d-82f2-660051beb942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104106ba0>]}
[0m20:38:53.047661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c794ce6-839c-4e7d-82f2-660051beb942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105db3e60>]}
[0m20:38:53.048588 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:38:53.112338 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m20:38:53.213011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:38:53.213376 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://jaffle_shop/models/customers.sql
[0m20:38:53.324081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c794ce6-839c-4e7d-82f2-660051beb942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075c08f0>]}
[0m20:38:53.359613 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m20:38:53.361973 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m20:38:53.383808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c794ce6-839c-4e7d-82f2-660051beb942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e7ae40>]}
[0m20:38:53.384129 [info ] [MainThread]: Found 3 models, 6 seeds, 4 data tests, 431 macros
[0m20:38:53.384324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c794ce6-839c-4e7d-82f2-660051beb942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107da4c50>]}
[0m20:38:53.385286 [info ] [MainThread]: 
[0m20:38:53.385486 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:38:53.385645 [info ] [MainThread]: 
[0m20:38:53.385930 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:38:53.387887 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m20:38:53.472256 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m20:38:53.472576 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m20:38:53.472763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:38:53.493858 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.021 seconds
[0m20:38:53.494729 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m20:38:53.495623 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now list_jaffle_shop_public)
[0m20:38:53.498981 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m20:38:53.499223 [debug] [ThreadPool]: On list_jaffle_shop_public: BEGIN
[0m20:38:53.499386 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:38:53.507373 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m20:38:53.507713 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m20:38:53.507967 [debug] [ThreadPool]: On list_jaffle_shop_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_public"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:38:53.510454 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m20:38:53.511449 [debug] [ThreadPool]: On list_jaffle_shop_public: ROLLBACK
[0m20:38:53.512230 [debug] [ThreadPool]: On list_jaffle_shop_public: Close
[0m20:38:53.515976 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:53.516265 [debug] [MainThread]: On master: BEGIN
[0m20:38:53.516447 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:38:53.524684 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:38:53.525018 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:53.525447 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:38:53.529354 [debug] [MainThread]: SQL status: SELECT 2 in 0.004 seconds
[0m20:38:53.530421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c794ce6-839c-4e7d-82f2-660051beb942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10822a900>]}
[0m20:38:53.530711 [debug] [MainThread]: On master: ROLLBACK
[0m20:38:53.531503 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:53.531745 [debug] [MainThread]: On master: BEGIN
[0m20:38:53.532858 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:38:53.533150 [debug] [MainThread]: On master: COMMIT
[0m20:38:53.533401 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:53.533632 [debug] [MainThread]: On master: COMMIT
[0m20:38:53.534318 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:38:53.534539 [debug] [MainThread]: On master: Close
[0m20:38:53.535438 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m20:38:53.535824 [info ] [Thread-1 (]: 1 of 3 START sql view model public.customers ................................... [RUN]
[0m20:38:53.536195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_public, now model.jaffle_shop.customers)
[0m20:38:53.536450 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m20:38:53.540697 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m20:38:53.541321 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m20:38:53.560801 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m20:38:53.561677 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m20:38:53.561874 [debug] [Thread-1 (]: On model.jaffle_shop.customers: BEGIN
[0m20:38:53.562047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:53.573284 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m20:38:53.573573 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m20:38:53.573791 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  create view "jaffle_shop"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select
        id as customer_id,
        name
        --first_name,
        --last_name

    from public.raw_customers

),

orders as (

    select
        id as order_id,
        customer as customer_id,
        --user_id as customer_id,
        ordered_at as order_date,
        --status
        order_total

    from public.raw_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m20:38:53.576062 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column customers.first_name does not exist
LINE 52:         customers.first_name,
                 ^

[0m20:38:53.576351 [debug] [Thread-1 (]: On model.jaffle_shop.customers: ROLLBACK
[0m20:38:53.577228 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m20:38:53.583119 [debug] [Thread-1 (]: Database Error in model customers (jaffle_shop/models/customers.sql)
  column customers.first_name does not exist
  LINE 52:         customers.first_name,
                   ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m20:38:53.584487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c794ce6-839c-4e7d-82f2-660051beb942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e6e150>]}
[0m20:38:53.584916 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.customers .......................... [[31mERROR[0m in 0.05s]
[0m20:38:53.585260 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m20:38:53.585492 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m20:38:53.585775 [debug] [Thread-4 (]: Marking all children of 'model.jaffle_shop.customers' to be skipped because of status 'error'.  Reason: Database Error in model customers (jaffle_shop/models/customers.sql)
  column customers.first_name does not exist
  LINE 52:         customers.first_name,
                   ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql.
[0m20:38:53.586045 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:38:53.586685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.customers, now model.jaffle_shop.my_first_dbt_model)
[0m20:38:53.586886 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m20:38:53.588500 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m20:38:53.589223 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m20:38:53.601774 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m20:38:53.602676 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:38:53.602915 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: BEGIN
[0m20:38:53.603094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:53.612653 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m20:38:53.613047 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:38:53.613286 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

  create  table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m20:38:53.614706 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m20:38:53.618218 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:38:53.618486 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m20:38:53.619941 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:38:53.621511 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:38:53.621704 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:38:53.622729 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:38:53.633829 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m20:38:53.634121 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:38:53.634305 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m20:38:53.636025 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:38:53.639308 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_first_dbt_model__dbt_backup"
[0m20:38:53.641755 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:38:53.641983 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
drop table if exists "jaffle_shop"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:38:53.645311 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:38:53.646602 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m20:38:53.646936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c794ce6-839c-4e7d-82f2-660051beb942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10835a0c0>]}
[0m20:38:53.647258 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.06s]
[0m20:38:53.647548 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m20:38:53.647929 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m20:38:53.648180 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:38:53.648408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.my_second_dbt_model)
[0m20:38:53.648636 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m20:38:53.650096 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m20:38:53.650929 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m20:38:53.652671 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m20:38:53.653217 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:38:53.653404 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: BEGIN
[0m20:38:53.653596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:53.662054 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m20:38:53.662369 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:38:53.662571 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */

  create view "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "jaffle_shop"."public"."my_first_dbt_model"
where id = 1
  );
[0m20:38:53.663865 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:38:53.665556 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:38:53.665786 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
alter table "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:38:53.666577 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:38:53.667308 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m20:38:53.667490 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:38:53.667658 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m20:38:53.669701 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:38:53.671059 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_second_dbt_model__dbt_backup"
[0m20:38:53.672730 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:38:53.672941 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "jaffle_shop"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:38:53.675515 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:38:53.676371 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m20:38:53.676710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c794ce6-839c-4e7d-82f2-660051beb942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10835a990>]}
[0m20:38:53.677033 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.03s]
[0m20:38:53.677325 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m20:38:53.677927 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:53.678093 [debug] [MainThread]: On master: BEGIN
[0m20:38:53.678236 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:38:53.705941 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m20:38:53.706205 [debug] [MainThread]: On master: COMMIT
[0m20:38:53.706370 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:53.706519 [debug] [MainThread]: On master: COMMIT
[0m20:38:53.707631 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:38:53.707811 [debug] [MainThread]: On master: Close
[0m20:38:53.708232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:38:53.708438 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m20:38:53.708670 [info ] [MainThread]: 
[0m20:38:53.708873 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m20:38:53.709337 [debug] [MainThread]: Command end result
[0m20:38:53.720921 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m20:38:53.722526 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m20:38:53.725937 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/run_results.json
[0m20:38:53.726170 [info ] [MainThread]: 
[0m20:38:53.726378 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:38:53.726546 [info ] [MainThread]: 
[0m20:38:53.726746 [error] [MainThread]:   Database Error in model customers (jaffle_shop/models/customers.sql)
  column customers.first_name does not exist
  LINE 52:         customers.first_name,
                   ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m20:38:53.726901 [info ] [MainThread]: 
[0m20:38:53.727066 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:38:53.727425 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8805594, "process_in_blocks": "0", "process_kernel_time": 0.232763, "process_mem_max_rss": "122748928", "process_out_blocks": "0", "process_user_time": 1.122367}
[0m20:38:53.727777 [debug] [MainThread]: Command `dbt run` failed at 20:38:53.727712 after 0.88 seconds
[0m20:38:53.728038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dd7a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ac2f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d4a240>]}
[0m20:38:53.728268 [debug] [MainThread]: Flushing usage events
[0m20:38:53.823141 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:40:00.395035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10694f230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ccd6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ccd340>]}


============================== 20:40:00.398792 | 031b45a4-5580-4a42-abad-041e46816d05 ==============================
[0m20:40:00.398792 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:40:00.399130 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jordi.vidaldellobatera/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:40:00.515376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '031b45a4-5580-4a42-abad-041e46816d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dd6900>]}
[0m20:40:00.540122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '031b45a4-5580-4a42-abad-041e46816d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071b5220>]}
[0m20:40:00.541290 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:40:00.605860 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m20:40:00.708547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:40:00.708915 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://jaffle_shop/models/customers.sql
[0m20:40:00.820451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '031b45a4-5580-4a42-abad-041e46816d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b34f80>]}
[0m20:40:00.855716 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m20:40:00.858108 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m20:40:00.880064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '031b45a4-5580-4a42-abad-041e46816d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b4ab70>]}
[0m20:40:00.880370 [info ] [MainThread]: Found 3 models, 6 seeds, 4 data tests, 431 macros
[0m20:40:00.880577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '031b45a4-5580-4a42-abad-041e46816d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b35df0>]}
[0m20:40:00.881514 [info ] [MainThread]: 
[0m20:40:00.881714 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:40:00.881870 [info ] [MainThread]: 
[0m20:40:00.882131 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:40:00.883919 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m20:40:00.965222 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m20:40:00.965482 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m20:40:00.965655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:00.992411 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.027 seconds
[0m20:40:00.993255 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m20:40:00.994062 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now list_jaffle_shop_public)
[0m20:40:00.997120 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m20:40:00.997339 [debug] [ThreadPool]: On list_jaffle_shop_public: BEGIN
[0m20:40:00.997513 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:40:01.006518 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m20:40:01.006749 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m20:40:01.006967 [debug] [ThreadPool]: On list_jaffle_shop_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_public"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:40:01.009134 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m20:40:01.009925 [debug] [ThreadPool]: On list_jaffle_shop_public: ROLLBACK
[0m20:40:01.010664 [debug] [ThreadPool]: On list_jaffle_shop_public: Close
[0m20:40:01.014015 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:01.014244 [debug] [MainThread]: On master: BEGIN
[0m20:40:01.014404 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:40:01.023832 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m20:40:01.024305 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:01.024741 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:40:01.028258 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m20:40:01.029201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '031b45a4-5580-4a42-abad-041e46816d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b35ee0>]}
[0m20:40:01.029489 [debug] [MainThread]: On master: ROLLBACK
[0m20:40:01.030194 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:01.030382 [debug] [MainThread]: On master: BEGIN
[0m20:40:01.031404 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:40:01.031621 [debug] [MainThread]: On master: COMMIT
[0m20:40:01.031839 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:01.032017 [debug] [MainThread]: On master: COMMIT
[0m20:40:01.032650 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:40:01.032837 [debug] [MainThread]: On master: Close
[0m20:40:01.033597 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m20:40:01.033916 [info ] [Thread-1 (]: 1 of 3 START sql view model public.customers ................................... [RUN]
[0m20:40:01.034183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_public, now model.jaffle_shop.customers)
[0m20:40:01.034425 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m20:40:01.038370 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m20:40:01.039254 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m20:40:01.057766 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m20:40:01.058776 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m20:40:01.059056 [debug] [Thread-1 (]: On model.jaffle_shop.customers: BEGIN
[0m20:40:01.059252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:01.070911 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m20:40:01.071139 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m20:40:01.071407 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  create view "jaffle_shop"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select
        id as customer_id,
        name as customer_name,
        --first_name,
        --last_name

    from public.raw_customers

),

orders as (

    select
        id as order_id,
        customer as customer_id,
        --user_id as customer_id,
        ordered_at as order_date,
        --status
        order_total

    from public.raw_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        --customers.first_name,
        --customers.last_name,
        customer_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m20:40:01.072317 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 15:     from public.raw_customers
             ^

[0m20:40:01.072839 [debug] [Thread-1 (]: On model.jaffle_shop.customers: ROLLBACK
[0m20:40:01.073692 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m20:40:01.080283 [debug] [Thread-1 (]: Database Error in model customers (jaffle_shop/models/customers.sql)
  syntax error at or near "from"
  LINE 15:     from public.raw_customers
               ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m20:40:01.081590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '031b45a4-5580-4a42-abad-041e46816d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f931d0>]}
[0m20:40:01.081996 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.customers .......................... [[31mERROR[0m in 0.05s]
[0m20:40:01.082325 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m20:40:01.082555 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m20:40:01.082828 [debug] [Thread-4 (]: Marking all children of 'model.jaffle_shop.customers' to be skipped because of status 'error'.  Reason: Database Error in model customers (jaffle_shop/models/customers.sql)
  syntax error at or near "from"
  LINE 15:     from public.raw_customers
               ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql.
[0m20:40:01.083092 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:40:01.083741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.customers, now model.jaffle_shop.my_first_dbt_model)
[0m20:40:01.083943 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m20:40:01.085524 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m20:40:01.086189 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m20:40:01.098095 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m20:40:01.098954 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:40:01.099205 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: BEGIN
[0m20:40:01.099431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:01.108822 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m20:40:01.109188 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:40:01.109411 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

  create  table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m20:40:01.110868 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m20:40:01.114602 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:40:01.114854 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m20:40:01.115669 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:40:01.117266 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:40:01.117539 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:40:01.118334 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:40:01.128991 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m20:40:01.129229 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:40:01.129420 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m20:40:01.131361 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:40:01.135581 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_first_dbt_model__dbt_backup"
[0m20:40:01.138030 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:40:01.138240 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
drop table if exists "jaffle_shop"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:40:01.141055 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:40:01.142404 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m20:40:01.142779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '031b45a4-5580-4a42-abad-041e46816d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dd5bb0>]}
[0m20:40:01.143146 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.06s]
[0m20:40:01.143504 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m20:40:01.143935 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m20:40:01.144199 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:40:01.144491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.my_second_dbt_model)
[0m20:40:01.144694 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m20:40:01.146187 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m20:40:01.146958 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m20:40:01.148864 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m20:40:01.149411 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:40:01.149625 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: BEGIN
[0m20:40:01.149802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:01.158147 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m20:40:01.158671 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:40:01.158905 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */

  create view "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "jaffle_shop"."public"."my_first_dbt_model"
where id = 1
  );
[0m20:40:01.160475 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:40:01.162457 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:40:01.162697 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
alter table "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:40:01.163680 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:40:01.164504 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m20:40:01.164711 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:40:01.164894 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m20:40:01.165886 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:40:01.167189 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_second_dbt_model__dbt_backup"
[0m20:40:01.169144 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:40:01.169357 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "jaffle_shop"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:40:01.170048 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:40:01.170893 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m20:40:01.171274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '031b45a4-5580-4a42-abad-041e46816d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080290d0>]}
[0m20:40:01.171619 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.03s]
[0m20:40:01.171925 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m20:40:01.172615 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:01.172809 [debug] [MainThread]: On master: BEGIN
[0m20:40:01.172969 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:40:01.180406 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m20:40:01.180720 [debug] [MainThread]: On master: COMMIT
[0m20:40:01.180932 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:01.181094 [debug] [MainThread]: On master: COMMIT
[0m20:40:01.181771 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:40:01.181974 [debug] [MainThread]: On master: Close
[0m20:40:01.182218 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:40:01.182366 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m20:40:01.182579 [info ] [MainThread]: 
[0m20:40:01.182771 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m20:40:01.183235 [debug] [MainThread]: Command end result
[0m20:40:01.195612 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m20:40:01.196919 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m20:40:01.200001 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/run_results.json
[0m20:40:01.200197 [info ] [MainThread]: 
[0m20:40:01.200399 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:40:01.200609 [info ] [MainThread]: 
[0m20:40:01.200831 [error] [MainThread]:   Database Error in model customers (jaffle_shop/models/customers.sql)
  syntax error at or near "from"
  LINE 15:     from public.raw_customers
               ^
  compiled code at target/run/jaffle_shop/jaffle_shop/models/customers.sql
[0m20:40:01.200997 [info ] [MainThread]: 
[0m20:40:01.201170 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:40:01.201498 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.86252004, "process_in_blocks": "0", "process_kernel_time": 0.239831, "process_mem_max_rss": "122798080", "process_out_blocks": "0", "process_user_time": 1.076498}
[0m20:40:01.201730 [debug] [MainThread]: Command `dbt run` failed at 20:40:01.201688 after 0.86 seconds
[0m20:40:01.201958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ccd820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ccd850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe7e30>]}
[0m20:40:01.202154 [debug] [MainThread]: Flushing usage events
[0m20:40:01.684436 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:40:26.322524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061073b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e53d0>]}


============================== 20:40:26.325601 | b84ea31c-3915-400d-a32b-26b7e4e6dbed ==============================
[0m20:40:26.325601 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:40:26.326045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/logs', 'profiles_dir': '/Users/jordi.vidaldellobatera/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:40:26.432846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b84ea31c-3915-400d-a32b-26b7e4e6dbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aeb800>]}
[0m20:40:26.458184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b84ea31c-3915-400d-a32b-26b7e4e6dbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e15d00>]}
[0m20:40:26.459158 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:40:26.526757 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m20:40:26.629268 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:40:26.629651 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://jaffle_shop/models/customers.sql
[0m20:40:26.741213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b84ea31c-3915-400d-a32b-26b7e4e6dbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba8a70>]}
[0m20:40:26.776414 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m20:40:26.778713 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m20:40:26.797271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b84ea31c-3915-400d-a32b-26b7e4e6dbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107462db0>]}
[0m20:40:26.797580 [info ] [MainThread]: Found 3 models, 6 seeds, 4 data tests, 431 macros
[0m20:40:26.797779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b84ea31c-3915-400d-a32b-26b7e4e6dbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107451a60>]}
[0m20:40:26.798747 [info ] [MainThread]: 
[0m20:40:26.798949 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:40:26.799104 [info ] [MainThread]: 
[0m20:40:26.799351 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:40:26.801313 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m20:40:26.880123 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m20:40:26.880391 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m20:40:26.880575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:26.904891 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.024 seconds
[0m20:40:26.905695 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m20:40:26.906561 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now list_jaffle_shop_public)
[0m20:40:26.909740 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m20:40:26.909971 [debug] [ThreadPool]: On list_jaffle_shop_public: BEGIN
[0m20:40:26.910164 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:40:26.918151 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m20:40:26.918451 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_public"
[0m20:40:26.918673 [debug] [ThreadPool]: On list_jaffle_shop_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_public"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'jaffle_shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:40:26.920913 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m20:40:26.921830 [debug] [ThreadPool]: On list_jaffle_shop_public: ROLLBACK
[0m20:40:26.922477 [debug] [ThreadPool]: On list_jaffle_shop_public: Close
[0m20:40:26.925959 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:26.926223 [debug] [MainThread]: On master: BEGIN
[0m20:40:26.926397 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:40:26.934101 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:40:26.934399 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:26.934667 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:40:26.938143 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m20:40:26.939084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b84ea31c-3915-400d-a32b-26b7e4e6dbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107453260>]}
[0m20:40:26.939379 [debug] [MainThread]: On master: ROLLBACK
[0m20:40:26.940051 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:26.940241 [debug] [MainThread]: On master: BEGIN
[0m20:40:26.941381 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:40:26.941636 [debug] [MainThread]: On master: COMMIT
[0m20:40:26.941840 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:26.942020 [debug] [MainThread]: On master: COMMIT
[0m20:40:26.942665 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:40:26.942848 [debug] [MainThread]: On master: Close
[0m20:40:26.943654 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m20:40:26.943997 [info ] [Thread-1 (]: 1 of 3 START sql view model public.customers ................................... [RUN]
[0m20:40:26.944287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_public, now model.jaffle_shop.customers)
[0m20:40:26.944507 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m20:40:26.948369 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m20:40:26.949253 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m20:40:26.968586 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m20:40:26.969618 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m20:40:26.969828 [debug] [Thread-1 (]: On model.jaffle_shop.customers: BEGIN
[0m20:40:26.970022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:26.980701 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m20:40:26.980911 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m20:40:26.981125 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  create view "jaffle_shop"."public"."customers__dbt_tmp"
    
    
  as (
    with customers as (

    select
        id as customer_id,
        name as customer_name
        --first_name,
        --last_name

    from public.raw_customers

),

orders as (

    select
        id as order_id,
        customer as customer_id,
        --user_id as customer_id,
        ordered_at as order_date,
        --status
        order_total

    from public.raw_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        --customers.first_name,
        --customers.last_name,
        customer_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m20:40:26.983414 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:40:26.986675 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m20:40:26.986886 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
alter table "jaffle_shop"."public"."customers__dbt_tmp" rename to "customers"
[0m20:40:26.987646 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:40:26.995019 [debug] [Thread-1 (]: On model.jaffle_shop.customers: COMMIT
[0m20:40:26.995249 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m20:40:26.995430 [debug] [Thread-1 (]: On model.jaffle_shop.customers: COMMIT
[0m20:40:26.996725 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:40:26.999823 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."customers__dbt_backup"
[0m20:40:27.002318 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m20:40:27.002528 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
drop view if exists "jaffle_shop"."public"."customers__dbt_backup" cascade
[0m20:40:27.003860 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m20:40:27.005098 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m20:40:27.006390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b84ea31c-3915-400d-a32b-26b7e4e6dbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036e9c40>]}
[0m20:40:27.006727 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.customers .............................. [[32mCREATE VIEW[0m in 0.06s]
[0m20:40:27.007035 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m20:40:27.007247 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m20:40:27.007523 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:40:27.007762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.customers, now model.jaffle_shop.my_first_dbt_model)
[0m20:40:27.007953 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m20:40:27.009369 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m20:40:27.010107 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m20:40:27.022219 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m20:40:27.023130 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:40:27.023330 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: BEGIN
[0m20:40:27.023506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:27.032237 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m20:40:27.032541 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:40:27.032748 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

  create  table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m20:40:27.033897 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m20:40:27.035539 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:40:27.035732 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m20:40:27.036735 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:40:27.038323 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:40:27.038523 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "jaffle_shop"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:40:27.039199 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:40:27.043150 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m20:40:27.043405 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:40:27.043587 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m20:40:27.045579 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:40:27.046917 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_first_dbt_model__dbt_backup"
[0m20:40:27.048422 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m20:40:27.048623 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
drop table if exists "jaffle_shop"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:40:27.051703 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:40:27.052372 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m20:40:27.052675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b84ea31c-3915-400d-a32b-26b7e4e6dbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10790c980>]}
[0m20:40:27.052997 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.04s]
[0m20:40:27.053281 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m20:40:27.053645 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m20:40:27.053885 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:40:27.054156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.my_second_dbt_model)
[0m20:40:27.054380 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m20:40:27.055864 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m20:40:27.056647 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m20:40:27.058540 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m20:40:27.059117 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:40:27.059372 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: BEGIN
[0m20:40:27.059620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:27.067954 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m20:40:27.068306 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:40:27.068552 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */

  create view "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "jaffle_shop"."public"."my_first_dbt_model"
where id = 1
  );
[0m20:40:27.069791 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:40:27.071582 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:40:27.071805 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
alter table "jaffle_shop"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:40:27.072540 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:40:27.073403 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m20:40:27.073626 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:40:27.073820 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m20:40:27.075730 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:40:27.077131 [debug] [Thread-1 (]: Applying DROP to: "jaffle_shop"."public"."my_second_dbt_model__dbt_backup"
[0m20:40:27.077541 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m20:40:27.077724 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "jaffle_shop"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:40:27.079000 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m20:40:27.079695 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m20:40:27.080019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b84ea31c-3915-400d-a32b-26b7e4e6dbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107899a90>]}
[0m20:40:27.080354 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.03s]
[0m20:40:27.080648 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m20:40:27.081230 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:27.081407 [debug] [MainThread]: On master: BEGIN
[0m20:40:27.081562 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:40:27.089420 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:40:27.089731 [debug] [MainThread]: On master: COMMIT
[0m20:40:27.089987 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:27.090176 [debug] [MainThread]: On master: COMMIT
[0m20:40:27.090776 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:40:27.090983 [debug] [MainThread]: On master: Close
[0m20:40:27.091242 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:40:27.091403 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m20:40:27.091622 [info ] [MainThread]: 
[0m20:40:27.091900 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m20:40:27.092472 [debug] [MainThread]: Command end result
[0m20:40:27.104836 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/manifest.json
[0m20:40:27.106471 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/semantic_manifest.json
[0m20:40:27.110120 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jordi.vidaldellobatera/Documents/repos_personal/dbt-tutorial/target/run_results.json
[0m20:40:27.110440 [info ] [MainThread]: 
[0m20:40:27.110684 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:40:27.110855 [info ] [MainThread]: 
[0m20:40:27.111034 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:40:27.111380 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.846242, "process_in_blocks": "0", "process_kernel_time": 0.232782, "process_mem_max_rss": "121618432", "process_out_blocks": "0", "process_user_time": 1.130559}
[0m20:40:27.111606 [debug] [MainThread]: Command `dbt run` succeeded at 20:40:27.111562 after 0.85 seconds
[0m20:40:27.111822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10657f440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107393500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e5610>]}
[0m20:40:27.112028 [debug] [MainThread]: Flushing usage events
[0m20:40:27.182579 [debug] [MainThread]: An error was encountered while trying to flush usage events
